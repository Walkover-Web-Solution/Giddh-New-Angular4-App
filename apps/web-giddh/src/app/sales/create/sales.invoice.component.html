<div class="pdB1 upper-layer   clearfix">
  <div class="col-xs-12 clearfix">
    <div class="btn-group" dropdown>
      <button id="button1-basic" dropdownToggle type="button" class="btn spcl_dropdown dropdown-toggle"
              aria-controls="dropdown-basic">
        {{selectedPageLabel}}
        <span class="caret" *ngIf="!isUpdateMode && !isPurchaseInvoice"></span>
      </button>
      <ul id="dropdown1-basic" *dropdownMenu class="dropdown-menu" role="menu" aria-labelledby="button-basic">
        <ng-container *ngIf="!isUpdateMode && !isPurchaseInvoice">
          <li role="menuitem" (click)="pageChanged(item.value, item.additional.label)" *ngFor="let item of pageList">
            <a class="dropdown-item cp">{{ item.additional?.label }}</a>
          </li>
        </ng-container>
      </ul>
    </div>
    <!-- <label>Select Type</label> -->
    <!-- <sales-sh-select [width]="'150px'" [showLabelOnly]="true" [showClear]="false" [options]="pageList" [placeholder]="'Select Invoice Type'" (selected)="pageChanged()" name="selectedPage" [(ngModel)]="selectedPage"></sales-sh-select> -->

  </div>
</div>

<ng-container *ngIf="isUpdateDataInProcess">

  <div class="loaderClass">
    <div class="giddh-spinner vertical-center-spinner"></div>
  </div>

</ng-container>

<div [hidden]="isUpdateMode && isUpdateDataInProcess">
  <form #invoiceForm="ngForm" (ngSubmit)="onSubmitInvoiceForm(invoiceForm)" novalidate autocomplete="off"
        [ngClass]="{ ' customerInvoiceForm ' : !invFormData.voucherDetails.customerName , 'cusomerInvoiceFormPurchase': isPurchaseInvoice } ">
    <div class="clearfix sales-invoice-content ">

      <div class="upper-layer " [ngClass]="{' firstTable' : !invFormData.voucherDetails.customerName }">
        <div class="clearfix">
          <div class="col-md-9 pd0">
            <div class="customer-name" [hidden]="isPurchaseInvoice">
              <div class="col-sm-2">
                <label>Customer Name</label>
              </div>
              <div class="col-sm-5">
                <ng-container *ngIf="!isCashInvoice">
                  <sales-sh-select style="width:100%; float: left;" name="voucherDetails.customerName"
                                   [options]="customerAcList$ | async"
                                   [(ngModel)]="invFormData.voucherDetails.customerName"
                                   [customFilter]="customMoveGroupFilter"
                                   (noOptionsFound)="noResultsForCustomer($event)"
                                   (selected)="onSelectCustomer($event)" [placeholder]="'Select Customer'"
                                   [notFoundLink]="true" [doNotReset]="true" [forceClearReactive]="forceClear$ | async"
                                   [isFilterEnabled]="true" (noResultsClicked)="toggleAccountAsidePane($event)"
                                   [multiple]="false" [ItemHeight]="67" [notFoundLinkText]="'Add Customer'"
                                   (keyup)="resetCustomerName($event)" (onClear)="resetCustomerName(null)"
                                   [showClear]="!isUpdateMode" [disabled]="isUpdateMode">
                    <ng-template #optionTemplate let-option="option">
                      <a href="javascript:void(0)" class="list-item" style="border-bottom: 1px solid #ccc;">
                        <div class="item">{{ option.label }}</div>
                        <div class="item_unq">{{ option.value }}</div>
                      </a>
                    </ng-template>
                    <ng-template #notFoundLinkTemplate>
                      <a href="javascript:void(0)" class="list-item" [keyboardShortcut]="'alt+c'"
                         (onShortcutPress)="toggleAccountAsidePane()"
                         style="width:100%; display: flex;justify-content: space-between;">
                        <div class="item">Add Customer</div>
                        <div class="item">Alt+C</div>
                      </a>
                    </ng-template>
                  </sales-sh-select>
                </ng-container>

                <ng-container *ngIf="isCashInvoice">
                  <input type="text" #cashInvoiceInput name="voucherDetails.customerName"
                         class="form-control cashInvoiceInput" [(ngModel)]="invFormData.voucherDetails.customerName"
                         [readOnly]="isUpdateMode">
                </ng-container>

              </div>


            </div>
            <div class="vendore-name" [hidden]="!isPurchaseInvoice">
              <div class="col-sm-2">
                <label>Vendor Name</label>
              </div>
              <div class="col-sm-5">
                <div class="flex-row-child">
                  <div class="form-group noMarg">

                    <!-- [useInBuiltFilterForIOptionTypeItems]="true" -->
                    <!--  -->
                    <sales-sh-select style="width:100%;" name="voucherDetails.customerName"
                                     [options]="customerAcList$ | async"
                                     [(ngModel)]="invFormData.voucherDetails.tempCustomerName"
                                     [customFilter]="customMoveGroupFilter"
                                     (noOptionsFound)="noResultsForCustomer($event)"
                                     (selected)="onSelectCustomer($event)" [placeholder]="'Select Vendor'"
                                     [notFoundLink]="true" [doNotReset]="true"
                                     [forceClearReactive]="forceClear$ | async"
                                     [isFilterEnabled]="true" (noResultsClicked)="toggleAccountAsidePane($event)"
                                     [multiple]="false" [ItemHeight]="67" [notFoundLinkText]="'Add Vendor'"
                                     (keyup)="resetCustomerName($event)" (onClear)="resetCustomerName(null)"
                                     [showClear]="!isUpdateMode">
                      <ng-template #optionTemplate let-option="option">
                        <a href="javascript:void(0)" class="list-item" style="border-bottom: 1px solid #ccc;">
                          <div class="item">{{ option.label }}</div>
                          <div class="item_unq">{{ option.value }}</div>
                        </a>
                      </ng-template>
                    </sales-sh-select>
                  </div>
                </div>
              </div>

            </div>
            <div class="col-sm-10 col-sm-offset-2">
              <ng-container>
                <section class="form-inline  ">
                  <div class=" wrap-billing-address clearfix">
                    <ng-container *ngIf="isSalesInvoice || isPurchaseInvoice">
                      <img src="assets/images/new/search_customer.svg" class="img-responsive tip_img "
                           *ngIf="!invFormData.voucherDetails.customerName"/>
                    </ng-container>
                    <ng-container *ngIf="isCashInvoice">
                      <img src="assets/images/new/search_customer_Cash Invoice.svg" class="img-responsive tip_img "
                           *ngIf="!invFormData.voucherDetails.customerName"
                           [ngClass]="{'cashinvoice_tipImg' : isCashInvoice}"/>
                    </ng-container>
                    <div class="row">
                      <div class="col-xs-6">
                        <div class="form-group">
                          <label>Billing Address</label>
                          <div class="billing-address clearfix">
                            <textarea name="billingDetails.address" (keyup)="autoFillShippingDetails()"
                                      class="form-control"
                                      [(ngModel)]="invFormData.accountDetails.billingDetails.address[0]" rows="3"
                                      autocomplete="off" autofocus="off" aria-autocomplete="none"></textarea>
                            <div class="">
                              <div class="col-sm-6 pd">
                                <!-- <label>Country</label> -->

                                <label class="salesCountryLabel">
                                  {{ customerCountryName }}
                                </label>

                              </div>
                              <div class="col-sm-6 pd stateField">
                                <!-- <label>State</label> -->
                                <!-- remove disabled after api changes -->
                                <sales-sh-select [disabled]="isUpdateMode" [placeholder]="'State'"
                                                 class="select-bdr-bottom" (selected)="autoFillShippingDetails()"
                                                 #statesBilling [showBottomBorderOnly]="true"
                                                 [options]="statesSource$ | async" name="billingDetails.stateCode"
                                                 [(ngModel)]="invFormData.accountDetails.billingDetails.stateCode"></sales-sh-select>
                                <!-- <ng-select (selected)="autoFillShippingDetails()" #statesBilling class="splSales" name="billingDetails.stateCode" [options]="statesSource$ | async"
[(ngModel)]="invFormData.accountDetails.billingDetails.stateCode"></ng-select> -->
                              </div>
                              <div class="col-sm-12 pd">
                                <!-- <label>GSTIN</label> -->
                                <!-- remove disabled after api changes -->
                                <input [disabled]="isUpdateMode" maxLength="15" type="text"
                                       name="billingDetails.gstNumber" class="form-control input-custom"
                                       [(ngModel)]="invFormData.accountDetails.billingDetails.gstNumber"
                                       (keyup)="getStateCode('billingDetails', statesBilling); autoFillShippingDetails()"
                                       placeholder="GSTIN"/>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-xs-6">
                        <div class="form-group p0 width100">
                          <label>
                            <input type="checkbox" (change)="autoFillShippingDetails()" name="autoFillShipping"
                                   [attr.checked]="true"
                                   [(ngModel)]="autoFillShipping"> Shipping Address Same as Billing Address</label>
                          <div class="billing-address" [ngClass]="{'disabled': autoFillShipping}">
                            <textarea [readonly]="autoFillShipping" name="shippingDetails.address" class="form-control"
                                      [(ngModel)]="invFormData.accountDetails.shippingDetails.address[0]" rows="3"
                                      autocomplete="off"></textarea>
                            <div class="clearfix">
                              <div class="form-group">
                                <div class="col-sm-6 pd">
                                  <div class="form-group">

                                    <label class="salesCountryLabel">
                                      {{ customerCountryName }}
                                    </label>
                                  </div>
                                </div>
                                <div class="col-sm-6 pd stateField">
                                  <!-- <label>State</label> -->
                                  <!-- <ng-select [disabled]="autoFillShipping" #statesShipping class="splSales" name="shippingDetails.stateCode" [options]="statesSource$ | async" [(ngModel)]="invFormData.accountDetails.shippingDetails.stateCode"></ng-select> -->
                                  <!-- (selected)="autoFillShippingDetails()" -->

                                  <!-- use this after api changes [disabled]="autoFillShipping"  -->
                                  <sales-sh-select [disabled]="isUpdateMode" [placeholder]="'State'"
                                                   class="select-bdr-bottom" #statesShipping
                                                   [showBottomBorderOnly]="true" [options]="statesSource$ | async"
                                                   name="shippingDetails.stateCode"
                                                   [(ngModel)]="invFormData.accountDetails.shippingDetails.stateCode"></sales-sh-select>
                                </div>
                                <div class="col-sm-12 pd">
                                  <!-- <label>GSTIN</label> -->
                                  <!-- remove disabled after api changes and add [readonly]="autoFillShipping" -->
                                  <input [disabled]="isUpdateMode" maxLength="15" type="text"
                                         name="shippingDetails.gstNumber" class="form-control input-custom"
                                         [(ngModel)]="invFormData.accountDetails.shippingDetails.gstNumber"
                                         (keyup)="getStateCode('shippingDetails', statesShipping)"
                                         placeholder="GSTIN"/>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>


                  </div>

                </section>
              </ng-container>
            </div>
          </div>
          <div class="col-md-3  balncDue">
            <div class=" text-right" *ngIf="invFormData.voucherDetails.customerName" [hidden]="isPurchaseInvoice">
              <p *ngIf="toggleFieldForSales" class="fs20 b">
                <span class="balance-due">Balance Due: </span>
                <span class="sp-rupees">Rs {{invFormData.voucherDetails.balanceDue | number:'1.2-2'}}</span>
              </p>
            </div>
          </div>
        </div>
      </div>

      <div class="">
        <div class="col-md-9 pd0">
          <div class="attention-to clearfix">
            <div class="col-sm-2">
              <label>Attention to</label>
            </div>
            <div class="col-sm-5">
              <div class="form-group">
                <!--col-xs-3 -->
                <input type="text" name="accountDetails.attention" placeholder="Attention to"
                       class="form-control attentionTo" [(ngModel)]="invFormData.accountDetails.attentionTo"/>
              </div>
            </div>


          </div>
          <div class="email-id clearfix">
            <div class="col-sm-2">
              <label>Email Id</label>
            </div>
            <div class="col-sm-5">
              <div class="form-group">
                <!--col-xs-3 -->
                <input type="email" placeholder="someone@example.com" name="accountDetails.email"
                       class="form-control attentionTo" [(ngModel)]="invFormData.accountDetails.email"/>
              </div>
            </div>


          </div>
          <div class="mobile-number clearfix">
            <div class="col-sm-2">
              <label>Mobile Number</label>
            </div>
            <div class="col-sm-5">
              <div class="form-group">
                <input digitsOnlyDirective placeholder="9198XXXXXXXX" type="text" name="accountDetails.mobileNumber"
                       class="form-control attentionTo" [(ngModel)]="invFormData.accountDetails.mobileNumber"/>
              </div>
            </div>


          </div>
          <div class="inovice-purchaseInvoice" [ngClass]="{'forPurchase': isPurchaseInvoice}">
            <div class="col-sm-2">
              <label> {{ !isPurchaseInvoice ? 'Invoice No.' : 'Purchase Invoice No.' }}</label>
            </div>
            <div class="col-sm-5">
              <input type="text" name="accountDetails.invoiceNum" class="form-control invoiceDate attentionTo"
                     [ngClass]="{'dateinvoice': !isPurchaseInvoice }"
                     [disabled]="isUpdateMode  || !useCustomInvoiceNumber"
                     [(ngModel)]="invFormData.voucherDetails.voucherNumber"/>
            </div>
            <div class="col-sm-5 invoiceDateDueDate">
              <div class="form-inline ">
                <div class="form-group m-r-15">
                  <!--col-xs-2-->
                  <label>Invoice Date</label>

                  <input type="text" [placeholder]="giddhDateFormat" #voucherDate="ngModel" name="voucherDate"
                         class="form-control dateinvoice" bsDatepicker
                         [bsConfig]="{ dateInputFormat: giddhDateFormat }"
                         [(ngModel)]="invFormData.voucherDetails.voucherDate" [disabled]="isUpdateMode"
                         [class.invalid-inp]="voucherDate.errors && (voucherDate.dirty || voucherDate.touched)"/>
                  <p class="text-danger" *ngIf="voucherDate.errors && (voucherDate.dirty || voucherDate.touched)">
                    Invalid Date
                  </p>


                </div>
                <div class="form-group  m-l-5" *ngIf="isSalesInvoice || isPurchaseInvoice">
                  <label> {{isPurchaseInvoice ? 'Bill Due Date' : 'Due Date'}}</label>

                  <input type="text" [placeholder]="giddhDateFormat" #dueDate="ngModel" name="dueDate"
                         class="form-control dateinvoice" bsDatepicker
                         [bsConfig]="{ dateInputFormat: giddhDateFormat }"
                         [(ngModel)]="invFormData.voucherDetails.dueDate"
                         [class.invalid-inp]="dueDate.errors && (dueDate.dirty || dueDate.touched)"
                  />
                  <p class="text-danger" *ngIf="dueDate.errors && (dueDate.dirty || dueDate.touched)">Invalid Date</p>

                </div>
              </div>
            </div>
          </div>
          <div class="">
            <ng-container>

              <section class="staticInvoiceTable salseInvoicetable clearfix mrB2 whiteBg container-fluid ng-tns-c8-0 ">
                <div class="table_width-small ">
                  <table class="table  table-custom-invoice  basic">
                    <thead>
                    <tr>

                      <th *ngFor="let item of theadArrReadOnly;" attr.data-field="{{item.label}}"
                          [hidden]="!item.display">
                        {{item.label}}

                      </th>
                    </tr>
                    </thead>
                    <tbody
                      *ngFor="let entry of invFormData.entries; let entryIdx = index; let first = first; let last = last">
                    <ng-container *ngFor="let transaction of entry.transactions;">
                      <tr (click)="setActiveIndx($event, entryIdx, true)" *ngIf="activeIndx !== entryIdx">
                        <td>{{ entryIdx + 1 }}</td>
                        <td>
                          <div class="productName">
                            <label *ngIf="!transaction.accountName" class="selectAccountLabel">Click to Select
                              Account</label> {{transaction.accountName}}
                            <span *ngIf="transaction.stockDetails?.uniqueName">({{transaction.stockDetails?.name}}
                              )</span>

                          </div>
                          <div class="skuNumber">
                            <label>SKU:</label>Number
                          </div>
                          <div class="discription">
                            {{transaction.description}}

                          </div>
                          <div class="dateHsnCode">
                            <div class="row">
                              <div class="col-xs-6" *ngIf="entry.entryDate">
                                <div class="entryDate">
                                  <label>Entry Date: </label> {{entry.entryDate | date: 'dd-MM-yyyy'}}
                                  <span class="edit-icon" *ngIf="!isUpdateMode">
                          <img src="assets/images/edit-pencilicon.svg">
                         </span>


                                </div>
                              </div>
                              <div class="col-xs-6" *ngIf="transaction.hsnNumber || transaction.sacNumber">
                                <div class="hsnCode text-right">
                                  <label> HSN/SAC Code:</label>
                                  <span>
                            {{transaction.hsnOrSac === 'hsn' ? transaction.hsnNumber : transaction.sacNumber}}
                                    <!--                            <span class="edit-icon">-->
                                    <!--                              <img src="assets/images/edit-pencilicon.svg">-->
                                    <!--                            </span>-->
                          </span>

                                </div>
                              </div>
                            </div>
                          </div>

                        </td>
                        <td class="text-right">
                          <!-- <input type="number" (keyup)="txnChangeOccurred()"
        (ngModelChange)="transaction.setAmount(entry)" placeholder="Quantity"
        name="transaction.quantity_{{entryIdx}}" class="form-control text-right"
        [(ngModel)]="transaction.quantity"/>

        <select class="form-control" name="transaction.stockUnit_{{entryIdx}}"
        [(ngModel)]="transaction.stockUnit"
        (ngModelChange)="onChangeUnit(transaction, $event);transaction.setAmount(entry)">
        <option *ngFor="let stock of transaction.stockList" [ngValue]="stock.id">{{stock.text}}
        </option>
        </select> -->
                          {{transaction.quantity}} {{transaction.stockUnit}}
                        </td>
                        <td class="text-right">
                          <!-- <input type="number" (ngModelChange)="transaction.setAmount(entry)"
        (keyup)="txnChangeOccurred()" placeholder="Rate" name="transaction.rate_{{entryIdx}}"
        class="form-control text-right" [(ngModel)]="transaction.rate"/> -->
                          {{transaction.rate | number:'1.2-2'}}
                        </td>
                        <td class="text-right">
                          {{transaction.amount | number:'1.2-2'}}
                        </td>
                        <td>

                          <div class=" text-right">
                            {{ entry.discountSum | number:'1.2-2'}}
                          </div>


                        </td>
                        <td class="text-right">{{entry.taxSum}}%</td>
                        <td class="text-right">
                          <div style="display: flex;flex-direction: column;">
                            <span>{{transaction.total | number:'1.2-2'}}</span>
                            <span *ngIf="entry.isOtherTaxApplicable">
                      Other Tax: {{ entry.otherTaxesSum }}
                    </span>
                          </div>
                        </td>
                        <td class="text-center" style="width:3%;">
                                        <span class="cp" (click)="removeTransaction(entryIdx)"
                                              *ngIf="!isUpdateMode || (isUpdateMode && entry.isNewEntryInUpdateMode)">
                        <i class="icon-trash" aria-hidden="true"></i>
                  </span>
                        </td>
                      </tr>
                      <tr *ngIf="activeIndx === entryIdx">
                        <td>{{ entryIdx + 1 }}</td>
                        <td>
                          <div class="productName">
                            <div class="ng-select-wrap">
                              <sh-select [options]="salesAccounts$ | async" [(ngModel)]="transaction.fakeAccForSelect2"
                                         name="transaction.fakeAccForSelect2_{{entryIdx}}"
                                         (selected)="onSelectSalesAccount($event,transaction,entryIdx, entry)"
                                         [placeholder]="'Select A/cc'" [notFoundLink]="true"
                                         [forceClearReactive]="forceClear$ | async"
                                         (onClear)="onClearSalesAccount(transaction)"
                                         (noResultsClicked)="onNoResultsClicked(entryIdx)" [multiple]="false"
                                         [ItemHeight]="67"
                                         [useInBuiltFilterForFlattenAc]="true">

                                <ng-template #optionTemplate let-option="option">
                                  <ng-container *ngIf="!option.additional?.stock">
                                    <a href="javascript:void(0)" class="list-item"
                                       style="border-bottom: 1px solid #ccc;">
                                      <div class="item">{{ option.label }}</div>
                                      <div class="item_unq">{{ option.additional?.uniqueName }}</div>
                                    </a>
                                  </ng-container>
                                  <ng-container *ngIf="option.additional?.stock">
                                    <a href="javascript:void(0)" class="list-item"
                                       style="border-bottom: 1px solid #ccc;">
                                      <div class="item">{{ option.label }}</div>
                                      <div class="item_unq">{{ option.additional?.uniqueName }}</div>
                                      <div class="item_stock">Stock: {{ option.additional?.stock.uniqueName }}</div>
                                    </a>
                                  </ng-container>
                                </ng-template>
                              </sh-select>
                            </div>

                          </div>
                          <div class="" *ngIf="transaction.fakeAccForSelect2">
                            <div class="skuNumber">
                              <label>SKU:</label>Number
                            </div>
                            <div class="discription">
                      <textarea type="text" placeholder="Add Description" name="transaction.description_{{entryIdx}}"
                                class="form-control" [(ngModel)]="transaction.description"></textarea>

                            </div>
                            <div class="dateHsnCode">
                              <div class="row">
                                <div class="col-xs-6">
                                  <div class="entryDate">
                                    <label>Entry Date: </label>
                                    <span *ngIf="!isUpdateMode">
                                <input type="text" [placeholder]="giddhDateFormat" bsDatepicker
                                       name="transaction.date_{{entryIdx}}"
                                       class="form-control text-left" [(ngModel)]="entry.entryDate"
                                       [disabled]="isUpdateMode"
                                       [bsConfig]="{ dateInputFormat: giddhDateFormat }" #dp="bsDatepicker"
                                />
                            <span class="edit-icon" (click)="dp.toggle()" [attr.aria-expanded]="dp.isOpen">
                              <img src="assets/images/edit-pencilicon.svg">
                            </span>
                                                            </span>

                                    <span *ngIf="isUpdateMode">
                            {{ entry.entryDate | date: 'dd-MM-yyyy' }}
                          </span>

                                  </div>
                                </div>
                                <div class="col-xs-6">
                                  <div class="wrap-hsnBox">
                                    <div class="hsnCode text-right"
                                         (click)="$event.stopPropagation();hsnDropdownShow=!hsnDropdownShow">
                                      <label>HSN/SAC Code:</label>
                                      <span>
                              <!-- <input type="text" [hidden]="transaction.hsnOrSac !== 'hsn'" maxLength="10" placeholder="HSN Number"
                              name="transaction.hsnNumber_{{entryIdx}}" class="form-control text-right"
                              [(ngModel)]="transaction.hsnNumber"/> -->
                                        {{transaction.hsnOrSac === 'hsn' ? transaction.hsnNumber : transaction.sacNumber }}
                                        <span *ngIf="!transaction.hsnNumber && !transaction.sacNumber"
                                              class="updateText cp">Update
                                </span>
                                                                <span class="edit-icon">
                                 <img src="assets/images/edit-pencilicon.svg">
                                </span>
                                                                </span>

                                    </div>


                                    <div class="hsnCodeDropdown" *ngIf="hsnDropdownShow">
                                      <label>HSN/SAC Code:</label>
                                      <input type="text" maxLength="10" placeholder="HSN/SAC Number"
                                             name="transaction.hsnNumber_{{entryIdx}}" class=""
                                             [(ngModel)]="transaction.hsnNumber"
                                             *ngIf="transaction.hsnOrSac === 'hsn'"/>

                                      <input type="text" maxLength="10" placeholder="SAC Number"
                                             name="transaction.sacNumber_{{entryIdx}}" class=""
                                             [(ngModel)]="transaction.sacNumber"
                                             *ngIf="transaction.hsnOrSac === 'sac'"/>
                                      <!--                              <a><i class="fa fa-search"></i> </a>-->
                                      <div class="btn-group">
                                        <button class="btn btn-sm btn-success" type="button"
                                                (click)="hsnDropdownShow=!hsnDropdownShow">Save
                                        </button>
                                        <button class="btn btn-sm btn-primary" type="button"
                                                (click)="hsnDropdownShow=!hsnDropdownShow">Cancel
                                        </button>
                                      </div>

                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </td>
                        <td class="text-right">
                          <input type="number" [disabled]="!transaction.isStockTxn" (keyup)="txnChangeOccurred()"
                                 (ngModelChange)="transaction.setAmount(entry)" placeholder="Quantity"
                                 name="transaction.quantity_{{entryIdx}}" class="form-control text-right"
                                 [(ngModel)]="transaction.quantity"
                          />

                          <select class="form-control" [disabled]="!transaction.isStockTxn"
                                  name="transaction.stockUnit_{{entryIdx}}" [(ngModel)]="transaction.stockUnit"
                                  (ngModelChange)="onChangeUnit(transaction, $event);transaction.setAmount(entry)">
                            <option *ngFor="let stock of transaction.stockList" [ngValue]="stock.id">{{stock.text}}
                            </option>
                          </select>
                        </td>
                        <td class="text-right">
                          <input type="number" [disabled]="!transaction.isStockTxn"
                                 (ngModelChange)="transaction.setAmount(entry)" (keyup)="txnChangeOccurred()"
                                 placeholder="Rate"
                                 name="transaction.rate_{{entryIdx}}" class="form-control transaction-rate text-right"
                                 [(ngModel)]="transaction.rate"
                          />

                        </td>
                        <td class="text-right">
                          <input type="text" [disabled]="transaction.isStockTxn"
                                 (ngModelChange)="transaction.setAmount(entry)"
                                 (keyup)="txnChangeOccurred()" placeholder="Amount"
                                 name="transaction.amount_{{entryIdx}}"
                                 class="form-control text-right" [(ngModel)]="transaction.amount"
                                 decimalDigitsDirective [DecimalPlaces]="2"/>
                        </td>
                        <td>

                          <div class=" text-right">
                            <discount-list #discountComponent [isMenuOpen]="false"
                                           [discountAccountsDetails]="entry.discounts"
                                           (discountTotalUpdated)="entry.discountSum = $event; selectedDiscountEvent(transaction, entry)"
                                           [totalAmount]="transaction.amount"></discount-list>
                          </div>


                        </td>
                        <td class="text-right">
                          <sales-tax-list class="salesTax" [showTaxPopup]="false" [taxListAutoRender]="entry.taxList"
                                          [applicableTaxes]="transaction.applicableTaxes"
                                          [exceptTaxTypes]="['tdsrc', 'tdspay','tcspay', 'tcsrc']"
                                          (selectedTaxEvent)="selectedTaxEvent($event)"
                                          (closeOtherPopupEvent)="closeDiscountPopup()"
                                          (taxAmountSumEvent)="taxAmountEvent($event)">
                          </sales-tax-list>
                        </td>
                        <td class="text-right">
                          <input type="text" name="transaction.total_{{entryIdx}}" class="form-control text-right"
                                 [(ngModel)]="transaction.total" readonly decimalDigitsDirective [DecimalPlaces]="2"/>

                                 <div class="wrap-otherTax">
                          <input type="checkbox" class="other-taxes-checkobx" [(ngModel)]="entry.isOtherTaxApplicable"
                                 *ngIf="!entry.isOtherTaxApplicable"
                                 name="entry.isOtherTaxApplicable_{{entryIdx}}"
                                 id="entry.isOtherTaxApplicable_{{entryIdx}}"
                                 (ngModelChange)="toggleOtherTaxesAsidePane(entry.isOtherTaxApplicable, entryIdx)">
                          <label for="entry.isOtherTaxApplicable_{{entryIdx}}" *ngIf="!entry.isOtherTaxApplicable" class="otherTaxLable" style="font-size:13px;">Other taxes ?</label>
                        </div>
                          <div *ngIf="entry.isOtherTaxApplicable" class="mrT1">

                   

                            <span>
                                <span>
                                    <a href="javascript: void 0" (click)="toggleOtherTaxesAsidePane(true, entryIdx, false)">
                                      <img src="assets/images/edit-pencilicon.svg">
                                    </a>
                                  </span>
                      <input class="text-right" disabled="disabled" class="otherTaxsinput" [(ngModel)]="entry.otherTaxesSum"
                             name="entry.otherTaxesSum"/>
                    </span>

                          </div>

                          <!--                  <ng-container-->
                          <!--                    *ngTemplateOutlet="otherTaxSidePane;context: {$implicit: selectedEntry }"></ng-container>-->
                        </td>
                        <td class="action-panel-td text-center" style="width:3%;">
                  <span class="cp" (click)="removeTransaction(entryIdx)"
                        *ngIf="!isUpdateMode || (isUpdateMode && entry.isNewEntryInUpdateMode)">
                  <i class="icon-trash" aria-hidden="true"></i>
                </span>
                        </td>
                      </tr>

                    </ng-container>

                    </tbody>

                    <div class="p-4 aquaColor add-line-bulk-item" style="width: max-content;">
                      <a class="" href="javascript:void 0" (click)="addBlankRow(null)">+ Add New Line</a>
                    </div>

                    <tfoot>

                    <tr>
                      <td colspan="4">
                        <div class="">
                          <div class="collapse-pane clearfix">
                            <div class="collapse-pane-heading" (click)="isOthrDtlCollapsed = !isOthrDtlCollapsed">
                              <div class="ico-box-wrap">
                                <div class="ico-box">
                                  <span [ngClass]="isOthrDtlCollapsed ? 'icon-add' : 'icon-minus'"
                                        aria-hidden="true"></span>
                                </div>
                              </div>
                              <div class="ico-head">Other Details</div>
                            </div>
                            <div [collapse]="isOthrDtlCollapsed" class="clearfix max-600 pdL3 mr0">
                              <div class="row">
                                <div class="form-group col-xs-4">
                                  <!-- <label>Ship Date</label> -->
                                  <input type="text" #shippingDate="ngModel" [placeholder]="giddhDateFormat"
                                         bsDatepicker
                                         name="shippingDate"
                                         [(ngModel)]="invFormData.templateDetails.other.shippingDate"
                                         class="form-control" [bsConfig]="{ dateInputFormat: giddhDateFormat }"
                                         placeholder="Ship Date"
                                         [class.invalid-inp]="shippingDate.errors && (shippingDate.dirty || shippingDate.touched)"/>
                                  <p class="text-danger"
                                     *ngIf="shippingDate.errors && (shippingDate.dirty || shippingDate.touched)">Invalid
                                    Date
                                  </p>
                                  <!--[placeholder]="giddhDateFormat"-->
                                </div>
                                <div class="form-group col-xs-4">
                                  <!-- <label>Ship Via</label> -->
                                  <input type="text" name="shippedVia"
                                         [(ngModel)]="invFormData.templateDetails.other.shippedVia" class="form-control"
                                         placeholder="Ship Via"/>
                                </div>
                                <div class="form-group col-xs-4">
                                  <!-- <label>Tracking No.</label> -->
                                  <input type="text" name="trackingNumber"
                                         [(ngModel)]="invFormData.templateDetails.other.trackingNumber"
                                         class="form-control"
                                         placeholder="Tracking No."/>
                                </div>
                              </div>
                              <div class="row">
                                <div class="form-group col-xs-4">
                                  <!-- <label>Field 1</label> -->
                                  <input type="text" name="customField1"
                                         [(ngModel)]="invFormData.templateDetails.other.customField1"
                                         class="form-control"
                                         placeholder="Field 1"/>
                                </div>
                                <div class="form-group col-xs-4">
                                  <!-- <label>Field 2</label> -->
                                  <input type="text" name="customField2"
                                         [(ngModel)]="invFormData.templateDetails.other.customField2"
                                         class="form-control"
                                         placeholder="Field 2"/>
                                </div>
                                <div class="form-group col-xs-4">
                                  <!-- <label>Field 3</label> -->
                                  <input type="text" name="customField3"
                                         [(ngModel)]="invFormData.templateDetails.other.customField3"
                                         class="form-control"
                                         placeholder="Field 3"/>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="pdT1 pl0 max-600" *ngIf="!isPurchaseInvoice">
                          <label class="mrB1">Message</label>
                          <textarea style="height:120px !important" class="form-control" name="message2"
                                    [(ngModel)]="invFormData.templateDetails.other.message2"></textarea>
                        </div>
                        <!-- commented due to presently attachfile key is not available in request
        -->
                        <div class="pdT1 pl0 max-600 pos-rel" *ngIf="isPurchaseInvoice">
                          <label class="mrB1"><i class="glyphicon glyphicon-paperclip"></i> Attachment</label>
                          <label class="custom-file-label form-control cp pos-rel" for="invoiceFile"> <em
                            *ngIf="!selectedFileName">Drag/Drop
                            file or click here</em> <em *ngIf="selectedFileName"
                                                        class="text-success">{{selectedFileName}}</em>
                            <span class="text-success"><i class="fa fa-check" *ngIf="selectedFileName"></i></span>
                            <input type="file" name="invoiceFile" id="invoiceFile" [options]="fileUploadOptions"
                                   ngFileSelect
                                   [uploadInput]="uploadInput" (uploadOutput)="onUploadOutput($event)"
                                   (change)="onFileChange($event.target.files)" droppable="true">
                          </label>
                        </div>
                      </td>
                      <td colspan="4">
                        <section class="tableSec form-group">
                          <div class="tableRow">
                            <div class="tableCell">Total Amount</div>
                            <div
                              class="tableCell figureCell">{{invFormData.voucherDetails.subTotal | number:'1.2-2'}}</div>
                          </div>
                          <div class="tableRow">
                            <div class="tableCell">Discount</div>
                            <div class="tableCell figureCell">
                              -{{invFormData.voucherDetails.totalDiscount | number:'1.2-2'}}</div>
                          </div>
                          <div class="tableRow">
                            <div class="tableCell">Taxable Value</div>
                            <div
                              class="tableCell figureCell">{{invFormData.voucherDetails.totalTaxableValue | number:'1.2-2'}}
                            </div>
                          </div>
                          <div class="tableRow">
                            <div class="tableCell">Tax</div>
                            <div
                              class="tableCell figureCell">{{invFormData.voucherDetails.gstTaxesTotal | number:'1.2-2'}}</div>
                          </div>

                          <div class="tableRow">
                            <div class="tableCell">TCS</div>
                            <div
                              class="tableCell figureCell">{{invFormData.voucherDetails.tdsTcsTotal | number:'1.2-2'}}</div>
                          </div>

                          <div class="tableRow" *ngIf="isPurchaseInvoice">
                            <div class="tableCell">TDS</div>
                            <div
                              class="tableCell figureCell">{{invFormData.voucherDetails.tdsTcsTotal | number:'1.2-2'}}</div>
                          </div>

                          <div class="tableRow">
                            <div class="tableCell">CESS</div>
                            <div class="tableCell figureCell">{{invFormData.voucherDetails.cessTotal | number:'1.2-2'}}
                            </div>
                          </div>
                          <div class="tableRow">
                            <div class="tableCell">
                              <strong>Total</strong>
                            </div>
                            <div class="tableCell figureCell">
                              <strong>{{invFormData.voucherDetails.grandTotal | number:'1.2-2'}}</strong>
                            </div>
                          </div>
                          <div class="tableRow" *ngIf="isSalesInvoice || isCashInvoice">
                            <!-- (clickOutside)="dropdownisOpen=false;" [attachOutsideOnClick]="true" -->
                            <div class="tableCell depositeSection">
                              <!--
        <div class="btn-group" dropdown #depositDropdown="bs-dropdown" [autoClose]="false">
        -->
                              <div class="btn-group">
                                <!-- <button id="depositBoxTrigger" type="button" class="btn btn-default "
            aria-controls="deposit-dropdown">
        {{ isPurchaseInvoice ? 'Payment' : 'Deposit' }}
        </button> -->
                                <div (click)="clickedInside($event)" id="deposit-dropdown" class=" form-group pd1">
                                  <p>Deposit</p>
                                  <ul>


                                    <li role="menuitem">
                                      <div class="">
                                    <li role="menuitem" class="mrT1 ">
                                      <div class="clearfix paymentMode">

                                        <sh-select class="pull-right " name="depositAccountUniqueName"
                                                   [options]="bankAccounts$ | async"
                                                   [(ngModel)]="depositAccountUniqueName"
                                                   (selected)="onSelectPaymentMode($event)"
                                                   [placeholder]="'Select Account'"
                                                   [notFoundLink]="false" [forceClearReactive]="forceClear$ | async"
                                                   [multiple]="false" [ItemHeight]="33"
                                                   [useInBuiltFilterForIOptionTypeItems]="true" class="text-left">
                                          <ng-template #optionTemplate1 let-option="option">
                                            <a href="javascript:void(0)" class="list-item"
                                               style="border-bottom: 1px solid #ccc;">
                                              <div class="item">{{ option.label }}</div>
                                              <div class="item_unq">{{ option.value }}</div>
                                            </a>
                                          </ng-template>
                                        </sh-select>
                                        <label class="pull-right">Payment Mode</label>
                                      </div>
                                    </li>
                                    <li class="clearfix mrT1">
                                      <input *ngIf="isSalesInvoice" type="number" (blur)="txnChangeOccurred()"
                                             placeholder="Amount" name="dueAmount"
                                             class="form-control amountField pull-right max100" [(ngModel)]="dueAmount"
                                             [readonly]='isCashInvoice' [ngClass]='{"amountFiledCash": isCashInvoice}'
                                      />
                                      <span *ngIf="isCashInvoice" class="amountField pull-right max100"
                                            [ngClass]='{"amountFiledCash": isCashInvoice}'>{{invFormData.voucherDetails.grandTotal | number:'1.2-2'}}</span>

                                      <label class="pull-right">Amount</label>
                                    </li>
                                    <li *ngIf="toggleFieldForSales" class="clearfix mrT1">
                                      <strong
                                        class="pull-right balanceDueText">{{invFormData.voucherDetails.balanceDue | number:'1.2-2'}}</strong>
                                      <strong class="pull-right">Balance Due</strong>
                                    </li>
                                </div>


                                </ul>
                                <div class="tableRow" *ngIf="toggleFieldForSales">
                                  <div class="tableCell">

                                  </div>
                                  <div class="tableCell figureCell">

                                  </div>
                                </div>
                              </div>
                            </div>

                          </div>
                </div>
                <div class="tableRow" *ngIf="isPurchaseInvoice">
                  <div class="tableCell">
                    <strong>Balance Due </strong>
                  </div>
                  <div class="tableCell figureCell">
                    <strong>{{invFormData.voucherDetails.balanceDue | number:'1.2-2'}}</strong>
                  </div>
                </div>


              </section>
              </td>
              <td></td>
              </tr>
              </tfoot>

              </table>
          </div>
          <!-- region dummy data -->
          <ng-template #template>
            <div class="">
              <div class="modal-header">
                <h4 class="modal-title pull-left">Add bulk items</h4>
                <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <div class="row">
                  <div class="col-md-6">
                    <div class="leftContent">
                      <div class="searchBox">
                        <input type="text" placeholder="Search stock">
                      </div>
                      <div class="productList">
                        <div class="singleProductWrapper">
                          <h5>Sales (100 POLYSTER NON TEXTURED LINING FABRIC)</h5>
                          <p>
                            <span class="stockSku"><label>SKU: </label>Number</span>
                            <span class="rateStock"><label>Rate:</label> </span>$2000/-
                          </p>
                        </div>
                        <div class="singleProductWrapper">
                          <h5>Sales (Dummy text Lorem ipsum)</h5>
                          <p>

                            <span class="rateStock"><label>Rate:</label> </span>$2000/-
                          </p>
                        </div>
                        <div class="singleProductWrapper">
                          <h5>Sales (100 POLYSTER NON TEXTURED LINING FABRIC)</h5>
                          <p>
                            <span class="stockSku"><label>SKU: </label>Number</span>
                            <span class="rateStock"><label>Rate:</label> </span>$2000/-
                          </p>
                        </div>
                        <div class="singleProductWrapper">
                          <h5>Sales (100 POLYSTER NON LINING FABRIC)</h5>
                          <p>
                            <span class="stockSku"><label>SKU: </label>Number</span>
                            <span class="rateStock"><label>Rate:</label> </span>$2000/-
                          </p>
                        </div>
                        <div class="singleProductWrapper">
                          <h5>Sales (100 POLYSTER NON TEXTURED LINING FABRIC)</h5>
                          <p>
                            <span class="stockSku"><label>SKU: </label>Number</span>
                            <span class="rateStock"><label>Rate:</label> </span>$2000/-
                          </p>
                        </div>
                        <div class="singleProductWrapper">
                          <h5>Sales (100 POLYSTER NON TEXTURED LINING FABRIC)</h5>
                          <p>
                            <span class="stockSku"><label>SKU: </label>Number</span>
                            <span class="rateStock"><label>Rate:</label> </span>$2000/-
                          </p>
                        </div>
                        <div class="singleProductWrapper">
                          <h5>Sales (100 POLYSTER NON)</h5>
                          <p>
                            <span class="stockSku"><label>SKU: </label>Number</span>
                            <span class="rateStock"><label>Rate:</label> </span>$2000/-
                          </p>
                        </div>
                        <div class="singleProductWrapper">
                          <h5>Sales (100 POLYSTER NON TEXTURED LINING FABRIC)</h5>
                          <p>
                            <span class="stockSku"><label>SKU: </label>Number</span>
                            <span class="rateStock"><label>Rate:</label> </span>$2000/-
                          </p>
                        </div>
                        <div class="singleProductWrapper">
                          <h5>Sales (100 POLYSTER NON TEXTURED LINING FABRIC)</h5>
                          <p>
                            <span class="stockSku"><label>SKU: </label>Number</span>
                            <span class="rateStock"><label>Rate:</label> </span>$2000/-
                          </p>
                        </div>
                        <div class="singleProductWrapper">
                          <h5>Sales (Dummy text Lorem ipsum)</h5>
                          <p>

                            <span class="rateStock"><label>Rate:</label> </span>$2000/-
                          </p>
                        </div>
                        <div class="singleProductWrapper">
                          <h5>Sales (100 POLYSTER NON TEXTURED LINING FABRIC)</h5>
                          <p>
                            <span class="stockSku"><label>SKU: </label>Number</span>
                            <span class="rateStock"><label>Rate:</label> </span>$2000/-
                          </p>
                        </div>
                        <div class="singleProductWrapper">
                          <h5>Sales (100 POLYSTER NON LINING FABRIC)</h5>
                          <p>
                            <span class="stockSku"><label>SKU: </label>Number</span>
                            <span class="rateStock"><label>Rate:</label> </span>$2000/-
                          </p>
                        </div>
                        <div class="singleProductWrapper">
                          <h5>Sales (100 POLYSTER NON TEXTURED LINING FABRIC)</h5>
                          <p>
                            <span class="stockSku"><label>SKU: </label>Number</span>
                            <span class="rateStock"><label>Rate:</label> </span>$2000/-
                          </p>
                        </div>
                        <div class="singleProductWrapper">
                          <h5>Sales (100 POLYSTER NON TEXTURED LINING FABRIC)</h5>
                          <p>
                            <span class="stockSku"><label>SKU: </label>Number</span>
                            <span class="rateStock"><label>Rate:</label> </span>$2000/-
                          </p>
                        </div>
                        <div class="singleProductWrapper">
                          <h5>Sales (100 POLYSTER NON)</h5>
                          <p>
                            <span class="stockSku"><label>SKU: </label>Number</span>
                            <span class="rateStock"><label>Rate:</label> </span>$2000/-
                          </p>
                        </div>
                        <div class="singleProductWrapper">
                          <h5>Sales (100 POLYSTER NON TEXTURED LINING FABRIC)</h5>
                          <p>
                            <span class="stockSku"><label>SKU: </label>Number</span>
                            <span class="rateStock"><label>Rate:</label> </span>$2000/-
                          </p>
                        </div>

                      </div>
                    </div>
                  </div>
                  <div class="col-md-6 pl-0">
                    <div class="rightContent">
                      <h4>Selected Stocks <span class="selectdStockNumber">(4)</span></h4>
                      <hr>
                      <div class="wrapSelectedStocks">
                        <div class="singleSelectdStock clearfix">
                          <div class="pull-left">
                            <div class="stockName">
                              <p>Sales (100 POLYSTER NON TEX…)</p>
                            </div>

                          </div>
                          <div class="pull-right">
                            <div class="input-group">
                                                        <span class="input-group-btn">
                                <button type="button" class="btn btn-default btn-number" data-type="minus"
                                        data-field="quant[1]">
                                    <span class="fa fa-minus"></span>
                                                        </button>
                                                        </span>
                              <input type="text" name="quant[1]" class="form-control input-number" value="1" min="1"
                                     max="10">
                              <span class="input-group-btn">
                                <button type="button" class="btn btn-default btn-number" data-type="plus"
                                        data-field="quant[1]">
                                    <span class="fa fa-plus"></span>
                                                        </button>
                                                        </span>
                            </div>
                          </div>
                        </div>
                        <div class="singleSelectdStock clearfix">
                          <div class="pull-left">
                            <div class="stockName">
                              <p>Sales (100 POLYSTER TEX…)</p>
                            </div>

                          </div>
                          <div class="pull-right">
                            <div class="input-group">
                                                        <span class="input-group-btn">
                                <button type="button" class="btn btn-default btn-number" data-type="minus"
                                        data-field="quant[1]">
                                    <span class="fa fa-minus"></span>
                                                        </button>
                                                        </span>
                              <input type="text" name="quant[1]" class="form-control input-number" value="1" min="1"
                                     max="10">
                              <span class="input-group-btn">
                                <button type="button" class="btn btn-default btn-number" data-type="plus"
                                        data-field="quant[1]">
                                    <span class="fa fa-plus"></span>
                                                        </button>
                                                        </span>
                            </div>
                          </div>
                        </div>
                        <div class="singleSelectdStock clearfix">
                          <div class="pull-left">
                            <div class="stockName">
                              <p>Sales (text)</p>
                            </div>

                          </div>
                          <div class="pull-right">
                            <div class="input-group">
                                                        <span class="input-group-btn">
                                <button type="button" class="btn btn-default btn-number" data-type="minus"
                                        data-field="quant[1]">
                                    <span class="fa fa-minus"></span>
                                                        </button>
                                                        </span>
                              <input type="text" name="quant[1]" class="form-control input-number" value="1" min="1"
                                     max="10">
                              <span class="input-group-btn">
                                <button type="button" class="btn btn-default btn-number" data-type="plus"
                                        data-field="quant[1]">
                                    <span class="fa fa-plus"></span>
                                                        </button>
                                                        </span>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="temapletFooter">
                        <hr>
                        <div class="btn-group bulkItemBtnGroup">
                          <button class="btn btn-sm btn-success" type="button"
                                  (click)="hsnDropdownShow=!hsnDropdownShow">
                            Save
                          </button>
                          <button class="btn btn-sm btn-primary" (click)="modalRef.hide()" type="button"
                                  (click)="hsnDropdownShow=!hsnDropdownShow">Cancel
                          </button>
                        </div>
                      </div>

                    </div>
                  </div>
                </div>
              </div>
            </div>
          </ng-template>
          <!-- endregion -->

          </section>

          <section class="clearfix mrB2 whiteBg container-fluid">
          </section>


          </ng-container>
        </div>
      </div>
      <div class="col-md-3"></div>
    </div>


    <div class="clearfix wrapperCustomerTable  pdT2">
      <table class="table customerInvoiceTable"
             [ngClass]="{' firstTable' : !invFormData.voucherDetails.customerName }" style="display: none;">
        <tr [hidden]="isPurchaseInvoice">
          <td width="150px">
            <label>Customer Name </label>
          </td>
          <td width="65%">
            <div class="clearfix">

              <ng-container *ngIf="!isCashInvoice">
                <sales-sh-select style="width:48.5%; float: left;" name="voucherDetails.customerName"
                                 [options]="customerAcList$ | async"
                                 [(ngModel)]="invFormData.voucherDetails.customerName"
                                 [customFilter]="customMoveGroupFilter"
                                 (noOptionsFound)="noResultsForCustomer($event)"
                                 (selected)="onSelectCustomer($event)" [placeholder]="'Select Customer'"
                                 [notFoundLink]="true" [doNotReset]="true" [forceClearReactive]="forceClear$ | async"
                                 [isFilterEnabled]="true" (noResultsClicked)="toggleAccountAsidePane($event)"
                                 [multiple]="false" [ItemHeight]="67" [notFoundLinkText]="'Add Customer'"
                                 (keyup)="resetCustomerName($event)" (onClear)="resetCustomerName(null)"
                                 [showClear]="!isUpdateMode" [disabled]="isUpdateMode">
                  <ng-template #optionTemplate let-option="option">
                    <a href="javascript:void(0)" class="list-item" style="border-bottom: 1px solid #ccc;">
                      <div class="item">{{ option.label }}</div>
                      <div class="item_unq">{{ option.value }}</div>
                    </a>
                  </ng-template>
                  <ng-template #notFoundLinkTemplate>
                    <a href="javascript:void(0)" class="list-item" [keyboardShortcut]="'alt+c'"
                       (onShortcutPress)="toggleAccountAsidePane()"
                       style="width:100%; display: flex;justify-content: space-between;">
                      <div class="item">Add Customer</div>
                      <div class="item">Alt+C</div>
                    </a>
                  </ng-template>
                </sales-sh-select>
              </ng-container>

              <ng-container *ngIf="isCashInvoice">
                <input type="text" #cashInvoiceInput name="voucherDetails.customerName"
                       class="form-control cashInvoiceInput" [(ngModel)]="invFormData.voucherDetails.customerName"
                       [readOnly]="isUpdateMode">
              </ng-container>
              <!-- <a class="copyInvoice" *ngIf="invFormData.voucherDetails.customerName"> <img src="../../assets/images/copy-icon.svg">Copy Previous Invoice</a> -->
            </div>
            <!-- <div class="other-options">
  <a href="#">Unregistered Business</a> | <a href="#">Customer Details</a>
</div> -->
            <!-- flex row child start -->

            <div class="flex-row-child add-entryAgainst mrL2" *ngIf="!isCustomerSelected">
              <!--*ngIf="typeaheadNoResultsOfCustomer"-->
              <div class="form-group noMarg">
                <label>Add Entry Against</label>
                <sh-select name="accountDetails.uniqueName" [options]="bankAccounts$ | async"
                           [(ngModel)]="invFormData.accountDetails.uniqueName" (selected)="onSelectBankCash($event)"
                           [placeholder]="'Cash Account'" [notFoundLink]="false"
                           [forceClearReactive]="forceClear$ | async"
                           [multiple]="false" [ItemHeight]="33" [useInBuiltFilterForIOptionTypeItems]="true">
                  <ng-template #optionTemplate1 let-option="option">
                    <a href="javascript:void(0)" class="list-item" style="border-bottom: 1px solid #ccc;">
                      <div class="item">{{ option.label }}</div>
                      <div class="item_unq">{{ option.value }}</div>
                    </a>
                  </ng-template>
                </sh-select>
              </div>
            </div>
            <!-- flex row child end -->
          </td>
          <td>
            <div class=" text-right" *ngIf="invFormData.voucherDetails.customerName">
              <p *ngIf="toggleFieldForSales" class="fs20 b">
                <span class="balance-due">Balance Due: </span>
                <span class="sp-rupees">Rs {{invFormData.voucherDetails.balanceDue | number:'1.2-2'}}</span>
              </p>
            </div>
          </td>
        </tr>
        <tr [hidden]="!isPurchaseInvoice">
          <td width="150px">
            <label>Vendor Name</label>
          </td>
          <td width="65%">
            <div class="flex-row-child">
              <div class="form-group noMarg">

                <!-- [useInBuiltFilterForIOptionTypeItems]="true" -->
                <!--  -->
                <sales-sh-select style="width:48.5%;" name="voucherDetails.customerName"
                                 [options]="customerAcList$ | async"
                                 [(ngModel)]="invFormData.voucherDetails.tempCustomerName"
                                 [customFilter]="customMoveGroupFilter"
                                 (noOptionsFound)="noResultsForCustomer($event)"
                                 (selected)="onSelectCustomer($event)" [placeholder]="'Select Vendor'"
                                 [notFoundLink]="true" [doNotReset]="true" [forceClearReactive]="forceClear$ | async"
                                 [isFilterEnabled]="true" (noResultsClicked)="toggleAccountAsidePane($event)"
                                 [multiple]="false" [ItemHeight]="67" [notFoundLinkText]="'Add Vendor'"
                                 (keyup)="resetCustomerName($event)" (onClear)="resetCustomerName(null)"
                                 [showClear]="!isUpdateMode">
                  <ng-template #optionTemplate let-option="option">
                    <a href="javascript:void(0)" class="list-item" style="border-bottom: 1px solid #ccc;">
                      <div class="item">{{ option.label }}</div>
                      <div class="item_unq">{{ option.value }}</div>
                    </a>
                  </ng-template>
                </sales-sh-select>
              </div>
            </div>
          </td>

        </tr>
        <tr>
          <td></td>
          <td>
            <ng-container>
              <section class="form-inline  ">
                <div class=" wrap-billing-address clearfix">
                  <div class="row">
                    <div class="col-xs-6">
                      <div class="form-group">
                        <label>Billing Address</label>
                        <div class="billing-address clearfix">
                            <textarea name="billingDetails.address" (keyup)="autoFillShippingDetails()"
                                      class="form-control"
                                      [(ngModel)]="invFormData.accountDetails.billingDetails.address[0]" rows="3"
                                      autocomplete="off" autofocus="off" aria-autocomplete="none"></textarea>
                          <div class="">
                            <div class="col-sm-6 pd">
                              <!-- <label>Country</label> -->

                              <label class="salesCountryLabel">
                                {{ customerCountryName }}
                              </label>

                            </div>
                            <div class="col-sm-6 pd">
                              <!-- <label>State</label> -->
                              <!-- remove disabled after api changes -->
                              <sales-sh-select [disabled]="isUpdateMode" [placeholder]="'State'"
                                               class="select-bdr-bottom" (selected)="autoFillShippingDetails()"
                                               #statesBilling [showBottomBorderOnly]="true"
                                               [options]="statesSource$ | async" name="billingDetails.stateCode"
                                               [(ngModel)]="invFormData.accountDetails.billingDetails.stateCode"></sales-sh-select>
                              <!-- <ng-select (selected)="autoFillShippingDetails()" #statesBilling class="splSales" name="billingDetails.stateCode" [options]="statesSource$ | async"
[(ngModel)]="invFormData.accountDetails.billingDetails.stateCode"></ng-select> -->
                            </div>
                            <div class="col-sm-12 pd">
                              <!-- <label>GSTIN</label> -->
                              <!-- remove disabled after api changes -->
                              <input [disabled]="isUpdateMode" maxLength="15" type="text"
                                     name="billingDetails.gstNumber" class="form-control input-custom"
                                     [(ngModel)]="invFormData.accountDetails.billingDetails.gstNumber"
                                     (keyup)="getStateCode('billingDetails', statesBilling); autoFillShippingDetails()"
                                     placeholder="GSTIN"/>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="col-xs-6">
                      <div class="form-group p0 width100">
                        <label>
                          <input type="checkbox" (change)="autoFillShippingDetails()" name="autoFillShipping"
                                 [attr.checked]="true"
                                 [(ngModel)]="autoFillShipping"> Shipping Address Same as Billing Address</label>
                        <div class="billing-address" [ngClass]="{'disabled': autoFillShipping}">
                            <textarea [readonly]="autoFillShipping" name="shippingDetails.address" class="form-control"
                                      [(ngModel)]="invFormData.accountDetails.shippingDetails.address[0]" rows="3"
                                      autocomplete="off"></textarea>
                          <div class="clearfix">
                            <div class="form-group">
                              <div class="col-sm-6 pd">
                                <div class="form-group">

                                  <label class="salesCountryLabel">
                                    {{ customerCountryName }}
                                  </label>
                                </div>
                              </div>
                              <div class="col-sm-6 pd">
                                <!-- <label>State</label> -->
                                <!-- <ng-select [disabled]="autoFillShipping" #statesShipping class="splSales" name="shippingDetails.stateCode" [options]="statesSource$ | async" [(ngModel)]="invFormData.accountDetails.shippingDetails.stateCode"></ng-select> -->
                                <!-- (selected)="autoFillShippingDetails()" -->

                                <!-- use this after api changes [disabled]="autoFillShipping"  -->
                                <sales-sh-select [disabled]="isUpdateMode" [placeholder]="'State'"
                                                 class="select-bdr-bottom" #statesShipping
                                                 [showBottomBorderOnly]="true" [options]="statesSource$ | async"
                                                 name="shippingDetails.stateCode"
                                                 [(ngModel)]="invFormData.accountDetails.shippingDetails.stateCode"></sales-sh-select>
                              </div>
                              <div class="col-sm-12 pd">
                                <!-- <label>GSTIN</label> -->
                                <!-- remove disabled after api changes and add [readonly]="autoFillShipping" -->
                                <input [disabled]="isUpdateMode" maxLength="15" type="text"
                                       name="shippingDetails.gstNumber" class="form-control input-custom"
                                       [(ngModel)]="invFormData.accountDetails.shippingDetails.gstNumber"
                                       (keyup)="getStateCode('shippingDetails', statesShipping)"
                                       placeholder="GSTIN"/>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>


                </div>

              </section>
            </ng-container>
          </td>
          <td></td>
        </tr>

      </table>

      <table class="innerTable table customerInvoiceTable bg-white" style="display: none;">

        <tr>
          <td>
            <label>Attention to</label>
          </td>
          <td>
            <div class="form-group pl0 m-r-15 col-xs-6">
              <!--col-xs-3 -->

              <input type="text" name="accountDetails.attention" placeholder="Attention to"
                     class="form-control attentionTo" [(ngModel)]="invFormData.accountDetails.attentionTo"/>
            </div>
          </td>
          <td></td>
        </tr>

        <tr>
          <td width="150px">
            <label>Email Id</label>
          </td>
          <td width="65%">
            <div class="col-xs-6 pl-0">
              <input type="email" placeholder="someone@example.com" name="accountDetails.email"
                     class="form-control attentionTo" [(ngModel)]="invFormData.accountDetails.email"/>
            </div>

          </td>
          <td></td>
        </tr>

        <tr>
          <td>
            <label>Mobile Number</label>
          </td>
          <td>
            <div class="col-xs-6 pl-0">
              <input digitsOnlyDirective placeholder="9198XXXXXXXX" type="text" name="accountDetails.mobileNumber"
                     class="form-control attentionTo" [(ngModel)]="invFormData.accountDetails.mobileNumber"/>
            </div>

          </td>
          <td></td>
        </tr>

        <tr>
          <td>
            <label> {{ !isPurchaseInvoice ? 'Invoice No.' : 'Purchase Invoice No.' }}</label>
          </td>
          <td style="position:relative">
            <div class="col-xs-6 pl-0">
              <input type="text" name="accountDetails.invoiceNum" class="form-control invoiceDate attentionTo"
                     [ngClass]="{'dateinvoice': !isPurchaseInvoice }"
                     [disabled]="isUpdateMode  || !useCustomInvoiceNumber"
                     [(ngModel)]="invFormData.voucherDetails.voucherNumber"
              />
            </div>
            <div class="col-xs-6 invoiceDateDueDate">
              <div class="form-inline ">
                <div class="form-group m-r-15">
                  <!--col-xs-2-->
                  <label>Invoice Date</label>

                  <input type="text" [placeholder]="giddhDateFormat" #voucherDate="ngModel" name="voucherDate"
                         class="form-control dateinvoice" bsDatepicker
                         [bsConfig]="{ dateInputFormat: giddhDateFormat }"
                         [(ngModel)]="invFormData.voucherDetails.voucherDate" [disabled]="isUpdateMode"
                         [class.invalid-inp]="voucherDate.errors && (voucherDate.dirty || voucherDate.touched)"/>
                  <p class="text-danger" *ngIf="voucherDate.errors && (voucherDate.dirty || voucherDate.touched)">
                    Invalid Date
                  </p>


                </div>
                <div class="form-group m-l-10 m-r-15" *ngIf="isSalesInvoice || isPurchaseInvoice">
                  <label> {{isPurchaseInvoice ? 'Bill Due Date' : 'Due Date'}}</label>

                  <input type="text" [placeholder]="giddhDateFormat" #dueDate="ngModel" name="dueDate"
                         class="form-control dateinvoice" bsDatepicker
                         [bsConfig]="{ dateInputFormat: giddhDateFormat }"
                         [(ngModel)]="invFormData.voucherDetails.dueDate"
                         [class.invalid-inp]="dueDate.errors && (dueDate.dirty || dueDate.touched)"
                  />
                  <p class="text-danger" *ngIf="dueDate.errors && (dueDate.dirty || dueDate.touched)">Invalid Date</p>

                </div>
              </div>
            </div>


          </td>

        </tr>

      </table>

    </div>

</div>


<!-- region submit actions-->
<section class="clearfix">

  <section id="actionPane" class="text-center">

    <div class="col-xs-12">

      <div class="pull-right pr" *ngIf="!isUpdateMode">
        <button type="button" (click)="resetInvoiceForm(invoiceForm)"
                class="btn btn-danger d-inline-block v-align-middle">Clear
        </button>

        <span class="d-inline-block v-align-middle" *ngIf="isPurchaseInvoice">
                <button type="button" (click)="triggerSubmitInvoiceForm(invoiceForm, true)"
                        class="btn btn-default" *ngIf="isCustomerSelected">Save &amp; Update A/c
                </button>
                <button type="button" (click)="doAction(3);triggerSubmitInvoiceForm(invoiceForm, false)"
                        class="btn btn-default">Save
                </button>
            </span>

        <span class="d-inline-block v-align-middle" *ngIf="!isPurchaseInvoice">

              <button type="button" (click)="triggerSubmitInvoiceForm(invoiceForm, true)"
                      class="btn btn-default" *ngIf="isCustomerSelected"
                      [disabled]="invoiceForm.invalid">Generate {{selectedPageLabel}}
                &amp; Update A/c
              </button>

              <div class="btn-group" dropdown [dropup]="true">

                  <button type="button" (click)="doAction(3);triggerSubmitInvoiceForm(invoiceForm, false)"
                          class="btn btn-default"
                          [disabled]="invoiceForm.invalid">Generate {{selectedPageLabel}}
                  </button>

                  <button id="button-split" type="button" dropdownToggle
                          class="btn btn-default dropdown-toggle dropdown-toggle-split"
                          aria-controls="dropdown-split" *ngIf="selectedPage === 'Sales'"
                          [disabled]="invoiceForm.invalid">
                    <span class="caret"></span>
                            <span class="sr-only">Split button!</span>
                            </button>

                            <ul id="dropdown-basic" *dropdownMenu class="dropdown-menu dropdown-menu-right" role="menu"
                                aria-labelledby="button-basic">
                                <li role="menuitem">
                                    <a class="dropdown-item cp"
                                       (click)="doAction(1);triggerSubmitInvoiceForm(invoiceForm, false)">Generate & Close</a>
                                </li>
                                <li role="menuitem" (click)="doAction(2);triggerSubmitInvoiceForm(invoiceForm, false)">
                                    <a class="dropdown-item cp">Generate & Recurring</a>
                                </li>
                            </ul>
                        </div>
                        </span>

      </div>

      <div class="pull-right pr" *ngIf="isUpdateMode">

        <button type="button" class="btn btn-danger d-inline-block v-align-middle" (click)="cancelUpdate()">Cancel
        </button>

        <button type="button" class="btn btn-default" (click)="submitUpdateForm(invoiceForm)"
                [disabled]="invoiceForm.invalid">
          <span>Update {{selectedPageLabel}}</span>
        </button>
      </div>
    </div>
  </section>
</section>
<!-- endregion -->

</form>
</div>

<!--<app-fixed-footer></app-fixed-footer>-->

<!-- open account aside -->
<div class="aside-overlay"
     *ngIf="accountAsideMenuState === 'in' || asideMenuStateForProductService === 'in'
     || asideMenuStateForRecurringEntry === 'in' || asideMenuStateForOtherTaxes === 'in'"></div>

<aside-menu-account *ngIf="accountAsideMenuState === 'in'" [class]="accountAsideMenuState"
                    [@slideInOut]="accountAsideMenuState" (closeAsideEvent)="toggleAccountAsidePane($event)"
                    [isPurchaseInvoice]="isPurchaseInvoice" [keyboardShortcut]="{'esc':accountAsideMenuState ==='in'}"
                    (onShortcutPress)="toggleAccountAsidePane()"></aside-menu-account>

<!-- open product service aside -->
<aside-menu-product-service [class]="asideMenuStateForProductService" [@slideInOut]="asideMenuStateForProductService"
                            (closeAsideEvent)="onNoResultsClicked()"
                            (animatePAside)="getActionFromAside($event)"></aside-menu-product-service>

<app-aside-recurring-entry [voucherType]="selectedPage" [voucherNumber]="voucherNumber"
                           [class]="asideMenuStateForRecurringEntry" [@slideInOut]="asideMenuStateForRecurringEntry"
                           (closeAsideEvent)="toggleRecurringAsidePane('out')"></app-aside-recurring-entry>


<!--<ng-template #otherTaxSidePane let-entry>-->
<app-aside-menu-sales-other-taxes
  *ngIf="asideMenuStateForOtherTaxes === 'in' && selectedEntry"
  [class]="asideMenuStateForOtherTaxes"
  [allowedTaxTypes]="tdsTcsTaxTypes"
  [otherTaxesModal]="selectedEntry.otherTaxModal"
  [@slideInOut]="asideMenuStateForOtherTaxes"
  (closeModal)="toggleOtherTaxesAsidePane(true, null ,true)"
  (applyTaxes)="calculateOtherTaxes($event);toggleOtherTaxesAsidePane(true, null, true);calculateAffectedThingsFromOtherTaxChanges()"
>
</app-aside-menu-sales-other-taxes>
<!--</ng-template>-->

<!-- create Group modal -->
<section *ngIf="showCreateGroupModal">
  <div bsModal #createGroupModal="bs-modal" class="modal fade" role="dialog" [keyboardShortcut]="'esc'"
       (onShortcutPress)="closeCreateGroupModal()" [config]="modalConfig">
    <div class="modal-dialog modal-md">
      <div class="modal-content">
        <sales-add-group-modal (actionFired)="closeCreateGroupModal($event)"></sales-add-group-modal>
      </div>
    </div>
  </div>
</section>

<!-- create Ac modal -->
<section *ngIf="showCreateAcModal">
  <div bsModal #createAcModal="bs-modal" class="modal fade" role="dialog" [config]="modalConfig">
    <div class="modal-dialog modal-md">
      <div class="modal-content">
        <create-account-modal [gType]="createAcCategory" (actionFired)="closeCreateAcModal()"></create-account-modal>
      </div>
    </div>
  </div>
</section>

<!-- modal start -->
<ng-template #template>
  <div class="modal-header">
    <h4 class="modal-title pull-left">Change Template</h4>
    <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <perfect-scrollbar style="max-height: 740px !important; min-height: 740px;" [scrollIndicators]="true">
      <form #CreateInvoice="ngForm">

        <div class="row">
          <div class="col-md-6">
            <div class="change-template">
              <img src="assets/images/a.png" class="img-responsive" alt="">
              <div class="modal-invoice-footer">
                <ul class="list-inline">
                  <li>Template A</li>
                  <li><input type="radio" id="radio-1" name="creatInvoice">
                    <label for="radio-1" class="btn"><i class="glyphicon glyphicon-star"></i> Template Default</label>
                  </li>
                </ul>
              </div>
            </div>
          </div>

          <div class="col-md-6">
            <div class="change-template">
              <img src="assets/images/b.png" class="img-responsive" alt="">
              <div class="modal-invoice-footer">
                <ul class="list-inline">
                  <li>Template B</li>
                  <li><input type="radio" id="radio-2" name="creatInvoice">
                    <label for="radio-2" class="btn"><i class="glyphicon glyphicon-star"></i> Template Default</label>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-6">
            <div class="change-template">
              <img src="assets/images/c.png" class="img-responsive" alt="">
              <div class="modal-invoice-footer">
                <ul class="list-inline">
                  <li>Template C</li>
                  <li><input type="radio" id="radio-3" name="creatInvoice">
                    <label for="radio-3" class="btn"><i class="glyphicon glyphicon-star"></i> Template Default</label>
                  </li>
                </ul>
              </div>
            </div>
          </div>

          <div class="col-md-6">
            <div class="change-template">
              <img src="assets/images/d.png" class="img-responsive" alt="">
              <div class="modal-invoice-footer">
                <ul class="list-inline">
                  <li>Template D</li>
                  <li><input type="radio" id="radio-4" name="creatInvoice">
                    <label for="radio-4" class="btn"><i class="glyphicon glyphicon-star"></i> Template Default</label>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </form>

    </perfect-scrollbar>

  </div>
</ng-template>
