<ng-container appTranslate [file]="'vouchers'" (localeData)="localeData = $event"
    (commonLocaleData)="commonLocaleData = $event" (translationComplete)="translationComplete($event)">
    <hamburger-menu></hamburger-menu>
    <div class="vouchers">
        <mat-card class="container-lg">
            <mat-card-content>

                <!-- Voucher Page Heading -->
                <div class="vouchers-title d-flex align-items-center">
                    <h1>{{ voucherType | voucherName: localeData | titlecase }}</h1>
                    <div class="ml-auto" *ngIf="invoiceType.isSalesInvoice || invoiceType.isCashInvoice">
                        <watch-video [cssClass]="'text-blue'"
                            [moduleName]="invoiceType.isSalesInvoice ? 'VOUCHER_SALES' : 'VOUCHER_CASH'"></watch-video>
                    </div>
                </div>

                <div class="vouchers-content-wrapper">
                    <form autocomplete="off" novalidate name="invoiceForm" [formGroup]="invoiceForm">
                        <!-- Voucher Form Top Section -->
                        <div class="vouchers-primary-form" formGroupName="account">
                            <div class="row">
                                <div class="col-10">
                                    <div class="d-flex align-items-center">
                                        <div class="vouchers-form-fields w-100" [keyboardShortcut]="'alt+c'"
                                            (onShortcutPress)="toggleAccountAsidePane()">
                                            <reactive-dropdown-field *ngIf="!invoiceType.isCashInvoice"
                                                [label]="invoiceType.isPurchaseOrder || invoiceType.isDebitNote ? localeData?.vendor_name : localeData?.customer_name"
                                                [placeholder]="invoiceType.isPurchaseOrder || invoiceType.isDebitNote ? localeData?.select_vendor : localeData?.select_customer"
                                                formControlName="uniqueName" [name]="'account'"
                                                [options]="voucherAccountResults$ | async" [showCreateNew]="true"
                                                [enableDynamicSearch]="true" [isPaginationEnabled]="true"
                                                [openDropdown]="openAccountDropdown"
                                                [createNewText]="!invoiceType.isPurchaseOrder && !invoiceType.isDebitNote ? localeData?.add_customer : localeData?.add_vendor"
                                                [labelValue]="invoiceForm.controls['account'].get('customerName')?.value"
                                                [showKeyboardCommand]="commonLocaleData?.app_alt_c"
                                                (scrollEnd)="handleSearchAccountScrollEnd()"
                                                (selectedOption)="selectAccount($event)"
                                                (dynamicSearchedQuery)="searchAccount($event, 1)"
                                                (onClear)="selectAccount($event, true)"
                                                (createOption)="toggleAccountAsidePane()">
                                            </reactive-dropdown-field>
                                            <input-field *ngIf="invoiceType.isCashInvoice" [name]="'account'"
                                                [label]="localeData?.customer_name"
                                                [placeholder]="localeData?.enter_customer_name" [type]="'text'"
                                                [autoFocus]="true" formControlName="customerName"></input-field>
                                        </div>
                                        <ng-container
                                            *ngIf="!invoiceType.isCashInvoice && !invoiceType.isPurchaseOrder && invoiceForm.controls['account'].get('uniqueName')?.value">
                                            <div class="vouchers-copy-sales mr-l3 cursor-pointer"
                                                (click)="getPreviousVouchers()" [matMenuTriggerFor]="copyLastVouchers">
                                                <i class="icon-copy-file"></i>
                                                {{ voucherType | voucherCopyLink: localeData | titlecase }}
                                            </div>
                                            <mat-menu #copyLastVouchers="matMenu">
                                                <div class="mat-menu-width-large">
                                                    <ng-container *ngIf="getLastVouchersInProgress$ | async">
                                                        <mat-spinner [diameter]="30"></mat-spinner>
                                                    </ng-container>
                                                    <ng-container *ngIf="(lastVouchersList$ | async)?.length">
                                                        <button
                                                        mat-menu-item
                                                        *ngFor="let voucher of lastVouchersList$ | async"
                                                        (click)="copyInvoice(voucher)"
                                                        class="line-height-initial"
                                                    >
                                                        <div class="pd">
                                                            <div class="d-flex flex-column">
                                                                <div class="d-flex justify-content-between">
                                                                    <span>{{ voucher?.voucherNumber }}</span>
                                                                    <span>{{
                                                                        voucher?.grandTotal?.amountForAccount
                                                                    }}</span>
                                                                </div>
                                                                <span
                                                                    >{{ voucher?.date }} (
                                                                    {{ voucher?.account?.name }} )</span
                                                                >
                                                            </div>
                                                        </div>
                                                    </button>
                                                    </ng-container>
                                                    <ng-container
                                                        *ngIf="!(lastVouchersList$ | async)?.length && !getLastVouchersInProgress$ | async">
                                                        {{ commonLocaleData?.app_no_result_found }}
                                                    </ng-container>
                                                </div>
                                            </mat-menu>
                                        </ng-container>
                                    </div>
                                </div>
                                <div class="col-2 text-right">
                                    <span class="balance-due-label">Balance Due</span>
                                    <h2>0.00</h2>
                                </div>
                                <div class="col-12">
                                    <span
                                        *ngIf="!invoiceType.isCashInvoice && invoiceForm.controls['account'].get('uniqueName')?.value"
                                        class="vouchers-form-fields-detail cursor-pointer"
                                        (click)="toggleAccountAsidePane()">
                                        {{ !invoiceType.isPurchaseOrder ? localeData?.customer_details :
                                        localeData?.vendor_details }}</span>

                                    <ng-container *ngIf="invoiceType.isSalesInvoice && !invoiceType.isCashInvoice">
                                        <img src="{{ imgPath }}new/search_customer.svg" height="70" class="mb-3"
                                            *ngIf="!invoiceForm.controls['account'].get('customerName')?.value" />
                                    </ng-container>
                                    <ng-container *ngIf="invoiceType.isPurchaseInvoice">
                                        <img src="{{ imgPath }}new/search-vendor.svg" height="70" class="mb-3"
                                            *ngIf="!invoiceForm.controls['account'].get('customerName')?.value" />
                                    </ng-container>
                                    <ng-container *ngIf="invoiceType.isCashInvoice">
                                        <img src="{{ imgPath }}new/search-customer-cash-invoice.svg" height="70"
                                            class="mb-3"
                                            *ngIf="!invoiceForm.controls['account'].get('customerName')?.value" />
                                    </ng-container>
                                </div>
                            </div>
                        </div>

                        <!-- Voucher Form Main Section -->
                        <div class="vouchers-secondary-form position-relative"
                            [ngClass]="{'vouchers-form-disable' : !invoiceForm.controls['account'].get('customerName')?.value }">
                            <div class="vouchers-small-container">
                                <div class="row">
                                    <ng-container formGroupName="account">
                                        <!-- Billing Address -->
                                        <div class="col-12 mr-t15" *ngIf="invoiceType.isPurchaseOrder">
                                            <span class="billing-deliver-label">Deliver From</span>
                                        </div>
                                        <div class="col-6" formGroupName="billingAddress">
                                            <label for="billingAddress" class="billing-label"
                                                [ngClass]="{ 'p-0' : invoiceType.isCashInvoice }">Billing
                                                Address</label> <i *ngIf="!invoiceType.isCashInvoice"
                                                [matMenuTriggerFor]="billingAddress"
                                                class="icon-edit text-blue cursor-pointer pl-2 font-12"></i>

                                            <div *ngIf="!invoiceType.isCashInvoice" class="mt-2">Address {{
                                                invoiceForm.controls['account'].get("billingAddress").get("index")?.value
                                                + 1 }}
                                            </div>
                                            <mat-menu #billingAddress="matMenu">
                                                <div class="mat-menu-width-large vouchers-address-menu">
                                                    <ng-container *ngFor="let address of account?.addresses; let i = index">
                                                        <button mat-menu-item
                                                            (click)="fillBillingShippingAddress('account', 'billingAddress', address, i)">
                                                            <div class="d-flex justify-content-between align-items-center">
                                                                <full-address [address]="address" [localeData]="localeData" [commonLocaleData]="commonLocaleData" [addressNo]="i + 1" [company]="company"></full-address>
                                                                <i class="icon-tick"
                                                                    *ngIf="invoiceForm.controls['account'].get('billingAddress').get('index')?.value === i"></i>
                                                            </div>
                                                        </button>
                                                        <mat-divider></mat-divider>
                                                    </ng-container>
                                                    <button mat-menu-item class="vouchers-add-new"
                                                        (click)="toggleAccountAsidePane()">+ Add new address</button>
                                                </div>
                                            </mat-menu>
                                            <div class="vouchers-address-form" *ngIf="invoiceType.isCashInvoice">
                                                <div class="address-field">
                                                    <textarea rows="2" matInput class="w-100" name="billingAddress"
                                                        formControlName="address"></textarea>
                                                </div>
                                                <div class="country-field">
                                                    <span>{{ invoiceType?.isCashInvoice ? company?.countryName :
                                                        account?.countryName }}</span>
                                                </div>
                                                <div class="state-field" formGroupName="state">
                                                    <reactive-dropdown-field [cssClass]="'border-0'"
                                                        formControlName="code" [name]="'billingStateCode'"
                                                        [label]="'State'" [placeholder]="'Select'"
                                                        [options]="accountStateList$ | async"
                                                        [labelValue]="invoiceForm.controls['account'].get('billingAddress').get('state').get('name')?.value"
                                                        [appearance]="'fill'" [showLabel]="false"
                                                        (selectedOption)="selectState('billingAddress', $event)"></reactive-dropdown-field>
                                                </div>
                                                <div class="gstin-field">
                                                    <text-field [type]="'text'" [name]="'billingTaxNumber'"
                                                        [placeholder]="'GSTIN'" [cssClass]="'border-0'"
                                                        formControlName="taxNumber"></text-field>
                                                </div>
                                                <div class="pin-code-field">
                                                    <text-field [type]="'text'" [name]="'billingPinCode'"
                                                        [placeholder]="'PIN Code'" [cssClass]="'border-0'"
                                                        formControlName="pincode"></text-field>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Shipping Address -->
                                        <div class="col-6" formGroupName="shippingAddress">
                                            <mat-checkbox type="checkbox" color="primary"
                                                *ngIf="invoiceType.isCashInvoice"
                                                (change)="copyBillingInShipping($event)">
                                                Shipping Address Same as Billing Address
                                            </mat-checkbox>
                                            <ng-container *ngIf="!invoiceType.isCashInvoice">
                                                <label for="billingAddress" class="billing-label">Shipping
                                                    Address</label> <i *ngIf="!invoiceType.isCashInvoice"
                                                    [matMenuTriggerFor]="shippingAddress"
                                                    class="icon-edit text-blue cursor-pointer pl-2 font-12"></i>

                                                <mat-menu #shippingAddress="matMenu">
                                                    <div class="mat-menu-width-large vouchers-address-menu">
                                                        <ng-container *ngFor="let address of account?.addresses; let i = index">
                                                            <button mat-menu-item
                                                                (click)="fillBillingShippingAddress('account','shippingAddress', address, i)">
                                                                <div
                                                                    class="d-flex justify-content-between align-items-center">
                                                                    <full-address [address]="address" [localeData]="localeData" [commonLocaleData]="commonLocaleData" [addressNo]="i + 1" [company]="company"></full-address>
                                                                    <i class="icon-tick"
                                                                        *ngIf="invoiceForm.controls['account'].get('shippingAddress').get('index')?.value === i"></i>
                                                                </div>
                                                            </button>
                                                            <mat-divider></mat-divider>
                                                        </ng-container>
                                                        <button mat-menu-item class="vouchers-add-new"
                                                            (click)="toggleAccountAsidePane()">+ Add new
                                                            address</button>
                                                    </div>
                                                </mat-menu>
                                            </ng-container>

                                            <div *ngIf="!invoiceType.isCashInvoice" class="mt-2">Address {{
                                                invoiceForm.controls['account'].get("shippingAddress").get("index")?.value
                                                + 1
                                                }} </div>

                                            <div class="vouchers-address-form form-disabled"
                                                *ngIf="invoiceType.isCashInvoice">
                                                <div class="address-field">
                                                    <textarea rows="2" matInput class="w-100" name="shippingAddress"
                                                        formControlName="address"></textarea>
                                                </div>
                                                <div class="country-field">
                                                    <span>{{ invoiceType?.isCashInvoice ? company?.countryName :
                                                        account?.countryName }}</span>
                                                </div>
                                                <div class="state-field" formGroupName="state">
                                                    <reactive-dropdown-field [cssClass]="'border-0'"
                                                        formControlName="code" [name]="'shippingStateCode'"
                                                        [label]="'State'" [placeholder]="'Select'"
                                                        [options]="accountStateList$ | async"
                                                        [labelValue]="invoiceForm.controls['account'].get('shippingAddress').get('state').get('name')?.value"
                                                        [appearance]="'fill'" [showLabel]="false"
                                                        (selectedOption)="selectState('shippingAddress', $event)"></reactive-dropdown-field>
                                                </div>
                                                <div class="gstin-field">
                                                    <text-field [type]="'text'" [name]="'shippingTaxNumber'"
                                                        [placeholder]="'GSTIN'" [cssClass]="'border-0'"
                                                        formControlName="taxNumber"></text-field>
                                                </div>
                                                <div class="pin-code-field">
                                                    <text-field [type]="'text'" [name]="'shippingPinCode'"
                                                        [placeholder]="'PIN Code'" [cssClass]="'border-0'"
                                                        formControlName="pincode"></text-field>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Attention to -->
                                        <div class="col-6 mr-t15">
                                            <input-field [name]="'attentionTo'" [label]="'Attention to'"
                                                [placeholder]="'Enter name'" [type]="'text'"
                                                formControlName="attentionTo"></input-field>
                                        </div>

                                        <!-- Email Id -->
                                        <div class="col-6 mr-t15">
                                            <input-field [name]="'email'" [label]="'Email Id'"
                                                [placeholder]="'Enter email'" [type]="'text'"
                                                formControlName="email"></input-field>
                                        </div>

                                        <!-- Mobile Number -->
                                        <div class="col-6 mr-t15">
                                            <div id="init-contact-wrapper" class="position-relative w-100">
                                        
                                                <input
                                                    type="tel"
                                                    class="mat-form-field-border mat-form-field-height"
                                                    #initContact
                                                    aria-autocomplete="none"
                                                    autocomplete="off"
                                                    (keypress)="intlClass?.onlyPhoneNumber($event); validateMobileField()"
                                                    id="init-contact"
                                                    placeholder="Mobile Number"
                                                    formControlName="mobileNumber"
                                                    [ngClass]="{
                                                        'invalid-input':
                                                            (invoiceForm.controls['account'].get('mobileNumber')?.touched ||
                                                            invoiceForm.controls['account'].get('mobileNumber')?.touched) &&
                                                            !intlClass?.isRequiredValidNumber
                                                    }"
                                                />
                                                <mat-error
                                                    *ngIf="
                                                        (invoiceForm.controls['account'].get('mobileNumber')?.touched ||
                                                        invoiceForm.controls['account'].get('mobileNumber')?.touched) &&
                                                        !intlClass?.isRequiredValidNumber
                                                    "
                                                    >Please enter valid mobile number</mat-error
                                                >
                                            </div>
                                        </div>
                                    </ng-container>

                                    <!-- Warehouse -->
                                    <div class="col-6 mr-t15" *ngIf="showWarehouse" formGroupName="warehouse">
                                        <reactive-dropdown-field [cssClass]="'border-0'" [name]="'warehouse'"
                                            formControlName="uniqueName" [label]="'Warehouse'" [placeholder]="'Select'"
                                            [options]="warehouses"></reactive-dropdown-field>
                                    </div>
                                </div>

                                <!-- Row 2 for Deliver To Only show in Cash Invoice -->
                                <div class="row" *ngIf="invoiceType.isPurchaseOrder" formGroupName="account">
                                    <div class="col-12 mr-t15">
                                        <span class="billing-deliver-label">Deliver To</span>
                                    </div>

                                    <!-- Billing Address -->
                                    <div class="col-6">
                                        <label for="billingAddress" class="billing-label"
                                            [ngClass]="{ 'p-0' : invoiceType.isCashInvoice }">Billing Address</label> <i
                                            [matMenuTriggerFor]="companyBillingAddress"
                                            class="icon-edit text-blue cursor-pointer pl-2 font-12"></i>

                                        <mat-menu #companyBillingAddress="matMenu">
                                            <div class="mat-menu-width-large vouchers-address-menu">
                                                <ng-container *ngFor="let address of company?.addresses; let i = index">
                                                    <button mat-menu-item
                                                        (click)="fillBillingShippingAddress('company', 'billingAddress', address, i)">
                                                        <div class="d-flex justify-content-between align-items-center">
                                                            <full-address [address]="address" [localeData]="localeData" [commonLocaleData]="commonLocaleData" [addressNo]="i + 1" [company]="company"></full-address>
                                                            <i class="icon-tick"
                                                                *ngIf="invoiceForm.controls['company'].get('billingAddress').get('index')?.value === i"></i>
                                                        </div>
                                                    </button>
                                                    <mat-divider></mat-divider>
                                                </ng-container>
                                                <button mat-menu-item class="vouchers-add-new">+ Add new
                                                    address</button>
                                            </div>
                                        </mat-menu>
                                        <div class="mt-2">Address {{
                                            invoiceForm.controls['company'].get("billingAddress").get("index")?.value +
                                            1 }}
                                        </div>
                                    </div>

                                    <!-- Shipping Address -->
                                    <div class="col-6">
                                        <label for="billingAddress" class="billing-label">Shipping Address</label> <i
                                            [matMenuTriggerFor]="companyShippingAddress"
                                            class="icon-edit text-blue cursor-pointer pl-2 font-12"></i>

                                        <mat-menu #companyShippingAddress="matMenu">
                                            <div class="mat-menu-width-large  vouchers-address-menu">
                                                <ng-container *ngFor="let address of company?.addresses; let i = index">
                                                    <button mat-menu-item
                                                        (click)="fillBillingShippingAddress('company', 'shippingAddress', address, i)">
                                                        <div class="d-flex justify-content-between align-items-center">
                                                            <full-address [address]="address" [localeData]="localeData" [commonLocaleData]="commonLocaleData" [addressNo]="i + 1" [company]="company"></full-address>
                                                            <i class="icon-tick"
                                                                *ngIf="invoiceForm.controls['company'].get('shippingAddress').get('index')?.value === i"></i>
                                                        </div>
                                                    </button>
                                                    <mat-divider></mat-divider>
                                                </ng-container>
                                                <button mat-menu-item class="vouchers-add-new">+ Add new
                                                    address</button>
                                            </div>
                                        </mat-menu>
                                        <div class="mt-2">Address {{
                                            invoiceForm.controls['company'].get("shippingAddress").get("index")?.value +
                                            1 }}
                                        </div>
                                    </div>
                                </div>

                                <!-- Row 3 -->
                                <div class="row row-gap mr-t15 mr-b15"
                                    *ngIf="invoiceType.isPurchaseInvoice && (vendorPurchaseOrders$ | async)?.length">
                                    <!-- Purchase Order -->
                                    <div class="col-6">
                                        <select-multiple-fields [placeholder]="localeData?.select_order_placeholder"
                                            [appearance]="'outline'" [isPurchaseOrder]="true" [localeData]="localeData"
                                            [options]="vendorPurchaseOrders$ | async" [selectedValues]="null"
                                            [name]="'purchase-orders'"
                                            class="select-multiple-chiplist"></select-multiple-fields>
                                    </div>
                                </div>

                                <!-- Row 4 -->
                                <div class="row row-gap mr-t15">

                                    <!-- Voucher Number -->
                                    <div class="col-6">
                                        <input-field [name]="'vouchers-number'" [label]="'Voucher Number'"
                                            [placeholder]="'Enter voucher number'" [type]="'text'"
                                            formControlName="number">
                                        </input-field>
                                    </div>

                                    <!-- Voucher Date -->
                                    <div class="col-3 pr-2">
                                        <giddh-datepicker type="text" (keydown.enter)="$event.preventDefault()"
                                            [label]="'Invoice Date'" [placeholder]="'DDMMYYYY'" name="voucherDate"
                                            [showToggleIcon]="false" [appearance]="'outline'" formControlName="date">
                                        </giddh-datepicker>
                                    </div>

                                    <!-- Due Date -->
                                    <div class="col-3 pl-2"
                                    *ngIf="
                                    (currentVoucherFormDetails?.dueDate ||
                                    invoiceType.isSalesInvoice ||
                                    invoiceType.isPurchaseInvoice ||
                                    invoiceType.isPurchaseOrder ||
                                    invoiceType.isProformaInvoice ||
                                    invoiceType.isEstimateInvoice) &&
                                    !invoiceType.isCashInvoice
                                "
                                       >
                                        <giddh-datepicker type="text" (keydown.enter)="$event.preventDefault()"
                                            [label]="'Due Date'" [placeholder]="'DDMMYYYY'" name="voucherDueDate"
                                            [showToggleIcon]="false" [appearance]="'outline'" formControlName="dueDate">
                                        </giddh-datepicker>
                                    </div>

                                    <!-- Reverse Charge Checkbox -->
                                    <div class="col-6"
                                        *ngIf="invoiceType.isPurchaseInvoice || (currentVoucherFormDetails?.rcmAllowed && (company.countryName === 'India' || company.countryName === 'United Kingdom'))">
                                        <mat-checkbox (keydown.enter)="$event.preventDefault()" #rcmCheckbox
                                            id="reverse-charge" formControlName="isRcmEntry"
                                            (change)="changeRcmCheckboxState($event)" class="mr-r1" name="rcmEntry"
                                            [disabled]="isEinvoiceGenerated" color="primary">
                                        </mat-checkbox>
                                        <label for="reverse-charge" (click)="
                                                !isEinvoiceGenerated ? toggleRcmCheckbox(rcmCheckbox, 'label') : ''
                                            " [innerHTML]="localeData?.transaction_reverse_charge">
                                        </label>
                                    </div>
                                    <!-- For Tourist Scheme start -->
                                    <ng-container *ngIf="company?.countryCode === 'AE'">
                                        <div class="col-6"
                                            *ngIf="invoiceType.isSalesInvoice || invoiceType.isCashInvoice">
                                            <mat-checkbox color="primary" (keydown.enter)="$event.preventDefault()"
                                                id="tourist-scheme" name="touristSchemeApplicable" class="mr-r1"
                                                formControlName="touristSchemeApplicable"
                                                (change)="toggleTouristSchemeApplicable()"
                                                [disabled]="isEinvoiceGenerated">
                                                {{ localeData?.transaction_tourist_scheme }}
                                            </mat-checkbox>
                                        </div>
                                        <div class="col-6">
                                            <input-field [type]="'text'" [name]="'passportNumber'"
                                                [placeholder]="localeData?.passport_number" [cssClass]="'attention-to'"
                                                formControlName="passportNumber" (keypress)="allowAlphanumericChar()"
                                                (blur)="allowAlphanumericChar()"></input-field>
                                        </div>
                                    </ng-container>
                                    <!-- For Tourist Scheme end -->
                                </div>
                            </div>

                            <div class="vouchers-large-container mt-4 pt-4">
                                <div class="change-currency  d-flex justify-content-end align-items-center column-gap1 text-uppercase pb-2"
                                    *ngIf="isMultiCurrencyVoucher">
                                    <span>{{ commonLocaleData?.app_numbers?.one }} {{ company?.baseCurrency }}</span>
                                    <img alt="switch-icon" height="15px" src="/assets/images/switch-icon.svg" />
                                    <span *ngIf="!showExchangeRateEditField">{{ invoiceForm.get('exchangeRate')?.value
                                        }} {{
                                        account?.baseCurrency }}</span>
                                    <div class="currency-input-wrapper" *ngIf="showExchangeRateEditField">
                                        <text-field [cssClass]="'form-control'" [type]="'number'"
                                            [matSuffix]="account?.baseCurrency"
                                            formControlName="exchangeRate"></text-field>
                                    </div>
                                    <i class="icon-edit text-blue cursor-pointer"
                                        (click)="showExchangeRateEditField = true"
                                        *ngIf="!showExchangeRateEditField"></i>
                                    <i class="icon-save text-blue cursor-pointer"
                                        (click)="showExchangeRateEditField = false"
                                        *ngIf="showExchangeRateEditField"></i>
                                </div>

                                <!-- Voucher Table for Multiple Entries-->
                                <div class="vouchers-entry-table">
                                    <table formArrayName="entries" class="w-100">
                                        <thead>
                                            <tr>
                                                <th class="text-left">#</th>
                                                <th class="text-left product-column">Product/Service Description</th>
                                                <th width="12%">Qty/Unit</th>
                                                <th width="12%">Rate</th>
                                                <th width="12%">Amount</th>
                                                <th width="12%">Discount</th>
                                                <th width="12%">Tax</th>
                                                <th width="14%" class="total-column">Total</th>
                                            </tr>
                                        </thead>
                                        <tbody (clickOutside)="handleOutsideClick($event)">
                                            <ng-container
                                                *ngFor="let entry of invoiceForm?.get('entries')['controls']; let entryIndex = index">
                                                <ng-container formGroupName="0">
                                                    <tr (click)="activeEntryIndex = entryIndex">
                                                        <td class=" text-left">{{ entryIndex + 1 }}</td>
    
                                                        <!-- Product/Service Description -->
                                                        <td class="text-left product-column">
                                                            <ng-container
                                                                *ngFor="let transaction of entry?.get('transactions')['controls']; let transactionIndex = index"
                                                                formArrayName="transactions">
                                                                <ng-container [formGroupName]="transactionIndex">
                                                                    <ng-container formGroupName="account">
                                                                        <ng-container *ngIf="activeEntryIndex !== entryIndex">
                                                                            <span class="select-account-label">{{ transaction.get('account.name')?.value ? transaction.get('stock.name')?.value
                                                                                ? transaction.get('account.name')?.value +
                                                                                ' (' +
                                                                                transaction.get('stock.name')?.value +
                                                                                ')'
                                                                                : transaction.get('account.name')?.value : localeData?.select_account }}</span>
                                                                        </ng-container>
                                                                        <reactive-dropdown-field
                                                                            *ngIf="activeEntryIndex === entryIndex"
                                                                            [label]="commonLocaleData?.app_account"
                                                                            [placeholder]="localeData?.select_acc"
                                                                            formControlName="uniqueName"
                                                                            [name]="'transactionAccountUniqueName' + entryIndex"
                                                                            [labelValue]="transaction.get('stock.name')?.value
                                                                            ? transaction.get('account.name')?.value +
                                                                            ' (' +
                                                                            transaction.get('stock.name')?.value +
                                                                            ')'
                                                                            : transaction.get('account.name')?.value"
                                                                            [options]="voucherStockResults$ | async"
                                                                            [showCreateNew]="true" [enableDynamicSearch]="true"
                                                                            [isPaginationEnabled]="true"
                                                                            [createNewText]="commonLocaleData?.app_create_new"
                                                                            (scrollEnd)="handleSearchStockScrollEnd()"
                                                                            (selectedOption)="selectStock($event, entryIndex)"
                                                                            (dynamicSearchedQuery)="searchStock($event, 1)"
                                                                            (onClear)="selectStock($event, entryIndex, true)"
                                                                            (createOption)="toggleStockAsidePane()"
                                                                            [showOptionDivider]="true"
                                                                            >
                                                                            <ng-template #optionTemplate let-option="option">
                                                                                <ng-container *ngIf="!option.additional?.stock">
                                                                                    <a href="javascript:;" class="flex-column">
                                                                                        <div class="option-label pt-2">{{ option?.label | titlecase }}</div>
                                                                                        <div class="option-value pb-2">
                                                                                            {{ option.additional?.uniqueName }}
                                                                                        </div>
                                                                                    </a>
                                                                                </ng-container>
                                                                                <ng-container *ngIf="option.additional?.stock">
                                                                                    <a href="javascript:;" class="flex-column">
                                                                                        <div class="option-label">{{ option?.label }}</div>
                                                                                        <div class="option-value">
                                                                                            {{ option.additional?.uniqueName }}
                                                                                        </div>
                                                                                        <div class="option-value-stock">
                                                                                            {{ commonLocaleData?.app_stock }}:
                                                                                            {{ option.additional?.stock?.uniqueName
                                                                                            }}
                                                                                        </div>
                                                                                    </a>
                                                                                </ng-container>
                                                                            </ng-template>
                                                                        </reactive-dropdown-field>
                                                                    </ng-container>
                                                                    <ng-container
                                                                        *ngIf="(stockVariants[entryIndex] | async)?.length > 1"
                                                                        formGroupName="stock">
                                                                        <ng-container formGroupName="variant">
                                                                            <ng-container *ngIf="activeEntryIndex !== entryIndex">
                                                                                <span class="select-account-label">{{ localeData?.variant + ": " + transaction.get('stock.variant.name')?.value }}</span>
                                                                            </ng-container>
                                                                            <reactive-dropdown-field
                                                                                *ngIf="activeEntryIndex === entryIndex"
                                                                                [label]="localeData?.select_variant"
                                                                                [placeholder]="localeData?.select_variant"
                                                                                formControlName="uniqueName"
                                                                                [name]="'transactionStockVariantUniqueName' + entryIndex"
                                                                                [options]="stockVariants[entryIndex] | async"
                                                                                (selectedOption)="selectVariant($event, entryIndex)"
                                                                                (onClear)="selectVariant($event, entryIndex, true)">
                                                                            </reactive-dropdown-field>
                                                                        </ng-container>
                                                                    </ng-container>
                                                                </ng-container>
                                                            </ng-container>
    
                                                            <ng-container *ngIf="activeEntryIndex === entryIndex">
                                                                <textarea rows="2" matInput class="form-control mt-2" placeholder="Add Description" formControlName="description" [maxlength]="entryDescriptionLength"></textarea>
                                                                <span class="mt-2 font-12">{{ commonLocaleData?.app_characters_left }}: {{ entryDescriptionLength - entry.get("description")?.value?.length }}</span>
                                                            </ng-container>
                                                            <ng-container *ngIf="activeEntryIndex !== entryIndex">
                                                                {{ entry.get('description')?.value }}
                                                            </ng-container>
    
                                                            <ng-container *ngFor="let transaction of entry.get('transactions')['controls']; let transactionIndex = index" formArrayName="transactions">
                                                                <ng-container [formGroupName]="transactionIndex">
                                                                    <ng-container *ngIf="transaction.get('stock.skuCode')?.value">
                                                                        <span class="mt-2 font-12">{{ transaction.get('stock.skuCodeHeading')?.value }}: {{ transaction.get('stock.skuCode')?.value }}</span>
                                                                    </ng-container>
                                                                </ng-container>
                                                            </ng-container>
    
                                                            <div class="d-flex justify-content-between">
                                                                <div class="w-50">
                                                                    <div class="mt-2 font-12">
                                                                        <span>Entry Date</span>
                                                                        <div class="mt-1" *ngIf="activeEntryIndex !== entryIndex">
                                                                            {{ entry.get('date')?.value }}
                                                                        </div>
                                                                        <div class="mt-1 d-flex align-items-baseline" *ngIf="activeEntryIndex === entryIndex">
                                                                            <ng-container *ngIf="isUpdateMode">
                                                                                {{ entry.get('date')?.value }}
                                                                            </ng-container>
                                                                            <ng-container *ngIf="!isUpdateMode">
                                                                                <giddh-datepicker
                                                                                    class="date-border"
                                                                                    [showToggleIcon]="false"
                                                                                    [hideLabel]="true"
                                                                                    #dp
                                                                                    (keydown.enter)="$event.preventDefault()"
                                                                                    (dateSelected)="onBlurEntryDate(entry, true)"
                                                                                    id="transaction_date_{{ entryIndex }}"
                                                                                    [disabled]="isUpdateMode"
                                                                                    [cssClass]="'entry-custom-date width-80 border-0'"
                                                                                    name="transaction_date_{{ entryIndex }}"
                                                                                    formControlName="date"
                                                                                    [appearance]="'fill'"
                                                                                    (datepickerState)="openEntryDatepicker = $event"
                                                                                    [isOpened]="openEntryDatepicker"
                                                                                >
                                                                                </giddh-datepicker>
                                                                            </ng-container>
                                                                            <i class="icon-edit text-blue cursor-pointer" (click)="openEntryDatepicker = true"></i>
                                                                        </div>
                                                                    </div>
                                                                </div>
    
                                                                <div class="w-50 text-right">
                                                                    <div class="mt-2 font-12">
                                                                        <span>{{ entry.get('showCodeType')?.value === 'hsn' ? commonLocaleData?.app_hsn_code : commonLocaleData?.app_sac_code }}: {{ entry.get('showCodeType')?.value === 'hsn' ? entry.get('hsnNumber')?.value : entry.get('sacNumber')?.value }}</span>
                                                                        <div class="mt-1" [hidden]="activeEntryIndex !== entryIndex">Update <i class="icon-edit text-blue cursor-pointer" (click)="updateCurrentHsnSac(entry)" #menuTrigger="matMenuTrigger" [matMenuTriggerFor]="update"></i></div>
    
                                                                        <!-- Update Menu  -->
                                                                        <mat-menu #update="matMenu">
                                                                            <div class="p-3" (click)="$event.stopPropagation()">
                                                                                <mat-radio-group formControlName="showCodeType" [disabled]="isEinvoiceGenerated">
                                                                                    <mat-radio-button color="primary" value="hsn">HSN
                                                                                        Code</mat-radio-button>
                                                                                    <mat-radio-button color="primary" value="sac">SAC
                                                                                        Code</mat-radio-button>
                                                                                </mat-radio-group>
    
                                                                                <div class="mt-3">
                                                                                    <text-field *ngIf="entry.get('showCodeType')?.value === 'hsn'" [placeholder]="commonLocaleData?.app_hsn_code"
                                                                                        [cssClass]="'form-control text-right'" [type]="'number'" formControlName="hsnNumber" [maxlength]="10" [allowDecimalDigitsOnly]="true" [placeholder]="localeData?.hsn_number" [readonly]="isEinvoiceGenerated"[name]="'hsnNumber_' + entryIndex">
                                                                                    </text-field>
                                                                                    <text-field *ngIf="entry.get('showCodeType')?.value === 'sac'" [placeholder]="commonLocaleData?.app_sac_code"
                                                                                        [cssClass]="'form-control text-right'" [type]="'number'" formControlName="sacNumber" [maxlength]="10" [allowDecimalDigitsOnly]="true" [placeholder]="localeData?.sac_number" [readonly]="isEinvoiceGenerated" [name]="'sacNumber_' + entryIndex">
                                                                                    </text-field>
                                                                                </div>
    
                                                                                <div class="mt-3">
                                                                                    <button mat-stroked-button color="primary" class="mr-2" (click)="menuTrigger?.closeMenu()">Save</button>
                                                                                    <button mat-stroked-button (click)="cancelHsnSacEdit(entry); menuTrigger?.closeMenu()">Cancel</button>
                                                                                </div>
                                                                            </div>
                                                                        </mat-menu>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </td>
    
                                                        <ng-container *ngFor="let transaction of entry.get('transactions')['controls']; let transactionIndex = index" formArrayName="transactions">
                                                            <ng-container [formGroupName]="transactionIndex">
                                                                <ng-container formGroupName="stock">
                                                                    <!-- Qty/Unit -->
                                                                    <td width="12%">
                                                                        <ng-container *ngIf="activeEntryIndex !== entryIndex">{{ transaction.get('stock.quantity')?.value }}</ng-container>
                                                                        <text-field *ngIf="activeEntryIndex === entryIndex" [placeholder]="'Enter Qty'" formControlName="quantity" [cssClass]="'form-control text-right'" [type]="'text'"></text-field>
                                                                        <ng-container formGroupName="stockUnit">
                                                                            <ng-container *ngIf="activeEntryIndex !== entryIndex">{{ transaction.get('stock.stockUnit.code')?.value }}</ng-container>
                                                                            <mat-select *ngIf="activeEntryIndex === entryIndex" formControlName="code" [placeholder]="'Select'" class="form-control mt-2">
                                                                                <mat-option *ngFor="let unit of stockUnits[entryIndex] | async" [value]="unit.stockUnitUniqueName">{{ unit.stockUnitCode }}</mat-option>
                                                                            </mat-select>
                                                                        </ng-container>
                                                                    </td>
    
                                                                    <!-- Rate -->
                                                                    <td width="12%" formGroupName="rate">
                                                                        <ng-container *ngIf="activeEntryIndex !== entryIndex">{{ transaction.get('stock.rate.rateForAccount')?.value }}</ng-container>
                                                                        <text-field *ngIf="activeEntryIndex === entryIndex" [placeholder]="'Enter'" [cssClass]="'form-control text-right'" [type]="'text'" formControlName="rateForAccount"></text-field>
                                                                    </td>
                                                                </ng-container>
                                                                <!-- Amount -->
                                                                <td width="12%" formGroupName="amount">
                                                                    <ng-container *ngIf="activeEntryIndex !== entryIndex">
                                                                        <amount-field
                                                                            [amount]="transaction.get('amount.amountForAccount')?.value"
                                                                            [currencySymbol]="isMultiCurrencyVoucher ? account.baseCurrencySymbol : false"
                                                                            [currencyCode]="isMultiCurrencyVoucher ? account.baseCurrency : false">
                                                                        </amount-field>
                                                                    </ng-container>
                                                                    <text-field *ngIf="activeEntryIndex === entryIndex" [placeholder]="'Enter'" [cssClass]="'form-control text-right'" [type]="'text'" formControlName="amountForAccount"></text-field>
                                                                </td>
                                                            </ng-container>
                                                        </ng-container>
    
                                                        <!-- Discount -->
                                                        <td width="12%">
                                                            <ng-container *ngFor="let transaction of entry.get('transactions')['controls']; let transactionIndex = index" formArrayName="transactions">
                                                                <ng-container [formGroupName]="transactionIndex">
                                                                    <ng-container *ngIf="activeEntryIndex !== entryIndex">
                                                                        <amount-field
                                                                            [amount]="entry.get('totalDiscount')?.value"
                                                                            [currencySymbol]="isMultiCurrencyVoucher ? account.baseCurrencySymbol : false"
                                                                            [currencyCode]="isMultiCurrencyVoucher ? account.baseCurrency : false">
                                                                        </amount-field>
                                                                    </ng-container>
                                                                    <discount-dropdown *ngIf="activeEntryIndex === entryIndex" [amount]="transaction.get('amount.amountForAccount')?.value" [discountsList]="discountsList$ | async" [selectedDiscountsList]="entry.get('discounts')?.value" [currency]="account.baseCurrencySymbol" (createNewDiscount)="showCreateDiscountDialog()" (selectedDiscounts)="getSelectedDiscounts($event)" (totalDiscount)="updateTotalDiscount($event, entry)"></discount-dropdown>
                                                                </ng-container>
                                                            </ng-container>        
                                                        </td>
    
                                                        <!-- Tax -->
                                                        <td width="12%">
                                                            <ng-container *ngFor="let transaction of entry.get('transactions')['controls']; let transactionIndex = index" formArrayName="transactions">
                                                                <ng-container [formGroupName]="transactionIndex">
                                                                    <ng-container *ngIf="activeEntryIndex !== entryIndex">
                                                                        <amount-field
                                                                            [amount]="entry.get('totalTax')?.value"
                                                                            [currencySymbol]="isMultiCurrencyVoucher ? account.baseCurrencySymbol : false"
                                                                            [currencyCode]="isMultiCurrencyVoucher ? account.baseCurrency : false">
                                                                        </amount-field>
                                                                    </ng-container>
                                                                    <tax-dropdown *ngIf="activeEntryIndex === entryIndex" [date]="invoiceForm.get('date')?.value" [amount]="transaction.get('amount.amountForAccount')?.value - entry.get('totalDiscount')?.value" [selectedTaxesList]="entry.get('taxes')?.value" [taxesList]="companyTaxes$ | async" [currency]="account.baseCurrencySymbol" (createNewTax)="showCreateTaxDialog()" (selectedTaxes)="getSelectedTaxes($event)" (totalTax)="updateTotalTax($event, entry)"></tax-dropdown>
                                                                </ng-container>
                                                            </ng-container>
                                                        </td>
    
                                                        <!-- Total -->
                                                        <td width="14%" class="total-column position-relative">
                                                            <ng-container formGroupName="total">
                                                                <ng-container *ngIf="activeEntryIndex !== entryIndex">
                                                                    <amount-field
                                                                        [amount]="entry.get('total.amountForAccount')?.value"
                                                                        [currencySymbol]="isMultiCurrencyVoucher ? account.baseCurrencySymbol : false"
                                                                        [currencyCode]="isMultiCurrencyVoucher ? account.baseCurrency : false">
                                                                    </amount-field>
                                                                </ng-container>
                                                                <text-field *ngIf="activeEntryIndex === entryIndex" [placeholder]="'Enter'" [cssClass]="'form-control text-right'" [type]="'text'" formControlName="amountForAccount"></text-field>
                                                            </ng-container>
                                                            <div class="d-flex align-items-center" *ngIf="activeEntryIndex === entryIndex">
                                                                <mat-checkbox type="checkbox" color="primary" (change)="openOtherTaxDialog()">
                                                                </mat-checkbox>
                                                                Other Tax?
                                                            </div>

                                                            <!-- Delete Row Button -->
                                                            <i class="icon-trash font-16 cursor-pointer delete-btn position-absolute" (click)="deleteLineEntry(entryIndex)"></i>
                                                        </td>         
                                                    </tr>
                                                </ng-container>
                                            </ng-container>
                                        </tbody>
                                    </table>
                                </div>
                                <!-- Add new row/line -->
                                <div class="text-blue mt-2 px-0">
                                    <span class="cursor-pointer" (click)="addNewLineEntry()">+ Add New Line</span> <span
                                        class="grey-color px-2">|</span>
                                    <span class="cursor-pointer" (click)="openBulkEntryDialog()">+ Add Bulk
                                        Entries</span>
                                </div>

                                <div class="vouchers-other-detail container-lg mt-4 px-0">
                                    <div class="row mx-0">
                                        <div class="col-8 px-0">
                                            <div class="container px-0">
                                                <div class="row">
                                                    <div class="col-12">
                                                        <mat-card>
                                                            <mat-card-header>
                                                                <mat-card-title>
                                                                    <p class="font-16 mb-3">Deposit</p>
                                                                </mat-card-title>
                                                            </mat-card-header>
                                                            <mat-card-content>
                                                                <div class="container px-0" formGroupName="deposit">
                                                                    <div class="row align-items-center">
                                                                        <ng-container *ngIf="true">
                                                                            <div class="col-6">
                                                                                <reactive-dropdown-field
                                                                                    [label]="'Account'"
                                                                                    [placeholder]="'Select Account'"
                                                                                    [options]="briefAccounts$ | async"
                                                                                    formControlName="accountUniqueName">
                                                                                </reactive-dropdown-field>
                                                                            </div>
                                                                            <div class="col-6">
                                                                                <input-field [name]="'amountForCompany'"
                                                                                    [label]="'Amount'"
                                                                                    [placeholder]="'Enter amount'"
                                                                                    [type]="'number'"
                                                                                    formControlName="amountForCompany">
                                                                                </input-field>
                                                                            </div>
                                                                        </ng-container>

                                                                        <div class="col" *ngIf="false">
                                                                            <div
                                                                                class="d-flex align-items-center column-gap1">
                                                                                <span>Adjust Amount</span>
                                                                                <span class="text-gray">00.00</span>
                                                                                <i
                                                                                    class="icon-edit text-blue font-12"></i>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </mat-card-content>
                                                        </mat-card>
                                                    </div>
                                                    <div class="col-12 mt-3" formGroupName="templateDetails">
                                                        <mat-accordion>
                                                            <mat-expansion-panel>
                                                                <mat-expansion-panel-header>
                                                                    <mat-panel-title>
                                                                        Other Details
                                                                    </mat-panel-title>
                                                                </mat-expansion-panel-header>

                                                                <div class="row row-gap mx-0 px-2 pb-3"
                                                                    formGroupName="other">
                                                                    <div class="col-4 px-2">
                                                                        <giddh-datepicker type="text"
                                                                            (keydown.enter)="$event.preventDefault()"
                                                                            [label]="'Ship Date'"
                                                                            [placeholder]="'DDMMYYYY'"
                                                                            name="shippingDate" [showToggleIcon]="false"
                                                                            [appearance]="'outline'"
                                                                            formControlName="shippingDate">
                                                                        </giddh-datepicker>
                                                                    </div>
                                                                    <div class="col-4 px-2">
                                                                        <input-field [type]="'text'"
                                                                            [placeholder]="'Ship Via'"
                                                                            [name]="'shippedVia'"
                                                                            formControlName="shippedVia">
                                                                        </input-field>
                                                                    </div>
                                                                    <div class="col-4 px-2">
                                                                        <input-field [type]="'text'"
                                                                            [placeholder]="'Tracking No.'"
                                                                            [name]="'trackingNumber'"
                                                                            formControlName="trackingNumber">
                                                                        </input-field>
                                                                    </div>
                                                                    <div class="col-4 px-2">
                                                                        <input-field [type]="'text'"
                                                                            [placeholder]="'Custom Field 1'"
                                                                            [name]="'customField1'"
                                                                            formControlName="customField1">
                                                                        </input-field>
                                                                    </div>
                                                                    <div class="col-4 px-2">
                                                                        <input-field [type]="'text'"
                                                                            [placeholder]="'Custom Field 2'"
                                                                            [name]="'customField2'"
                                                                            formControlName="customField2">
                                                                        </input-field>
                                                                    </div>
                                                                    <div class="col-4 px-2">
                                                                        <input-field [type]="'text'"
                                                                            [placeholder]="'Custom Field 3'"
                                                                            [name]="'customField3'"
                                                                            formControlName="customField3">
                                                                        </input-field>
                                                                    </div>
                                                                    <div class="col-12 px-2">
                                                                        <mat-form-field class="w-100"
                                                                            appearance="outline">
                                                                            <mat-label>Note</mat-label>
                                                                            <textarea matInput placeholder="Enter Note"
                                                                                name="message2"
                                                                                formControlName="message2"></textarea>
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="col-12 px-2">
                                                                        <ng-container *ngIf="!selectedFileName">
                                                                            <div class="vouchers-attachment mat-form-field-border d-flex align-items-center column-gap1 p-2"
                                                                                [matTooltip]="'No file chosen'"
                                                                                matTooltipPosition="right">
                                                                                <input type="file"
                                                                                    class="position-absolute"
                                                                                    name="invoiceFile" id="invoiceFile"
                                                                                    (change)="uploadFile()"
                                                                                    droppable="true" />
                                                                                <ng-container *ngIf="isFileUploading">
                                                                                    <mat-spinner
                                                                                        [diameter]="30"></mat-spinner>
                                                                                </ng-container>
                                                                                <ng-container *ngIf="!isFileUploading">
                                                                                    <div class="attachment-add-icon">
                                                                                        <i class="icon-add"></i>
                                                                                    </div>
                                                                                    <span
                                                                                        class="attachment-placeholder">Attach
                                                                                        File
                                                                                        to
                                                                                        voucher</span>
                                                                                </ng-container>
                                                                            </div>
                                                                        </ng-container>
                                                                        <ng-container
                                                                            *ngIf="!isFileUploading && selectedFileName">
                                                                            <div
                                                                                class="vouchers-attachment mat-form-field-border d-flex align-items-center column-gap1 p-2 text-success">
                                                                                <div class="attachment-add-icon">
                                                                                    <i class="icon-tick"></i>
                                                                                </div>
                                                                                <span class="attachment-placeholder">{{
                                                                                    selectedFileName
                                                                                    }}</span>
                                                                                <button mat-icon-button
                                                                                    (click)="deleteAttachementConfirmation()"
                                                                                    class="ml-auto remove-attachment font-16">
                                                                                    <i class="icon-cross"></i>
                                                                                </button>
                                                                            </div>
                                                                        </ng-container>
                                                                    </div>
                                                                </div>
                                                            </mat-expansion-panel>
                                                        </mat-accordion>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-4 px-0">
                                            <div class="row text-right row-gap">
                                                <div class="col-9">
                                                    Total Amount
                                                </div>
                                                <div class="col-3">
                                                    750.00
                                                </div>
                                                <div class="col-9">
                                                    Discount
                                                </div>
                                                <div class="col-3">
                                                    0.00
                                                </div>
                                                <div class="col-9">
                                                    Taxable Value
                                                </div>
                                                <div class="col-3">
                                                    750.00
                                                </div>
                                                <div class="col-9">
                                                    Tax
                                                </div>
                                                <div class="col-3">
                                                    90.00
                                                </div>
                                                <div class="col-9">
                                                    CESS
                                                </div>
                                                <div class="col-3">
                                                    0.00
                                                </div>
                                                <div class="col-9">
                                                    Total
                                                </div>
                                                <div class="col-3">
                                                    840.00
                                                </div>
                                                <div class="col-9">
                                                    Balance Due
                                                </div>
                                                <div class="col-3">
                                                    0.00
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="vouchers-actions d-flex justify-content-end column-gap1 pd-t2 pd-b2 mt-4">
                                    <button mat-stroked-button *ngIf="!isUpdateMode">Clear</button>
                                    <button mat-stroked-button color="primary" *ngIf="invoiceType.isSalesInvoice">Generate Sales & Update A/c</button>
                                    <button mat-stroked-button color="primary" *ngIf="invoiceType.isSalesInvoice">Generate Sales</button>

                                    <button mat-stroked-button color="primary" *ngIf="invoiceType.isCreditNote"> Generate Credit Note & Update A/c
                                    </button>
                                    <button mat-stroked-button color="primary" *ngIf="invoiceType.isCreditNote"> Generate Credit Note </button>

                                    <button mat-stroked-button color="primary" *ngIf="invoiceType.isPurchaseInvoice"> Save </button>
                                    <button mat-stroked-button [matMenuTriggerFor]="moreOptions"
                                        class="vouchers-more-option-btn" *ngIf="invoiceType.isSalesInvoice"> <i class="caret"></i>
                                    </button>
                                    <mat-menu #moreOptions="matMenu">
                                        <button mat-menu-item (click)="
                                      createSendVoucher()
                                    ">Create & Send</button>
                                        <button mat-menu-item (click)="
                                        createPrintVoucher()">Create & Print</button>
                                    </mat-menu>
                                </div>
                            </div>

                        </div>
                    </form>
                </div>

            </mat-card-content>
        </mat-card>
    </div>
</ng-container>

<ng-template #accountAsideMenu>
    <generic-aside-menu-account (closeAsideEvent)="accountAsideMenuRef.close()" [class]="'in'"
        [selectedGrpUniqueName]="accountParentGroup" [keyboardShortcut]="{ 'esc': !hasUnsavedChanges }"
        [selectedAccountUniqueName]="invoiceForm.controls['account'].get('uniqueName')?.value"
        (onShortcutPress)="accountAsideMenuRef.close()" (addEvent)="addNewAccount($event)"
        (updateEvent)="updateAccount($event)">
    </generic-aside-menu-account>
</ng-template>

<!-- Create Tax Aside Pane -->
<ng-template #createTax>
    <aside-menu-create-tax-component [class]="'in'" [tax]="selectedTax" [localeData]="localeData"
        [commonLocaleData]="commonLocaleData" (closeEvent)="taxAsideMenuRef.close()"></aside-menu-create-tax-component>
</ng-template>

<ng-template #asideMenuProductService>
    <aside-menu-product-service [selectedVoucherType]="invoiceType"
        (closeAsideEvent)="closeAsideMenuProductServiceModal()">
    </aside-menu-product-service>
</ng-template>

<!-- region print voucher popup -->
<ng-template #printVoucherModal>
    <ng-container >
        <print-voucher (cancelEvent)="cancelPrintModal()"></print-voucher>
    </ng-container>
</ng-template>

<!-- region send email popup -->
<ng-template #sendEmailModal>
    <ng-container >
        <app-email-send-dialog (cancelEvent)="cancelEmailModal()"></app-email-send-dialog>
    </ng-container>
</ng-template>
<!-- endregion -->

<ng-template #dateChangeConfirmationModel>
    <confirmation-modal
        [configuration]="dateChangeConfiguration"
        (buttonClicked)="handleDateChangeConfirmation($event)"
    ></confirmation-modal>
</ng-template>

<!-- region bulk items -->
<ng-template #bulkItemsModal>
    <add-bulk-items
        (closeEvent)="cancelBulkItemsModal()"
    ></add-bulk-items>
</ng-template>
