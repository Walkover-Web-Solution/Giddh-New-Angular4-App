<div class="container-fluid" *ngIf="!(getPettycashReportInprocess$ | async) && !isRowExpand ">
    <div class="table-responsive">
        <table class="table basic table-bordered mt-2 onMobileView">
            <thead>
            <tr>
                <th data-title="#">#</th>

                <th>Date
                    <ng-container class="d-inline-block"
                                  *ngTemplateOutlet="sortingTemplate;context: { $implicit: 'entry_date'}"></ng-container>
                </th>

                <th #submittedBySearchContainer
                    (clickOutside)="clickedOutside($event, submittedBySearchContainer, 'submittedBy')">Submitted By
                    <ng-container *ngTemplateOutlet="searchTemplate;context:{ $implicit: showSubmittedBySearch,
          title: 'Submitted By', fieldName: 'submittedBy', formControl: submittedBySearchInput}"></ng-container>


                </th>

                <th #accountSearchContainer
                    (clickOutside)="clickedOutside($event, accountSearchContainer, 'account')"
                >Account
                    <ng-container *ngTemplateOutlet="searchTemplate;context:{ $implicit: showAccountSearch,
                        title: 'Account', fieldName: 'account', formControl: accountSearchInput}"></ng-container>
                </th>

                <th class="text-right pr-2">Amount
                    <ng-container class="d-inline-block "
                                  *ngTemplateOutlet="sortingTemplate;context: { $implicit: 'amount'}"></ng-container>
                </th>

                <th #paymentReceiptSearchContainer
                    (clickOutside)="clickedOutside($event, paymentReceiptSearchContainer, 'payment/receive')"
                >Payment/Receipt
                    <ng-container *ngTemplateOutlet="searchTemplate;context:{ $implicit: showPaymentReceiveSearch,
                        title: 'Payment/Receipt', fieldName: 'payment/receive', formControl: paymentReceiveSearchInput}"></ng-container>
                </th>

                <th>File</th>
                <th>Description</th>
                <th>Action</th>
            </tr>
            </thead>

            <tbody>

            <tr (click)="rowClicked(expenses);" class="cursor-pointer"
                *ngFor="let expenses of expensesItems let i = index">

                <ng-container id="rowcomys" (click)="rowClicked(expenses);">

                    <td data-title="#">{{i + 1}}</td>

                    <td data-title="Date">{{expenses.entryDate}}</td>

                    <td data-title="Submitted By">{{expenses.createdBy.name}} </td>

                    <td data-title="Account">
                        <i class="dot-icon dot-warning" *ngIf="expenses.entryType==='sales'"></i>
                        <i class="dot-icon dot-success" *ngIf="expenses.entryType==='deposit'"></i>
                        <i class="dot-icon dot-primary"
                           *ngIf="expenses.entryType==='expense'"></i> {{expenses.particularAccount.name}}
                    </td>

                    <td data-title="Amount"
                        class="text-right pr-2"> {{expenses.currencySymbol}} {{ expenses.amount | giddhCurrency}}</td>

                    <td data-title="Payment/Receipt">
                        <span *ngIf="expenses.baseAccountCategory==='OTHER'" class="font-12 text-gray">A/c</span>
                        <span *ngIf="expenses.baseAccountCategory==='BANK'"
                              class="font-12 text-gray icon-atm-card"></span>
                        <span *ngIf="expenses.baseAccountCategory==='CASH'"
                              class="font-12 text-gray icon-cash"></span> {{expenses.baseAccount.name}}
                    </td>

                    <td data-title="File">
                        <a *ngIf="!expenses.fileNames" class="font-12">
                            <i class="icon-file-path middle"></i> attach file</a>
                        <i *ngIf="expenses.fileNames" class="icon-image middle text-gray"></i> {{expenses.fileNames}}
                    </td>

                    <td data-title="Description"><span *ngIf="expenses.description">{{expenses.description}}</span><span
                        *ngIf="!expenses.description">-</span></td>

                    <td data-title="Action">
                        <button type="button" (click)="showApproveConfirmPopup(ApproveConfirm,expenses);$event.stopPropagation()"
                                class="btn btn-success-outline">Approve
                        </button>
                    </td>

                </ng-container>

            </tr>

            </tbody>

        </table>
    </div>
</div>

<!-- <div *ngIf="(pettyCashReportsResponse$ | async)?.totalItems>1" class="paginationWrapper">
    <pagination [totalItems]="(pettyCashReportsResponse$ | async)?.totalItems" [maxSize]="5" class="pagination-sm" [boundaryLinks]="true" [itemsPerPage]="20" [rotate]="false" previousText="&#9668;" nextText="&#9658;" (pageChanged)="pageChanged($event)"></pagination>
</div> -->

<div *ngIf="(getPettycashReportInprocess$ | async) ">
    <div class="no-data mrT2 d-flex "
         style="justify-content: center;align-items: center;margin-top:125px;margin-bottom: 105px; ">
        <div class="giddh-spinner vertical-center-spinner "></div>
    </div>

</div>
<div class="no-data"
     *ngIf="(pettyCashReportsResponse$ | async)?.results?.length === 0 && !(getPettycashReportInprocess$ | async)">
    <h1>No entries found within given criteria.</h1>
    <h1>Do search with some other dates</h1>
</div>

<!--loading-->

<!-- region sorting template -->
<ng-template #sortingTemplate let-col>

    <div class="icon-sort-asc" *ngIf="key !== col" (click)="sort('asc', col)"
         [ngClass]="{'activeTextColor': key === col && order === 'asc'}">
    </div>

    <div class="icon-sort-asc" *ngIf="key === col && order === 'asc'"
         (click)="sort('desc', col)"
         [ngClass]="{'activeTextColor': key === col && order === 'asc'}">
    </div>

    <div class="icon-sort-dsc" *ngIf="key === col && order === 'desc'"
         (click)="sort('asc', col)"
         [ngClass]="{'activeTextColor': key === col && order === 'desc'}">
    </div>

</ng-template>
<!-- endregion -->

<!-- region search template -->
<ng-template #searchTemplate let-show let-title="title" let-fieldName="fieldName" let-formControl="formControl">

    <div [hidden]="show">
        <span> {{ title }}</span>
        <i class="icon-search" (click)="toggleSearch(fieldName, searchBox);"></i>
    </div>

    <div class="input-container" [hidden]="!show">
        <input type="text" placeholder="Search {{ title }}" class="w100" #searchBox [formControl]="formControl"/>
    </div>

</ng-template>
<!-- endregion -->

<!-- region approve entry confirm -->
<ng-template #ApproveConfirm>
    <div class="modal-header">
        <h3 class="modal-title pull-left">Approve</h3>
        <button type="button" class="close pull-right" aria-label="Close" (click)="approveEntryModalRef.hide()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>

    <div class="modal-body">
        <!-- <app-rejection-reason></app-rejection-reason> -->
        <div class="clearfix modal-top">
            <p class="font-12 text-gray mb-1">
                <span>{{selectedEntryForApprove?.entryDate}} </span> |
                <span>by {{selectedEntryForApprove?.createdBy?.name}}</span>
            </p>
            <div class="row mb-1">
                <div class="col-xs-4">
                    <p class="font-14">Expenses:</p>
                </div>
                <div class="col-xs-8">
                    <p class="font-14">{{selectedEntryForApprove?.particularAccount?.name}}</p>
                </div>
            </div>
            <div class="row mb-1">
                <div class="col-xs-4">
                    <p class="font-14">Payment Mode:</p>
                </div>
                <div class="col-xs-8">
                    <p class="font-14">{{selectedEntryForApprove?.baseAccount?.name}}</p>
                </div>
            </div>
            <div class="row mb-1">
                <div class="col-xs-4">
                    <p class="font-14">Amount:</p>
                </div>
                <div class="col-xs-8">
                    <p class="font-14">
                        <i>{{selectedEntryForApprove?.currencySymbol}} {{ selectedEntryForApprove?.amount}}</i></p>
                </div>
            </div>
        </div>

        <div class="form-group">
            <p>Are you sure to approve above transaction and add into your books ?</p>
        </div>

        <div>
            <button class="btn btn-warning" (click)="hideApproveConfirmPopup()">No</button>
            <button class="btn btn-success" (click)="approveEntry(selectedEntryForApprove)">Yes</button>
        </div>

    </div>
</ng-template>
<!-- endregion -->
