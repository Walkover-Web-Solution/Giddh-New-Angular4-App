<div id="main" class="welcome-outer">
    <layout-main [sideMenu]="false">
        <div class="welcome-header">
            <h2>Welcome To Giddh! </h2>
        </div>
        <hr />
        <div class="welcome-msg">
            <div class="row">
                <div class="col-sm-9">
                    <p>Hi {{logedInUser?.name}} !</p>
                    <p>You belong to the following plan. Please select the plan in which you wish to create new company
                        <strong> "{{createNewCompanyPreObj?.name}}". </strong>
                    </p>

                </div>
                <div class="col-sm-3">
                    <div class=" pull-right xs-left">
                        <a [routerLink]="['/welcome']" class="btn btn-default mr-0 pr-3 pl-3 mb-2">Back</a>
                    </div>
                </div>
            </div>


            <div *ngIf="!isCreateAndSwitchCompanyInProcess" class="choose-ur-plan">
                <div class="row">
                    <div class="col-sm-12 col-md-9">
                        <div class="row">
                            <ng-container *ngFor="let item of SubscriptionPlans; let i=index">
                                <!-- Free plans -->
                                <ng-container *ngIf="!item?.planDetails?.amount && !item.subscriptionId">
                                    <div class="col-md-4 col-sm-6 col-xs-12">
                                        <div class="select-plan-block">
                                            {{item?.planDetails?.name}}
                                            <div class="your-account">
                                                <div class="row">
                                                    <div class="col-xs-6">
                                                        <span>
                                                            Subscription Price
                                                        </span>
                                                    </div>
                                                    <div class="col-xs-6">
                                                        <p *ngIf="item?.planDetails?.amount">
                                                            {{item?.planDetails?.amount | number}}
                                                        </p>
                                                        <p *ngIf="!item?.planDetails?.amount">
                                                            FREE
                                                        </p>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-xs-6">
                                                        <span>
                                                            Total Companies
                                                        </span>
                                                    </div>
                                                    <div class="col-xs-6">
                                                        <p class="">
                                                            {{item?.planDetails?.companiesLimit | number}}
                                                        </p>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-xs-6">
                                                        <span>
                                                            Transactions Limit
                                                        </span>
                                                    </div>
                                                    <div class="col-xs-6">
                                                        <p>
                                                            {{item?.planDetails?.transactionLimit | number}}
                                                        </p>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-xs-6">
                                                        <span>
                                                            Subscription Renewal
                                                        </span>
                                                    </div>
                                                    <div class="col-xs-6">
                                                        <p>
                                                            {{item?.planDetails?.duration }}
                                                            {{item?.planDetails?.durationUnit}}(s)
                                                        </p>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-xs-12">
                                                        <button class="btn btn-primary mr-t1 mr-b2"
                                                            (click)="createCompany(item);"
                                                            [ladda]="isCompanyCreationInProcess$ | async">Select
                                                            Plan</button>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>

                                    </div>
                                </ng-container>
                                <!-- new plan after free -->
                                <ng-container *ngIf="item?.planDetails?.amount && !item.subscriptionId">
                                    <div class="col-md-4 col-sm-6 col-xs-12">
                                        <div class="select-plan-block">
                                            {{item?.planDetails?.name}}
                                            <div class="your-account">
                                                <div class="row">
                                                    <div class="col-xs-6">
                                                        <span>
                                                            Subscription Price
                                                        </span>
                                                    </div>
                                                    <div class="col-xs-6">
                                                        <p>
                                                            {{item?.planDetails?.amount | number}}
                                                        </p>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-xs-6">
                                                        <span>
                                                            Total Companies
                                                        </span>
                                                    </div>
                                                    <div class="col-xs-6">
                                                        <p class="">
                                                            {{item?.planDetails?.companiesLimit | number}}
                                                        </p>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-xs-6">
                                                        <span>
                                                            Transactions Limit
                                                        </span>
                                                    </div>
                                                    <div class="col-xs-6">
                                                        <p>
                                                            {{item?.planDetails?.transactionLimit | number}}
                                                        </p>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-xs-6">
                                                        <span>
                                                            Subscription Renewal
                                                        </span>
                                                    </div>
                                                    <div class="col-xs-6">
                                                        <p>
                                                            {{item?.planDetails?.duration}}
                                                            {{item?.planDetails?.durationUnit}}(s)
                                                        </p>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-xs-12">
                                                        <button class="btn btn-success mr-t1 mr-b2"
                                                            (click)="buyPlanClicked(item)">Buy Plan</button>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>

                                    </div>
                                </ng-container>
                            </ng-container>
                        </div>
                        <div class="row">
                            <ng-container *ngFor="let paidItem of SubscriptionPlans">
                                <ng-container
                                    *ngIf="paidItem?.subscriptionId && paidItem?.totalCompanies!==paidItem?.planDetails?.companiesLimit">

                                    <div class="col-md-4 col-sm-6 col-xs-12">
                                        <div class="select-plan-block">
                                            {{paidItem?.planDetails?.name}}
                                            <div class="your-account">

                                                <div class="row">
                                                    <div class="col-xs-6">
                                                        <span>
                                                            Subscription ID
                                                        </span>
                                                    </div>
                                                    <div class="col-xs-6">
                                                        <p>
                                                            {{paidItem.subscriptionId}}
                                                        </p>
                                                    </div>
                                                </div>

                                                <!--  -->
                                                <div class="row">
                                                    <div class="col-xs-6">
                                                        <span>
                                                            Subscription Price
                                                        </span>
                                                    </div>
                                                    <div class="col-xs-6">
                                                        <p>
                                                            {{paidItem?.planDetails?.amount | number}}
                                                        </p>
                                                    </div>
                                                </div>
                                                <!--  -->

                                                <div class="row">
                                                    <div class="col-xs-6">
                                                        <span>
                                                            Total Companies
                                                        </span>
                                                    </div>
                                                    <div class="col-xs-6">
                                                        <p class="">
                                                            {{ paidItem?.totalCompanies | number}} out of
                                                            {{ paidItem?.planDetails?.companiesLimit | number}}
                                                        </p>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-xs-6">
                                                        <span>
                                                            Transactions Limit
                                                        </span>
                                                    </div>
                                                    <div class="col-xs-6">
                                                        <p>
                                                            {{paidItem?.planDetails?.transactionLimit | number}}
                                                        </p>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-xs-6">
                                                        <span>
                                                            Subscription Renewal
                                                        </span>
                                                    </div>
                                                    <div class="col-xs-6">
                                                        <p>
                                                            {{paidItem?.expiry}}
                                                        </p>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-xs-12">
                                                        <button class="btn btn-primary mr-t1 mr-b2"
                                                            [ladda]="isCompanyCreationInProcess$ | async"
                                                            (click)="createCompany(paidItem)">Select Plan</button>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>

                                    </div>
                                </ng-container>
                            </ng-container>
                        </div>
                    </div>

                    <div class="col-sm-12 col-md-3">
                        <div class="activation-key">
                            <label>Activation Key</label>
                            <input type="text" name="licenceKey" required id="licenceKey" [formControl]="licenceKey"
                                class="form-control mr-t1" placeholder="Enter activation key">
                        </div>
                        <div class="activation-btn">
                            <button class="btn btn-green mr-t1" [disabled]="!licenceKey.value"
                                (click)="createCompanyViaActivationKey()"> Activate</button>
                        </div>
                    </div>
                </div>
            </div>
            <div *ngIf="isCreateAndSwitchCompanyInProcess">
                <div class="no-data mr-t2 loader-main">
                    <!-- <div class="giddh-spinner vertical-center-spinner"></div> -->
                    <div class="spinner2">
                        <div class="cube1"></div>
                        <div class="cube2"></div>
                    </div>
                </div>
            </div>
        </div>
    </layout-main>
</div>
