<form autocomplete="off" novalidate name="unitForm" [formGroup]="unitForm">
    <!-- <div class="row mr-b15">
        <div class="col-xl-5 col-lg-5 col-sm-5">
            <dropdown-field [placeholder]="'Select Unit Group'" [required]="true"> </dropdown-field>
        </div>
    </div> -->
    <div class="row mr-b15">
        <div class="col-xl-5 col-lg-5 col-sm-5">
            <dropdown-field
                [label]="'Unit Name'"
                [placeholder]="'Select Unit Name'"
                [name]="'unitName'"
                [options]="unitList"
                (selectedOption)="selectedUnit($event)"
                [defaultValue]="unitForm.get('name')?.value"
                [showError]="!isValidForm && !unitForm?.get('name')?.value"
                [allowCustomDropdownValue]="true"
                [noResultsFoundMessage]="'Type to create custom unit'"
            >
            </dropdown-field>
        </div>
        <div class="col-xl-7 col-lg-7 col-sm-7">
            <input-field
                [name]="'code'"
                [type]="'text'"
                [label]="'Code'"
                [placeholder]="'Enter Code'"
                formControlName="code"
                [showError]="!isValidForm && !unitForm?.get('code')?.value"
            >
            </input-field>
        </div>
    </div>
    <!-- section-repeat -->
    <div class="unit-quantity" formArrayName="mappings">
        <div
            class="row mr-b15"
            *ngFor="let mapping of unitForm?.get('mappings')['controls']; let i = index"
            [formGroupName]="i"
        >
            <div class="col-xl-5 col-lg-5 col-md-5 col-sm-6 unit-equal">
                <dropdown-field
                    [name]="'xcode' + i"
                    [label]="'Parent Unit'"
                    [placeholder]="'Choose a Parent Unit'"
                    [options]="unitList"
                    (selectedOption)="
                        mapping?.get('stockUnitX')?.get('name').patchValue($event.label);
                        mapping?.get('stockUnitX')?.get('code').patchValue($event.value)
                    "
                    [defaultValue]="mapping?.get('stockUnitX')?.get('name')?.value"
                    [showError]="!isValidFormMappings && !mapping?.get('stockUnitX')?.get('code')?.value"
                >
                </dropdown-field>
                <span class="equal-sign">=</span>
            </div>
            <div class="col-xl-3 col-lg-3 col-md-3 col-sm-2 pr-0 unit-responsive">
                <input-field
                    [cssClass]="'text-right'"
                    [name]="'quantity' + i"
                    [type]="'text'"
                    [label]="'Quantity'"
                    [placeholder]="'Enter Quanitity'"
                    formControlName="quantity"
                    [showError]="!isValidFormMappings && !mapping?.get('quantity')?.value"
                >
                </input-field>
            </div>
            <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 pl-2">
                <dropdown-field
                    [name]="'ycode' + i"
                    [label]="'Parent Unit'"
                    [placeholder]="'Choose a Parent Unit'"
                    [options]="unitList"
                    (selectedOption)="
                        mapping?.get('stockUnitY')?.get('name').patchValue($event.label);
                        mapping?.get('stockUnitY')?.get('code').patchValue($event.value)
                    "
                    [defaultValue]="mapping?.get('stockUnitY')?.get('name')?.value"
                    [showError]="!isValidFormMappings && !mapping?.get('stockUnitY')?.get('code')?.value"
                >
                </dropdown-field>
            </div>
            <div class="col-xl-1 col-lg-1 col-md-2 col-sm-12 pl-0">
                <div class="inc-dec">
                    <div class="plus-minus">
                        <button
                            class="btn mr-0"
                            (click)="addNewMappedUnit()"
                            *ngIf="unitForm?.get('mappings')['controls']?.length - 1 === i"
                        >
                            <i class="icon-plus add-row"></i>
                        </button>
                        <button
                            class="btn mr-0"
                            *ngIf="unitForm?.get('mappings')['controls']?.length > 1"
                            (click)="removeMappedUnit(i)"
                        >
                            <i class="icon-cross delete"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row mt-4">
        <div class="col-sm-12">
            <button mat-stroked-button color="primary" type="button" (click)="saveUnit()">Save</button>
            <button
                mat-stroked-button
                type="button"
                class="btn-sm"
                (click)="resetForm()"
                *ngIf="!unitDetails?.uniqueName"
            >
                Clear
            </button>
            <button
                mat-stroked-button
                type="button"
                class="btn-sm"
                (click)="closeAsideEvent.emit(false)"
                *ngIf="unitDetails?.uniqueName"
            >
                Close
            </button>
        </div>
    </div>
</form>
