<ng-container
    appTranslate
    [file]="'inventory/group'"
    (commonLocaleData)="commonLocaleData = $event"
    (localeData)="localeData = $event"
    (translationComplete)="translationComplete($event)"
>
    <div class="relative">
        <giddh-page-loader *ngIf="showLoader"></giddh-page-loader>
        <ng-container *ngIf="!showLoader">
            <form autocomplete="off" novalidate name="groupForm" [formGroup]="groupForm" class="new-account-form">
                <div class="container-fluid">
                    <div class="create-group-page">
                        <div class="row">
                            <div class="col-xl-6 col-lg-6 col-md-6">
                                <div class="row mr-b15">
                                    <div class="col-sm-6 col-lg-4">
                                        <label>Group Name <span class="red-text">*</span></label>
                                    </div>
                                    <div class="col-sm-6 col-lg-6 ml-lg-2">
                                        <text-field
                                            [cssClass]="'form-control mat-field-border'"
                                            [name]="'productName'"
                                            [placeholder]="'Enter Group Name'"
                                            [type]="'text'"
                                            formControlName="name"
                                            [required]="true"
                                            (change)="!groupUniqueName ? generateUniqueName() : ''"
                                        >
                                        </text-field>
                                    </div>
                                </div>
                                <div class="row mr-b15">
                                    <div class="col-sm-6 col-lg-4">
                                        <label>Unique Name <span class="red-text">*</span></label>
                                    </div>
                                    <div class="col-sm-6 col-lg-6 ml-lg-2">
                                        <text-field
                                            [cssClass]="'form-control  mat-field-border'"
                                            [name]="'uniqueName'"
                                            [placeholder]="'Unique Name'"
                                            formControlName="uniqueName"
                                            [type]="'text'"
                                        >
                                        </text-field>
                                    </div>
                                </div>

                                <div class="row mr-b15">
                                    <div class="col-sm-6 col-lg-4">
                                        <mat-radio-group
                                            color="primary"
                                            name="groupForm.showCodeType"
                                            formControlName="showCodeType"
                                            (change)="onChangeHsnSacType()"
                                        >
                                            <mat-radio-button id="hsn" [value]="'hsn'">HSN Code</mat-radio-button>
                                            <mat-radio-button id="sac" [value]="'sac'">SAC Code</mat-radio-button>
                                        </mat-radio-group>
                                    </div>
                                    <div class="col-sm-6 col-lg-6 ml-lg-2">
                                        <div
                                            class="hsnsac-field"
                                            *ngIf="groupForm.get('showCodeType')?.value === 'hsn'"
                                        >
                                            <text-field
                                                [cssClass]="'form-control  mat-field-border '"
                                                [name]="'hsnCode'"
                                                [placeholder]="'Enter HSN Code'"
                                                [type]="'number'"
                                                formControlName="hsnNumber"
                                                [max]="10"
                                                [allowDecimalDigitsOnly]="true"
                                            >
                                            </text-field>
                                        </div>
                                        <div
                                            class="hsnsac-field"
                                            *ngIf="groupForm.get('showCodeType')?.value === 'sac'"
                                        >
                                            <text-field
                                                [cssClass]="'form-control  mat-field-border'"
                                                [name]="'sacCode'"
                                                [placeholder]="'Enter SAC Code'"
                                                [type]="'number'"
                                                formControlName="sacNumber"
                                                [max]="10"
                                                [allowDecimalDigitsOnly]="true"
                                            >
                                            </text-field>
                                        </div>
                                    </div>
                                </div>

                                <div class="row mr-t15">
                                    <div class="col-sm-6 col-lg-4">
                                        <label>Is it a sub group?:</label>
                                    </div>
                                    <div class="col-sm-6 col-lg-6 ml-lg-2">
                                        <mat-slide-toggle
                                            color="primary"
                                            name="isSubGroup"
                                            formControlName="isSubGroup"
                                        >
                                            <span class="pull-left">{{
                                                groupForm.get("isSubGroup").value ? "On" : "Off"
                                            }}</span>
                                        </mat-slide-toggle>
                                    </div>
                                </div>
                                <div class="row mr-t15">
                                    <div class="col-sm-6 col-lg-4">
                                        <label>Parent Group</label>
                                    </div>
                                    <div class="col-sm-6 col-lg-6 ml-lg-2">
                                        <select-field
                                            [cssClass]="'form-control  mat-field-border'"
                                            [readonly]="!groupForm.get('isSubGroup')?.value"
                                            [name]="'parentStockGroupUniqueName'"
                                            [placeholder]="'Select Group'"
                                            [options]="stockGroups"
                                            (selectedOption)="
                                                stockGroupUniqueName = $event?.value; stockGroupName = $event.label
                                            "
                                            [defaultValue]="stockGroupName"
                                        ></select-field>
                                    </div>
                                </div>
                                <div class="row mr-t15">
                                    <div class="col-sm-6 col-lg-4">
                                        <label>Tax</label>
                                    </div>
                                    <div class="col-sm-6 col-lg-6 ml-lg-2">
                                        <mat-select
                                            name="taxes"
                                            class="form-control"
                                            placeholder="Select Tax"
                                            formControlName="taxes"
                                            multiple
                                        >
                                            <mat-option
                                                *ngFor="let tax of taxes"
                                                [value]="tax?.uniqueName"
                                                [disabled]="tax.isDisabled"
                                                [selected]="tax.isChecked"
                                                (onSelectionChange)="!tax.isDisabled ? selectTax(tax) : ''"
                                                >{{ tax.name }}</mat-option
                                            >
                                            <mat-option class="create-update-no-data" *ngIf="!taxes?.length"
                                                >No Tax Found</mat-option
                                            >
                                        </mat-select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-6 col-lg-6 col-md-6">
                                <div class="image-group relative">
                                    <div class="group-vector">
                                        <img src="{{ imgPath }}create-group-vector.svg" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="create-group-footer sticky-footer">
                    <div class="footer-wrapper">
                        <div class="button-group">
                            <button
                                *ngIf="!groupUniqueName"
                                mat-flat-button
                                class="clear-btn"
                                (click)="resetGroupForm()"
                            >
                                Clear
                            </button>

                            <button
                                *ngIf="groupUniqueName"
                                mat-raised-button
                                class="btn-primary min-width-100"
                                (click)="cancelEdit()"
                            >
                                Cancel
                            </button>
                            <button
                                *ngIf="groupUniqueName"
                                mat-raised-button
                                class="delete-button min-width-100"
                                (click)="deleteGroup()"
                            >
                                Delete
                            </button>
                            <button
                                mat-flat-button
                                class="create-inventory-btn"
                                [disabled]="groupForm.invalid"
                                (click)="saveGroup()"
                            >
                                {{ groupUniqueName ? "Update Group" : "Create Group" }}
                            </button>
                        </div>
                    </div>
                </div>
            </form>
        </ng-container>
    </div>
</ng-container>
