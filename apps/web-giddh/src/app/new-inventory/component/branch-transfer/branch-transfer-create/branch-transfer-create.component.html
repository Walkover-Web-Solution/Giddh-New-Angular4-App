<ng-container
    appTranslate
    [file]="'inventory/stock'"
    (commonLocaleData)="commonLocaleData = $event"
    (localeData)="localeData = $event"
    ><section id="branch-transfer-create">
        <div class="branch-transfer-header">
            <h2>{{ branchTransferMode === "receipt-note" ? "Receipt Note" : "Delivery Challan" }}</h2>
        </div>
        <div class="branch-transfer-body">
            <div class="branch-transfer-body-radio-btns" *ngIf="!editBranchTransferUniqueName">
                <mat-radio-group name="products_sender" [(ngModel)]="transferType">
                    <mat-radio-button color="primary" value="products" (click)="changeTransferType()"
                        >Multiple Products</mat-radio-button
                    >
                    <mat-radio-button
                        color="primary"
                        value="senders"
                        (click)="changeTransferType()"
                        *ngIf="branchTransferMode === 'receipt-note'"
                        >Multiple Senders</mat-radio-button
                    >
                    <mat-radio-button
                        (click)="changeTransferType()"
                        color="primary"
                        value="senders"
                        *ngIf="branchTransferMode === 'delivery-challan'"
                        >Multiple Receivers</mat-radio-button
                    >
                </mat-radio-group>
            </div>

            <div class="branch-transfer-body-multiple-wrapper">
                <form
                    autocomplete="off"
                    novalidate
                    name="branchTransferCreateEditForm"
                    [formGroup]="branchTransferCreateEditForm"
                >
                    <div class="row clearfix primary-form-wrapper row-gap">
                        <div class="col-lg-8 px-0">
                            <div class="row">
                                <div class="col-lg-6 mr-b15">
                                    <div class="direct-mat-datepicker">
                                        <giddh-datepicker
                                            (dateSelected)="selectDate($event, 'dateOfSupply')"
                                            [readonly]="!editBranchTransferUniqueName"
                                            [disabled]="editBranchTransferUniqueName ? 'disabled' : null"
                                            formControlName="dateOfSupply"
                                            name="date"
                                            [cssClass]="'w-100'"
                                            [showToggleIcon]="false"
                                            [appearance]="'outline'"
                                            [placeholder]="
                                                branchTransferMode === 'receipt-note'
                                                    ? 'Date of Receipt'
                                                    : 'Date of Supply'
                                            "
                                        >
                                        </giddh-datepicker>
                                    </div>
                                </div>
                            </div>
                            <div class="row row-gap">
                                <div class="col-lg-6">
                                    <div *ngIf="transferType === 'senders'">
                                        <div *ngIf="branchTransferMode === 'delivery-challan'">
                                            <dropdown-field
                                                (createOption)="onProductNoResultsClicked(0)"
                                                [showCreateNew]="true"
                                                [name]="'productName'"
                                                [label]="'Product\'s Name'"
                                                [placeholder]="'Select Product\'s Name'"
                                                [options]="stockList"
                                                [appearance]="'outline'"
                                                (selectedOption)="
                                                    selectProduct(
                                                        $event,
                                                        branchTransferCreateEditForm.get('products.0')?.value
                                                    )
                                                "
                                                [allowValueReset]="true"
                                            >
                                            </dropdown-field>
                                        </div>
                                        <div *ngIf="branchTransferMode === 'receipt-note'">
                                            <dropdown-field
                                                (createOption)="onProductNoResultsClicked(0)"
                                                [showCreateNew]="true"
                                                [name]="'productName'"
                                                [label]="'Product\'s Name'"
                                                [placeholder]="'Select Product\'s Name'"
                                                [options]="stockList"
                                                [appearance]="'outline'"
                                                (selectedOption)="
                                                    selectProduct(
                                                        $event,
                                                        branchTransferCreateEditForm.get('products.0')?.value
                                                    );
                                                    focusDestinationWarehouse()
                                                "
                                                [allowValueReset]="true"
                                            >
                                            </dropdown-field>
                                        </div>
                                        <div formArrayName="products">
                                            <div [formGroupName]="0">
                                                <div class="mr-b15 mr-t15">
                                                    <input-field
                                                        [type]="'text'"
                                                        [name]="'skuCode'"
                                                        [label]="'SKU Code'"
                                                        [appearance]="'outline'"
                                                        formControlName="skuCode"
                                                    >
                                                    </input-field>
                                                </div>
                                                <div class="branch-transfer-body-radio-btns">
                                                    <mat-radio-group
                                                        name="products_sender"
                                                        formControlName="showCodeType "
                                                    >
                                                        <mat-radio-button color="primary" value="hsn"
                                                            >HSN Code</mat-radio-button
                                                        >
                                                        <mat-radio-button color="primary" value="sac"
                                                            >SAC Code</mat-radio-button
                                                        >
                                                    </mat-radio-group>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div *ngIf="transferType === 'products'">
                                        <div *ngIf="branchTransferMode === 'delivery-challan'" class="position-relative info-field">
                                            <input-field
                                                *ngIf="(isBranch || isCompanyWithSingleBranch) && !isUpdateMode"
                                                [name]="'sourceName'"
                                                formControlName="myCurrentCompany"
                                                [placeholder]=""
                                                [type]="'text'"
                                                [readonly]="isBranch || isCompanyWithSingleBranch"
                                            >
                                            </input-field>
                                            <dropdown-field
                                                *ngIf="isUpdateMode"
                                                [name]="'senderName'"
                                                [label]="'Sender\'s Name'"
                                                [placeholder]="'Select Sender\'s Name'"
                                                [options]="branches"
                                                (selectedOption)="
                                                    selectSenderName($event, 0); focusSourceWarehouse($event)
                                                "
                                                [readonly]="isUpdateMode"
                                            >
                                            </dropdown-field>
                                            <i
                                                *ngIf="
                                                    destinationWarehouses[
                                                        branchTransferCreateEditForm.get('sources.0.uniqueName')?.value
                                                    ]?.length !==
                                                    allWarehouses[
                                                        branchTransferCreateEditForm.get('sources.0.uniqueName')?.value
                                                    ]?.length
                                                "
                                                class="icon-info"
                                                matTooltip="{{ branchTransferInfoText }}"
                                            >
                                            </i>
                                        </div>
                                        <div *ngIf="branchTransferMode === 'receipt-note'" class="mr-b15 position-relative info-field">
                                            <dropdown-field
                                                #defaultSource
                                                [name]="'senderName'"
                                                [label]="'Sender\'s Name'"
                                                [placeholder]="'Select Sender\'s Name'"
                                                [options]="branches"
                                                (selectedOption)="
                                                    selectSenderName($event, 0); focusSourceWarehouse($event)
                                                "
                                                [readonly]="isUpdateMode"
                                            >
                                            </dropdown-field>
                                            <i
                                                *ngIf="
                                                    destinationWarehouses[
                                                        branchTransferCreateEditForm.get('sources.0.uniqueName')?.value
                                                    ]?.length !==
                                                    allWarehouses[
                                                        branchTransferCreateEditForm.get('sources.0.uniqueName')?.value
                                                    ]?.length
                                                "
                                                class="icon-info"
                                                matTooltip="{{ branchTransferInfoText }}"
                                            >
                                            </i>
                                        </div>
                                        <div *ngIf="editBranchTransferUniqueName" class="mr-b15 mr-t15">
                                            <input-field
                                                [name]="'name'"
                                                [label]="'Sender\'s Warehouse'"
                                                [placeholder]="'Select Sender\'s Warehouse'"
                                                [type]="'text'"
                                            >
                                            </input-field>
                                        </div>
                                    </div>
                                    <div *ngIf="transferType === 'products'" formArrayName="sources">
                                        <div [formGroupName]="0">
                                            <div class="mr-b15">
                                                <dropdown-field
                                                    [name]="'senderWarehouse'"
                                                    [label]="'Sender\'s Warehouse'"
                                                    [placeholder]="'Select Sender\'s Warehouse'"
                                                    (selectedOption)="selectSenderWarehouse($event, 0)"
                                                    [options]="
                                                        senderWarehouses[
                                                            branchTransferCreateEditForm.get('sources.0.uniqueName')
                                                                ?.value
                                                        ]
                                                    "
                                                    [defaultValue]="
                                                        branchTransferCreateEditForm.get('sources.0.warehouse.name')
                                                            .value
                                                    "
                                                    [allowValueReset]="true"
                                                    (onClear)="resetWarehouse('sources', 0)"
                                                >
                                                </dropdown-field>
                                            </div>
                                            <div formGroupName="warehouse">
                                                <div
                                                    class="mr-b15"
                                                    *ngIf="
                                                        branchTransferCreateEditForm.get(
                                                            'sources.0.warehouse.taxNumber'
                                                        )?.value &&
                                                        branchTransferCreateEditForm.get(
                                                            'sources.0.warehouse.uniqueName'
                                                        )?.value &&
                                                        formFields &&
                                                        formFields['taxName']
                                                    "
                                                >
                                                    <input-field
                                                        [name]="'gstin'"
                                                        [placeholder]="getEnterTaxText()"
                                                        [type]="'text'"
                                                        formControlName="taxNumber"
                                                        [label]="'Sender\'s ' + formFields['taxName']?.label + '*'"
                                                        [maxlength]="15"
                                                        (change)="checkTaxNumberValidation()"
                                                        [readonly]="
                                                            branchTransferCreateEditForm.get(
                                                                'sources.0.warehouse.uniqueName'
                                                            )?.value
                                                        "
                                                    >
                                                    </input-field>
                                                </div>
                                                <div class="mr-b15">
                                                    <mat-form-field appearance="outline" class="w-100">
                                                        <mat-label>Sender's Address</mat-label>
                                                        <textarea
                                                            matInput
                                                            rows="3"
                                                            class="form-control"
                                                            rows="3"
                                                            name="sourceAddress"
                                                            formControlName="address"
                                                            [readonly]="
                                                                branchTransferCreateEditForm.get(
                                                                    'sources.0.warehouse.uniqueName'
                                                                )?.value
                                                            "
                                                        ></textarea>
                                                    </mat-form-field>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div *ngIf="branchTransferMode === 'receipt-note'">
                                        <input-field
                                            *ngIf="(isBranch || isCompanyWithSingleBranch) && !isUpdateMode"
                                            [name]="'myCurrentCompany'"
                                            formControlName="myCurrentCompany"
                                            [type]="'text'"
                                            [placeholder]="'Receiver\'s Name'"
                                            [readonly]="isBranch || isCompanyWithSingleBranch"
                                        >
                                        </input-field>
                                    </div>
                                    <div formArrayName="destinations">
                                        <div [formGroupName]="0">
                                            <div *ngIf="branchTransferMode === 'delivery-challan'">
                                                <div class="mr-b15 position-relative info-field">
                                                    <dropdown-field
                                                        [name]="'receiverName'"
                                                        [label]="'Receiver\'s Name'"
                                                        [placeholder]="'Select Receiver\'s Name'"
                                                        [options]="branches"
                                                        (selectedOption)="selectRecieverName($event)"
                                                        [readonly]="isUpdateMode"
                                                    >
                                                    </dropdown-field>
                                                    <i
                                                        *ngIf="
                                                            destinationWarehouses[
                                                                branchTransferCreateEditForm.get(
                                                                    'destinations.0.uniqueName'
                                                                )?.value
                                                            ]?.length !==
                                                            allWarehouses[
                                                                branchTransferCreateEditForm.get(
                                                                    'destinations.0.uniqueName'
                                                                )?.value
                                                            ]?.length
                                                        "
                                                        class="icon-info"
                                                        matTooltip="{{ branchTransferInfoText }}"
                                                    >
                                                    </i>
                                                </div>
                                            </div>
                                            <div *ngIf="branchTransferMode === 'receipt-note'">
                                                <div class="mr-b15 info-field">
                                                    <dropdown-field
                                                        *ngIf="isUpdateMode"
                                                        [name]="'receiverName'"
                                                        [label]="'Receiver\'s Name'"
                                                        [placeholder]="'Select Receiver\'s Name'"
                                                        [options]="branches"
                                                        (selectedOption)="selectRecieverName($event)"
                                                        [readonly]="isUpdateMode"
                                                    >
                                                    </dropdown-field>
                                                    <i
                                                        *ngIf="
                                                            destinationWarehouses[
                                                                branchTransferCreateEditForm.get(
                                                                    'destinations.0.uniqueName'
                                                                )?.value
                                                            ]?.length !==
                                                            allWarehouses[
                                                                branchTransferCreateEditForm.get(
                                                                    'destinations.0.uniqueName'
                                                                )?.value
                                                            ]?.length
                                                        "
                                                        class="icon-info"
                                                        matTooltip="{{ branchTransferInfoText }}"
                                                    >
                                                    </i>
                                                </div>
                                            </div>
                                            <div class="mr-b15">
                                                <dropdown-field
                                                    #destinationWarehouse
                                                    [name]="'receiverWarehouse'"
                                                    [label]="'Receiver\'s Warehouse'"
                                                    [placeholder]="'Select Receiver\'s Warehouse'"
                                                    [options]="
                                                        destinationWarehouses[
                                                            branchTransferCreateEditForm.get(
                                                                'destinations.0.uniqueName'
                                                            )?.value
                                                        ]
                                                    "
                                                    (selectedOption)="selectReceiverWarehouse($event)"
                                                    [allowValueReset]="true"
                                                    (onClear)="resetWarehouse('destinations', 0)"
                                                >
                                                </dropdown-field>
                                            </div>
                                            <div formGroupName="warehouse">
                                                <div
                                                    class="mr-b15"
                                                    *ngIf="
                                                        branchTransferCreateEditForm.get(
                                                            'destinations.0.warehouse.taxNumber'
                                                        )?.value &&
                                                        branchTransferCreateEditForm.get(
                                                            'destinations.0.warehouse.uniqueName'
                                                        )?.value
                                                    "
                                                >
                                                    <input-field
                                                        [name]="'gstin'"
                                                        [placeholder]="getEnterTaxText()"
                                                        [type]="'text'"
                                                        formControlName="taxNumber"
                                                        [label]="'Receiver\'s ' + formFields['taxName']?.label + '*'"
                                                        [maxlength]="15"
                                                        (change)="checkTaxNumberValidation()"
                                                        [readonly]="
                                                            branchTransferCreateEditForm.get(
                                                                'destinations.0.warehouse.uniqueName'
                                                            )?.value
                                                        "
                                                    >
                                                    </input-field>
                                                </div>
                                                <div class="mr-b15">
                                                    <mat-form-field appearance="outline" class="w-100">
                                                        <mat-label>Receiver's Address</mat-label>
                                                        <textarea
                                                            matInput
                                                            rows="3"
                                                            class="form-control"
                                                            rows="3"
                                                            name="sourceAddress"
                                                            formControlName="address"
                                                            [readonly]="
                                                                branchTransferCreateEditForm.get(
                                                                    'destinations.0.warehouse.uniqueName'
                                                                )?.value
                                                            "
                                                        ></textarea>
                                                    </mat-form-field>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-4">
                            <div class="total-amount text-right">
                                <p>Total Amount</p>
                                <h3>{{ activeCompany?.baseCurrencySymbol }} {{ overallTotal | giddhCurrency }}</h3>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-1">
                        <div class="col-xl-8 col-lg-10 col-sm-12 mb-2">
                            <table id="table-receipt">
                                <thead *ngIf="transferType === 'products'">
                                    <tr>
                                        <th width="2%">#</th>
                                        <th width="30%">Product Description</th>
                                        <th width="20%">Qty/Unit</th>
                                        <th width="20%">Rate</th>
                                        <th width="20%">Amount</th>
                                    </tr>
                                </thead>
                                <thead *ngIf="transferType !== 'products'">
                                    <tr>
                                        <th width="2%">#</th>
                                        <th width="30%" *ngIf="branchTransferMode === 'delivery-challan'">Receiver’s Details</th>
                                        <th width="30%" *ngIf="branchTransferMode === 'receipt-note'">Sender’s Details</th>
                                        <th width="20%">Qty/Unit</th>
                                        <th width="20%">Rate</th>
                                        <th width="20%">Amount</th>
                                    </tr>
                                </thead>

                                <tbody
                                    *ngIf="transferType !== 'products' && branchTransferMode === 'receipt-note'"
                                    (clickOutside)="hideActiveRow()"
                                >
                                    <h3>transferType !== 'products' && branchTransferMode === 'receipt-note'</h3>
                                    <ng-container formArrayName="sources">
                                        <tr
                                            *ngFor="
                                                let source of branchTransferCreateEditForm.get('sources')['controls'];
                                                let i = index
                                            "
                                            (click)="setActiveRow(i); $event.stopPropagation()"
                                        >
                                            <ng-container [formGroupName]="i">
                                                <td class="id">
                                                    <div>
                                                        <div>{{ i + 1 }}</div>
                                                    </div>
                                                </td>
                                                <td class="name">
                                                    <span class="w-100">
                                                        <span formGroupName="warehouse" class="w-100">
                                                            <div
                                                                *ngIf="activeIndx === i"
                                                                class="position-relative mb-3 w-100"
                                                            >
                                                                <select-field
                                                                    [cssClass]="'form-control mat-field-border pb-0'"
                                                                    [name]="'senderName{{i}}'"
                                                                    [placeholder]="'Sender\'s Name'"
                                                                    [options]="branches"
                                                                    (selectedOption)="
                                                                        selectSenderName($event, i);
                                                                        focusSourceWarehouse($event)
                                                                    "
                                                                    [defautlValue]="source.get('uniqueName').value"
                                                                >
                                                                </select-field>
                                                                <select-field
                                                                    [cssClass]="'form-control mat-field-border pb-0'"
                                                                    name="sourceWarehouse{{ i }}"
                                                                    [placeholder]="'Sender\'s Warehouse'"
                                                                    (selectedOption)="selectSenderWarehouse($event, i)"
                                                                    [options]="
                                                                        senderWarehouses[source.get('uniqueName').value]
                                                                    "
                                                                    [defaultValue]="source.get('warehouse.name').value"
                                                                    *ngIf="source.get('uniqueName').value"
                                                                    [allowValueReset]="true"
                                                                    (onClear)="resetWarehouse('sources', i)"
                                                                    class="mr-t15 d-block"
                                                                >
                                                                </select-field>
                                                                <text-field
                                                                    *ngIf="
                                                                        formFields &&
                                                                        formFields['taxName'] &&
                                                                        source.get('warehouse.uniqueName').value &&
                                                                        source.get('warehouse.taxNumber').value
                                                                    "
                                                                    name="sourceWarehouseTaxnumber{{ i }}"
                                                                    [placeholder]="getEnterTaxText()"
                                                                    [type]="'text'"
                                                                    [label]="
                                                                        'Sender\'s ' +
                                                                        formFields['taxName']?.label +
                                                                        '*'
                                                                    "
                                                                    [maxlength]="15"
                                                                    (change)="checkTaxNumberValidation()"
                                                                    [readonly]="
                                                                        source.get('warehouse.uniqueName').value
                                                                    "
                                                                    formControlName="taxNumber"
                                                                >
                                                                </text-field>

                                                                <div class="position-relative pb-3">
                                                                    <div class="py-3">
                                                                        <textarea
                                                                            matInput
                                                                            rows="3"
                                                                            class="form-control"
                                                                            rows="3"
                                                                            name="sourceWarehouseAddress{{ i }}"
                                                                            formControlName="address"
                                                                            [readonly]="
                                                                                source.get('warehouse.uniqueName').value
                                                                            "
                                                                            *ngIf="
                                                                                source.get('warehouse.uniqueName').value
                                                                            "
                                                                        ></textarea>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div *ngIf="activeIndx !== i">
                                                                <div *ngIf="source.get('name').value">
                                                                    {{ source.get("name").value }}
                                                                </div>
                                                                <div *ngIf="source.get('warehouse.name').value">
                                                                    {{ source.get("warehouse.name").value }}
                                                                </div>
                                                                <div *ngIf="source.get('warehouse.taxNumber').value">
                                                                    {{ source.get("warehouse.taxNumber").value }}
                                                                </div>
                                                                <div *ngIf="source.get('warehouse.address').value">
                                                                    {{ source.get("warehouse.address").value }}
                                                                </div>
                                                                <div
                                                                    *ngIf="
                                                                        !source.get('name').value &&
                                                                        !source.get('warehouse.name').value &&
                                                                        !source.get('warehouse.taxNumber').value &&
                                                                        !source.get('warehouse.address').value
                                                                    "
                                                                    class="placeholder-for-table"
                                                                >
                                                                    Enter sender's details
                                                                </div>
                                                            </div>
                                                        </span>
                                                    </span>
                                                </td>
                                                <ng-container formGroupName="warehouse">
                                                    <ng-container formGroupName="stockDetails">
                                                        <td class="qtyUnit">
                                                            <div *ngIf="activeIndx === i" class="w-100">
                                                                <text-field
                                                                    [cssClass]="'form-control mat-field-border'"
                                                                    [type]="'number'"
                                                                    name="sourceQty{{ i }}"
                                                                    [placeholder]="'Enter Qty/Unit'"
                                                                    [allowDecimalDigitsOnly]="true"
                                                                    (change)="
                                                                        calculateRowTotal(
                                                                            source.get('warehouse').value,
                                                                            i
                                                                        )
                                                                    "
                                                                    formControlName="quantity"
                                                                >
                                                                </text-field>
                                                            </div>
                                                            <div *ngIf="activeIndx !== i">
                                                                <div class="text-right">
                                                                    {{
                                                                        source.get("warehouse.stockDetails.quantity")
                                                                            .value
                                                                    }}
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td class="rate">
                                                            <div>
                                                                <div *ngIf="activeIndx !== i">
                                                                    <div class="text-right">
                                                                        {{ activeCompany?.baseCurrencySymbol }}
                                                                        {{
                                                                            source.get("warehouse.stockDetails.rate")
                                                                                .value | giddhCurrency
                                                                        }}
                                                                    </div>
                                                                </div>
                                                                <div *ngIf="activeIndx === i" class="w-100">
                                                                    <text-field
                                                                        [cssClass]="
                                                                            'form-control mat-field-border  text-right'
                                                                        "
                                                                        [type]="'text'"
                                                                        name="sourceRate{{ i }}"
                                                                        [placeholder]="'Enter Rate'"
                                                                        formControlName="rate"
                                                                        [allowDecimalDigitsOnly]="true"
                                                                        [customDecimalPlaces]="2"
                                                                        (change)="
                                                                            calculateRowTotal(
                                                                                source.get('warehouse').value,
                                                                                i
                                                                            )
                                                                        "
                                                                        [prefix]="activeCompany?.baseCurrencySymbol"
                                                                        [mask]="inputMaskFormat"
                                                                        [useMask]="true"
                                                                    >
                                                                    </text-field>
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td class="amount">
                                                            <div *ngIf="activeIndx !== i">
                                                                <div class="text-right">
                                                                    {{ activeCompany?.baseCurrencySymbol }}
                                                                    {{
                                                                        source.get("warehouse.stockDetails.rate").amount
                                                                            | giddhCurrency
                                                                    }}
                                                                </div>
                                                            </div>
                                                            <div *ngIf="activeIndx === i" class="w-100">
                                                                <text-field
                                                                    [cssClass]="
                                                                        'form-control mat-field-border  text-right'
                                                                    "
                                                                    [type]="'text'"
                                                                    name="sourceAmount{{ i }}"
                                                                    [placeholder]="'Enter Amount'"
                                                                    formControlName="amount"
                                                                    [allowDecimalDigitsOnly]="true"
                                                                    [customDecimalPlaces]="2"
                                                                    [prefix]="activeCompany?.baseCurrencySymbol"
                                                                    [mask]="inputMaskFormat"
                                                                    [useMask]="true"
                                                                    [readonly]="true"
                                                                >
                                                                </text-field>
                                                            </div>
                                                            <span class="position-relative">
                                                                <span
                                                                    class="delete-btn-position d-flex"
                                                                    *ngIf="
                                                                        branchTransferCreateEditForm.get('sources')
                                                                            .value.length > 1
                                                                    "
                                                                >
                                                                    <span class="delete-icon"
                                                                        ><i
                                                                            class="fa fa-trash"
                                                                            (click)="removeSenderDetailsForm(i)"
                                                                        ></i
                                                                    ></span>
                                                                    <i
                                                                        *ngIf="
                                                                            senderWarehouses[
                                                                                source.get('uniqueName').value
                                                                            ]?.length !==
                                                                            allWarehouses[
                                                                                source.get('uniqueName').value
                                                                            ]?.length
                                                                        "
                                                                        matTooltip="{{ branchTransferInfoText }}"
                                                                        matTooltipPosition="above"
                                                                        class="icon-info"
                                                                    ></i>
                                                                </span>
                                                            </span>
                                                        </td>
                                                    </ng-container>
                                                </ng-container>
                                            </ng-container>
                                        </tr>
                                    </ng-container>
                                </tbody>
                                <tfoot>
                                    <tr>
                                        <td colspan="4" class="pl-0">
                                            <div class="add-new-line mr-t1">
                                                <a
                                                    class="multiple-receivers btn-link cp"
                                                    (click)="addReceiver()"
                                                    *ngIf="
                                                        transferType !== 'products' &&
                                                        branchTransferMode === 'delivery-challan'
                                                    "
                                                >
                                                    + Add Multiple Receivers</a
                                                >
                                                <a
                                                    *ngIf="
                                                        transferType !== 'products' &&
                                                        branchTransferMode === 'receipt-note'
                                                    "
                                                    class="multiple-receivers btn-link cp"
                                                    (click)="addSender()"
                                                >
                                                    + Add Multiple Senders</a
                                                >

                                                <a
                                                    class="multiple-receivers btn-link cp"
                                                    (click)="addBlankProductsForm()"
                                                    *ngIf="transferType === 'products'"
                                                >
                                                    <i class="icon-plus"></i> Add Multiple Products</a
                                                >
                                            </div>
                                        </td>
                                        <td>
                                            <div class="row text-right">
                                                <div class="col px-0"><strong>Total</strong></div>
                                                <div class="col px-0">
                                                    {{ activeCompany?.baseCurrencySymbol }}
                                                    {{ overallTotal | giddhCurrency }}
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xl-8 col-lg-10 col-sm-12">
                            <div>
                                <h3 class="mr-b1">Transportation Details</h3>
                                <div class="row row-gap" formGroupName="transporterDetails">
                                    <div class="col-sm-6 pl-0 mr-b15">
                                        <div class="direct-mat-datepicker">
                                            <giddh-datepicker
                                                (dateSelected)="selectDate($event, 'dispatchedDate')"
                                                [minDate]="tempDateParams.dateOfSupply"
                                                formControlName="dispatchedDate"
                                                name="date"
                                                [cssClass]="'w-100'"
                                                [showToggleIcon]="false"
                                                [appearance]="'outline'"
                                                [placeholder]="'Dispatched Date'"
                                            >
                                            </giddh-datepicker>
                                        </div>
                                    </div>
                                    <div class="col-sm-6 pr-0 mr-b15">
                                        <dropdown-field
                                            (createOption)="toggleTransporterModel()"
                                            [showCreateNew]="true"
                                            [name]="''"
                                            [placeholder]="'Transport Company'"
                                            [options]="transporterDropdown"
                                            [appearance]="'outline'"
                                            (onClear)="onClearTransportNameId($event)"
                                            (selectedOption)="onSelectTransportCompany($event)"
                                            [allowValueReset]="true"
                                        >
                                        </dropdown-field>
                                    </div>
                                    <div class="col-sm-6 pl-0 mr-b15">
                                        <dropdown-field
                                            [name]="''"
                                            [placeholder]="'Transport Mode'"
                                            [options]="transporterMode"
                                            [appearance]="'outline'"
                                            (onClear)="onClearTransportNameId($event)"
                                            (selectedOption)="onSelectTransportMode($event)"
                                            [allowValueReset]="true"
                                        >
                                        </dropdown-field>
                                    </div>
                                    <div class="col-sm-6 pr-0 mr-b15">
                                        <input-field
                                            [type]="'text'"
                                            [name]="''"
                                            [placeholder]="'Vehicle Number'"
                                            [appearance]="'outline'"
                                            formControlName="vehicleNumber"
                                        >
                                        </input-field>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xl-8 col-lg-10 col-sm-12 mb-4">
                            <div>
                                <mat-form-field appearance="outline" class="w-100">
                                    <mat-label>Note</mat-label>
                                    <textarea
                                        matInput
                                        rows="3"
                                        placeholder="Write Note Here . . . "
                                        formControlName="note"
                                    ></textarea>
                                </mat-form-field>
                            </div>
                        </div>
                    </div>
                    <div class="row position-bottom">
                        <div class="col-xl-8 col-lg-10 col-sm-12 mb-4">
                            <div class="action-btn-wrapper text-right w-100 d-flex column-gap1 justify-content-end">
                                <button mat-stroked-button mat-dialog-close>Cancel</button>
                                <button
                                    mat-stroked-button
                                    color="primary"
                                    *ngIf="isBranch || isCompanyWithSingleBranch"
                                    class="d-inline-block v-align-middle {{
                                        branchTransferCreateEditForm.invalid
                                    }}-{{ isValidSourceTaxNumber }}-{{ isValidDestinationTaxNumber }}"
                                    (click)="submit()"
                                >
                                    {{ editBranchTransferUniqueName ? "Update" : "Create" }}
                                    <!-- [disabled]="
                                        branchTransferCreateEditForm.invalid ||
                                        !isValidSourceTaxNumber ||
                                        !isValidDestinationTaxNumber ||
                                        isLoading
                                    " -->
                                </button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </section>
</ng-container>

<ng-template #asideMenuProductService>
    <aside-menu-product-service  (closeAsideEvent)="closeAsideMenuProductServiceModal()"></aside-menu-product-service>
</ng-template>
<ng-template #asideManageTransport>
    <aside-manage-transport></aside-manage-transport>
</ng-template>
