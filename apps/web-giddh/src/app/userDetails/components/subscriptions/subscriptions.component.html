<ng-container *ngIf="subscriptions.length && !isLoading">
    <div *ngIf="!isPlanShow">
        <div class="clearfix mrT2">
            <div class="row">
                <div class="col-md-3 col-sm-6">
                    <div class="form-group">
                        <label class="d-block mb-1">Select Subscribed Plan</label>
                        <div class="btn-group d-block subscription-dropdown mb-2" dropdown>
                            <button id="button-basic" dropdownToggle type="button" class="btn dropdown-toggle" aria-controls="dropdown-basic">
                                {{seletedUserPlans?.planDetails?.name}} <span class="caret"></span>
                            </button>
                            <ul id="dropdown-basic" *dropdownMenu class="dropdown-menu" role="menu"
                                aria-labelledby="button-basic">
                                <li *ngIf="subscriptions.length==0">No results found</li>
                                <li *ngFor="let item of subscriptions" role="menuitem" class="cursor-pointer">
                                    <a (click)="selectedSubscriptionPlan(item);">
                                        <div class="clearfix">
                                            <p><strong>{{item?.planDetails?.name}}</strong></p>
                                            <p>Subscribed on {{item?.startedAt}} </p>
                                            <p>Companies: {{item?.totalCompanies}} out of {{item?.planDetails?.companiesLimit}} </p>
                                        </div>
                                        <span class="text-warning" *ngIf="item?.status==='trial'">{{item?.status | titlecase}}</span>
                                        <span class="text-success" *ngIf="item?.status==='active'">{{item?.status | titlecase}}</span>
                                        <span class="text-danger" *ngIf="item?.status==='expired'">{{item?.status | titlecase}}</span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-md-9 col-sm-6 text-right xs-left">
                    <button type="button" *ngIf="seletedUserPlans?.additionalCharges >0" (click)="goToBillingDetails();"
                        class="btn btn-pink mt-2">Pay Now</button>
                    <button type="button" (click)="isPlanShow=true" class="btn btn-green mt-2">Buy New Plan</button>
                </div>
            </div>


            <div class="row">
                <div class="col-md-3">
                    <div class="table-responsive">
                        <table class="table table-no-border mb-0">
                            <tr>
                                <th>Subscription ID</th>
                                <td>{{seletedUserPlans?.subscriptionId}}</td>
                            </tr>
                            <tr>
                                <th> Subscription Price</th>
                                <td>{{seletedUserPlans?.planDetails?.amount | number}}</td>
                            </tr>
                            <tr>
                                <th>Total Companies</th>
                                <td>{{ seletedUserPlans?.totalCompanies | number}} out of
                                    {{ seletedUserPlans?.planDetails?.companiesLimit | number}}</td>
                            </tr>
                            <tr>
                                <th>Transactions Limit</th>
                                <td>{{seletedUserPlans?.planDetails?.transactionLimit | number}}</td>
                            </tr>
                            <tr>
                                <th> Validity</th>
                                <td>{{seletedUserPlans?.planDetails?.duration}}
                                    {{seletedUserPlans?.planDetails?.durationUnit}}</td>
                            </tr>
                        </table>
                    </div>

                    <div class="clearfix mb-2">
                        <button type="button" class="btn btn-primary" (click)="isPlanShow=true">Change Plan</button>
                        <!-- <button type="button" (click)="isPlanShow=true" class="btn btn-pink">Payment Log</button> -->
                    </div>
                </div>
            </div>
        </div>

        <div class="clearfix mrT2 relative">
            <div class="transection-popup mb-1" *ngIf="seletedUserPlans?.additionalCharges >0">
                <p>You have crossed transactions limit of your </p>
                <p><strong>Professional Plan subscribed on {{seletedUserPlans?.startedAt}}!</strong></p>
                <p><small>Please renew your plan or pay now to continue subscription.</small></p>
            </div>

            <h2 class="subscription-title" *ngIf="subscriptions">{{seletedUserPlans?.planDetails?.name}} <span
                    *ngIf="seletedUserPlans?.startedAt">({{seletedUserPlans?.startedAt}})</span></h2>
            <div class="row">
                <div class="col-sm-7 transaction-list">
                    <div class="box clearfix mrT2 no-padding">
                        <div class="table-responsive">
                            <table class="table basic mr0 subscription-table">
                                <thead>
                                    <tr>
                                        <!-- <th>Date</th> <span class="text-light-2">(previous+current)</span>-->
                                        <th>Transactions</th>
                                        <th>Balance</th>
                                        <th>Additional Charges</th>
                                    </tr>
                                </thead>
                                <tbody *ngIf="seletedUserPlans">
                                    <tr>
                                        <!-- <td class="professional-name">{{ moment(transaction.from, 'DD-MM-YYYY').format('MMM - YY')}}</td> -->
                                        <td>{{ seletedUserPlans?.totalTransactions ? seletedUserPlans?.totalTransactions : 0 }}
                                        </td>
                                        <!-- <span class="text-light ml-05">({{transaction.previousTransactionCount}}+{{transaction.currentTransactionCount}})</span> -->
                                        <td>{{ seletedUserPlans?.balance? seletedUserPlans?.balance: 0 }}</td>
                                        <td class="text-danger">
                                            {{ seletedUserPlans?.additionalCharges? seletedUserPlans?.additionalCharges: 0 }}
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="mrT2">
                        <p><small>* Additional charges on transactions above 40,000 @ 0.10 Rs. per transaction</small>
                        </p>
                        <p><small>* Each month includes previous month's transactions</small></p>
                    </div>
                </div>


                <div class="col-sm-5 transaction-list">
                    <div class="box2 clearfix mrT2">
                        <div class="head-title">
                            <h3>Companies Name + Total Transactions (till today)</h3>
                        </div>
                        <div class="clearfix">
                            <div class="mt-1 mb-1 mr-2 ml-2">
                                <input type="search" class="form-control" [(ngModel)]="srchString"
                                    (ngModelChange)="filterCompanyList($event)" placeholder="Search Company here">
                            </div>
                            <div class="campanien-list" *ngIf="subscriptions">
                                <ul>
                                    <li *ngFor="let company of selectedPlanCompanies "><a href="javascript:void(0)">{{company.name}}<span>{{company.transactions}}</span></a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</ng-container>
<div *ngIf="isLoading">
    <div class="no-data mrT2 loader-main">
        <!-- <div class="giddh-spinner vertical-center-spinner"></div> -->
        <div class="spinner2">
            <div class="cube1"></div>
            <div class="cube2"></div>
        </div>
    </div>
</div>



<!-- Modal start -->
<!-- <ng-template #template>
    <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
    <span aria-hidden="true">&times;</span>
  </button>

    <div class="modal-body">
        <div class="modal-list mrB1">
            <ul>
                <li>
                    <h3 class="">Company Name:</h3> {{ modalRef.content.company.name }}
                </li>
                <li>
                    <h3 class="">Plan:</h3> {{ modalRef.content.subscription.plan.planName }} ({{ modalRef.content.subscription.subscribedOn }})
                </li>
                <li>
                    <h3 class="">Status:</h3> <a href="javascript:void(0)" class="text-green">{{ subscriptionStatus[modalRef.content.subscription.status] }}</a>
                </li>
            </ul>
        </div>

        <div class="table-responsive">
            <table class="table basic mr0 ">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Company's Transactions <span class="d-block text-light-2">(previous+current)</span></th>
                        <th>Plan's Transactions<span class="d-block text-light-2">(previous+current)</span></th>
                    </tr>

                    <tr *ngFor="let companyTransaction of companyTransactions">
                        <td>{{ moment(companyTransaction.from, 'DD-MM-YYYY').format('MMM') }}</td>
                        <td>{{ companyTransaction.totalTransactionCount }} ({{companyTransaction.previousTransactionCount}}+{{companyTransaction.currentTransactionCount}})</td>
                        <td>{{ companyTransaction.totalPlanTransactionCount }} ({{companyTransaction.previousPlanTransactionCount}}+{{companyTransaction.currentPlanTransactionCount}})</td>
                    </tr>

                </thead>
            </table>
        </div>

    </div>
</ng-template> -->
<!-- Modal end -->

<!-- <div *ngIf="!isOn">dfadfsasdf</div>

<button label="Results" (click)="isOn= true">Results</button> -->


<subscriptions-plans *ngIf="isPlanShow" [subscriptions]="subscriptions" (isSubscriptionPlanShow)="isSubscriptionPlanShow($event)"></subscriptions-plans>
