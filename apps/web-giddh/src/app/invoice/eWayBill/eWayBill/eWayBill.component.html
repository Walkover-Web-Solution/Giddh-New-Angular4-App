<div class="clearfix pt-2 pb-2">
    <div class="col-xs-8">
        <div class="d-inline-block pull-left mr-2 middle ewayBill-date">
            <input type="text" name="daterangeInput" daterangepicker [options]="datePickerOptions"
                (applyDaterangepicker)="selectedDate($event)" class="form-control" />
        </div>

        <!-- <div class="select-style pull-left width-125 d-align-block middle">
        <select name="">
            <option value="">Invoices</option>
            <option value="">Credit Note</option>
        </select>
    </div> -->
    </div>
    <!-- <div class="col-xs-4 text-right">
      <button type="button"  (click)="redirectInvoice()" class="btn btn-pink">+ New E-way</button>
  </div> -->
</div>

<div class="custom-tabs heightVH-100">
    <tabset>
        <tab heading="Basic title" id="tab1">

            <div class="mt-2 clearfix">
                <div class="col-md-12">
                    <div class="table-responsive remove-overflow">
                        <table class="table basic table-bordered">
                            <thead class="t-h-bg1" (clickOutside)="clickedOutside();">
                                <tr>
                                    <th style="width:50px">#</th>
                                    <th class="nowrap">
                                        <div class="d-flex">
                                            <div class="flex-fill">DATE</div>
                                            <div class="icon-pointer">

                                                <div class="glyphicon glyphicon-triangle-top text-light-2 d-block font-xxs"
                                                    (click)="sortbyApi('invoiceDate', 'asc')"></div>
                                                <div class="glyphicon glyphicon-triangle-bottom text-light-2 d-block font-xxs"
                                                    (click)="sortbyApi('invoiceDate', 'desc')"></div>
                                            </div>
                                        </div>
                                    </th>

                                    <th class="td_in_searchBox nowrap" #searchInvoiceContainer>

                                        <div [hidden]="showSearchInvoiceNo">
                                            <span> INVOICE NO.</span>
                                            <i class="icon-search" (click)="toggleSearch('invoiceNumber')"></i>
                                        </div>


                                        <div class="input-container" [hidden]="!showSearchInvoiceNo">
                                            <input type="text" placeholder="Search E-way" class="w100" #invoiceSearch
                                                [formControl]="voucherNumberInput" />

                                        </div>

                                    </th>

                                    <th style="width:20%" class="td_in_searchBox nowrap" #searchCustomerContainer>
                                        <!-- clickOutside)="clickedOutside($event, searchCustomerContainer, 'customerUniqueName')" -->
                                        <div [hidden]="showSearchCustomer">
                                            <span> CUSTOMER NAME</span>
                                            <i class="icon-search" (click)="toggleSearch('customerUniqueName')"></i>
                                        </div>

                                        <div class="input-container" [hidden]="!showSearchCustomer">
                                            <input type="text" placeholder="Search Particular" #customerSearch
                                                class="w100" [formControl]="customerNameInput" />

                                        </div>

                                    </th>

                                    <th class="nowrap">
                                        <div class="d-flex">
                                            <div class="flex-fill">CUSTOMER GSTIN</div>
                                            <!-- <div class="icon-pointer">

                                                <div class="glyphicon glyphicon-triangle-top text-light-2 d-block font-xxs" (click)="sortbyApi('customerGstin', 'asc')"></div>
                                                <div class="glyphicon glyphicon-triangle-bottom text-light-2 d-block font-xxs" (click)="sortbyApi('customerGstin', 'desc')"></div>
                                            </div> -->
                                        </div>
                                    </th>

                                    <th class="nowrap">

                                        <div class="d-flex">
                                            <div class="flex-fill">E-WAY BILL#</div>
                                            <div class="icon-pointer">

                                                <div class="glyphicon glyphicon-triangle-top text-light-2 d-block font-xxs"
                                                    (click)="sortbyApi('ewbNo', 'asc')"></div>
                                                <div class="glyphicon glyphicon-triangle-bottom text-light-2 d-block font-xxs"
                                                    (click)="sortbyApi('ewbNo', 'desc')"></div>
                                            </div>
                                        </div>

                                    </th>

                                    <th class="nowrap">
                                        <div class="d-flex">
                                            <div class="flex-fill">E-WAY BILL DATE</div>
                                            <div class="icon-pointer">

                                                <div class="glyphicon glyphicon-triangle-top text-light-2 d-block font-xxs"
                                                    (click)="sortbyApi('billingDate', 'asc')"></div>
                                                <div class="glyphicon glyphicon-triangle-bottom text-light-2 d-block font-xxs"
                                                    (click)="sortbyApi('billingDate', 'desc')"></div>
                                            </div>
                                        </div>
                                    </th>

                                    <th class="nowrap">

                                        <div class="d-flex">
                                            <div class="flex-fill text-right pr-1">TOTAL</div>
                                            <div class="icon-pointer">

                                                <div class="glyphicon glyphicon-triangle-top text-light-2 d-block font-xxs"
                                                    (click)="sortbyApi('totalValue', 'asc')"></div>
                                                <div class="glyphicon glyphicon-triangle-bottom text-light-2 d-block font-xxs"
                                                    (click)="sortbyApi('totalValue', 'desc')"></div>
                                            </div>
                                        </div>

                                    </th>
                                    <th class="nowrap"></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let item of EwaybillLists?.results let i = index">
                                    <td>{{ i + 1 }}</td>
                                    <td class="nowrap">{{item?.invoiceDate}}</td>
                                    <td class="nowrap download-arrow"><a href="#"
                                            class="d-inline-block">{{item?.docNumber}}</a>
                                        <a (click)="onSelectEwayDownload(item)" [tooltip]="'Download E-way Bill'"> <i
                                                class="icon-download1 cursor-pointer pull-right"></i></a>
                                    </td>
                                    <td>{{item?.customerName}}</td>
                                    <td>{{item?.customerGstin}}</td>
                                    <td>
                                        <div>
                                            <!-- <a href="javascript:void(0);" class="btn-link-2" (click)="onSelectEwayDownload(item)">{{item?.ewbNo}}</a> -->
                                            {{item?.ewbNo}}
                                            <br>
                                            <small *ngIf="item?.isManuallyGenerated"
                                                class="cp btn-link text-green">MANUALLY GENERATED</small>
                                        </div>
                                    </td>
                                    <td class="nowrap">{{item?.ewayBillDate}}</td>
                                    <td class="nowrap text-right pr-1"><i class="fa fa-inr"></i>
                                        {{item?.totalValue | giddhCurrency}}</td>
                                    <td class="nowrap">
                                        <div class="btn-group pull-left" dropdown>
                                            <!-- <button type="button" class="btn btn-primary dropdown-toggle"
            aria-controls="dropdown-basic">
        Button dropdown <span class="caret"></span>
    </button> -->
                                            <a href="javascript:void(0)" class="dropdown-toggle" id="button-basic"
                                                dropdownToggle>Actions <i class="caret"></i></a>
                                            <ul id="dropdown-basic" *dropdownMenu class="dropdown-menu dropdown-left"
                                                role="menu" aria-labelledby="button-basic">
                                                <li role="menuitem"><a class="dropdown-item" href="javascript:void(0)"
                                                        (click)="openModal(item, template)">Add vehicle details</a></li>
                                                <li role="menuitem"><a class="dropdown-item" href="javascript:void(0)"
                                                        (click)="onSelectEwayDetailedDownload(item)">Download detailed
                                                        eway </a></li>
                                                <li role="menuitem"><a class="dropdown-item"
                                                        (click)="openModal(item, cancel)">Cancel</a></li>
                                            </ul>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>


                        </table>
                        <div class="no-data"
                            *ngIf="EwaybillLists?.results?.length === 0 && !(isGetAllEwaybillRequestInProcess$ | async)">
                            <h1>No entries found within given criteria.</h1>
                            <h1>Do search with some other dates</h1>
                        </div>
                    </div>
                </div>

            </div>


        </tab>
        <!-- <tab heading="Consolidated Eway Bill Details">
        <div class="mt-2 clearfix">
            <div class="col-md-12">
                <div class="table-responsive">
                    <table class="table basic table-bordered">
                        <thead class="t-h-bg1">
                            <tr>
                                <th>
                                    EWB.No & Date
                                </th>

                                <th>
                                    Supply Type
                                </th>

                                <th>
                                    Doc. No & Date
                                </th>
                                <th>
                                    Other Party GSTIN.
                                </th>
                                <th class="nowrap">
                                    Transporter Details
                                </th>
                                <th class="nowrap">
                                    From GSTIN Info
                                </th>
                                <th>
                                    TO GSTIN Info
                                </th>
                                <th>
                                    Status & Other Party<br> Rejected Status
                                </th>
                                <th>
                                    No of Items
                                </th>
                                <th>
                                    Main HSN Code
                                </th>
                                <th>
                                    HSN Secs
                                </th>
                                <th>
                                    Total Inv.Value
                                </th>
                                <th class="nowrap">
                                    Valid Till Date
                                </th>
                                <th>
                                    Mode of GEN.
                                </th>

                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><a href="javascript:void(0)" (click)="openModalWithClass(consolidateModal)">611094634352</a><br> 11/04/19
                                    <br> 17:46:00
                                </td>
                                <td>Out ward Supply</td>
                                <td></td>
                                <td>GST/19-/20/1</td>
                                <td>23AAAWL876DJKJ765D</td>
                                <td>123 Palsikar square indore MP India</td>
                                <td>Ankit sukhlia indore 452001</td>
                                <td>Active & -</td>
                                <td>1</td>
                                <td>34534</td>
                                <td>TV</td>
                                <td>180:0</td>
                                <td class="nowrap">12/04/2019</td>
                                <td>WEB</td>
                            </tr>

                            <tr>
                                <td>611094634352<br> 11/04/19
                                    <br> 17:46:00
                                </td>
                                <td>Out ward Supply</td>
                                <td></td>
                                <td>GST/19-/20/1</td>
                                <td>23AAAWL876DJKJ765D</td>
                                <td>123 Palsikar square indore MP India</td>
                                <td>Ankit sukhlia indore 452001</td>
                                <td>Active & -</td>
                                <td>1</td>
                                <td>34534</td>
                                <td>TV</td>
                                <td>180:0</td>
                                <td class="nowrap">12/04/2019</td>
                                <td>WEB</td>
                            </tr>

                            <tr>
                                <td>611094634352<br> 11/04/19
                                    <br> 17:46:00
                                </td>
                                <td>Out ward Supply</td>
                                <td></td>
                                <td>GST/19-/20/1</td>
                                <td>23AAAWL876DJKJ765D</td>
                                <td>123 Palsikar square indore MP India</td>
                                <td>Ankit sukhlia indore 452001</td>
                                <td>Active & -</td>
                                <td>1</td>
                                <td>34534</td>
                                <td>TV</td>
                                <td>180:0</td>
                                <td class="nowrap">12/04/2019</td>
                                <td>WEB</td>
                            </tr>
                    </table>
                    <div class="no-data" *ngIf="EwaybillLists?.results?.length === 0 && !(isGetAllEwaybillRequestInProcess$ | async)">
                        <h1>No entries found within given criteria.</h1>
                        <h1>Do search with some other dates</h1>
                    </div>
                </div>
            </div>

        </div>
    </tab> -->
    </tabset>
</div>

<form #updateVehicleForm="ngForm" autocomplete="off" name="updateEwayVehicleform">
    <ng-template #template>
        <div class="modal-header">
            <h3 class="modal-title pull-left">Add vehicle</h3>
            <button type="button" class="close pull-right" (click)="closeModel()">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>

        <div class="modal-body pb-4">

            <div class="row d-flex e-way-body ">
                <div class="col-md-4 col-lg-4 col-sm-12 mt-2 text-right">
                    <label>Mode of Transportation*</label>
                </div>

                <div class="col-md-8 col-lg-8 col-sm-12 mt-2 ">

                    <ul class="list-icon-group ">
                        <li>
                            <input id="transMode1" type="radio" name="transMode"
                                [(ngModel)]="updateEwayVehicleform.transMode" value="1">
                            <label for="transMode1"><img src="assets/icon/4.svg " /> Road</label>
                        </li>
                        <li>
                            <input id="transMode2" type="radio" [(ngModel)]="updateEwayVehicleform.transMode"
                                name="transMode" value="2">
                            <label for="transMode2"><img src="assets/icon/3.svg " /> Rail</label>
                        </li>
                        <li>
                            <input id="transMode3" type="radio" [(ngModel)]="updateEwayVehicleform.transMode"
                                name="transMode" value="3">
                            <label for="transMode3"><img src="assets/icon/1.svg " /> Air</label>
                        </li>
                        <li>
                            <input id="transMode4" type="radio" [(ngModel)]="updateEwayVehicleform.transMode"
                                name="transMode" value="4">
                            <label for="transMode4"><img src="assets/icon/2.svg " /> Ship</label>
                        </li>

                    </ul>

                </div>
            </div>
            <div class="modal-body">

                <div class="row d-flex e-way-body ">
                    <div class="col-md-4 col-lg-4 col-sm-12 mt-2 text-right">
                        <label>Vehicle Type*</label>
                    </div>

                    <div class="col-md-8 col-lg-8 col-sm-12 mt-2 ">

                        <!-- <span class="mr-1 ">  <input type="radio "class="radio_theme " style="margin-right: 10px "/> Regular</span>
<span>  <input type="radio "class="radio_theme " style="margin-right: 10px "/> Over Dimensional Cargo</span> -->




                        <span class="pd0 mrR3">
                            <input id="Regular" class="radio-custom cp ml0" type="radio" name="vehicleType" required
                            [(ngModel)]="updateEwayVehicleform.vehicleType" value="R">
                            <label for="Regular" class="radio-custom-label">Regular</label>
                        </span>

                        <span class="pd0 mrR3">
                            <input id="DimensionalCargo" class="radio-custom cp ml0" type="radio" name="vehicleType" required
                            value="O" [(ngModel)]="updateEwayVehicleform.vehicleType">
                            <label for="DimensionalCargo" class="radio-custom-label">Over Dimensional Cargo</label>
                        </span>

                    </div>
                </div>

                <div class="row d-flex e-way-body ">
                    <div class="col-md-4 col-lg-4 col-sm-12 mt-2 text-right">
                        <label class="pt-07">Vehicle No.*</label>
                    </div>

                    <div class="col-md-8 col-lg-6 col-sm-12 mt-2 ">

                        <input type="text" name="vehicleNo" required placeholder="Mention Number "
                            [(ngModel)]="updateEwayVehicleform.vehicleNo" maxlength="15" minlength="7"
                            class="form-control input " />

                    </div>
                </div>

                <div class="row">
                    <div class="col-md-4 col-lg-4 col-sm-12 mt-2 text-right">
                        <label class="pt-07">From Place*</label>
                    </div>
                    <div class="col-md-8 col-lg-6 col-sm-12 mt-2 " id="form-place">
                        <!-- <input type="text" required placeholder="" class="form-control input" /> -->
                        <!-- <input [ngbTypeahead]="dataSource" type="text" autocomplete="off" (keyup)="onChangeCityName()" [(ngModel)]="company.city" name="city" [resultTemplate]="rt" (selectItem)="typeaheadOnSelect($event)" class="form-control" required maxlength="50" placeholder="Branch City"
                                pattern="^[^\s]+(\s+[^\s]+)*$"> -->
                        <input [ngbTypeahead]="dataSource" class="form-control input " placeholder="Enter city"
                            type="text" autocomplete="off" [(ngModel)]="updateEwayVehicleform.fromPlace"
                            name="fromPlace" [resultTemplate]="rt" required maxlength="50">
                        <ng-template #rt let-r="result" let-t="term">
                            <span>{{ r }}</span>
                        </ng-template>

                    </div>
                </div>

                <div class="row">
                    <div class="col-md-4 col-lg-4 col-sm-12 mt-2 text-right">
                        <label class="pt-07">From State*</label>
                    </div>
                    <div class="col-md-8 col-lg-6 col-sm-12 mt-2 ">
                        <sales-sh-select [placeholder]="'State'" [multiple]="false" [isFilterEnabled]="true"
                            class="select-bdr-bottom" name="fromState" required
                            [(ngModel)]="updateEwayVehicleform.fromState" [options]="statesSource$ | async">
                        </sales-sh-select>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-4 col-lg-4 col-sm-12 mt-2 text-right">
                        <label class="pt-07">Reason*</label>
                    </div>
                    <div class="col-md-8 col-lg-6 col-sm-12 mt-2 ">
                        <!-- <sh-select class="input" [options]="ewayUpdateVehicleReason" required placeholder="select type" [multiple]="false" [isFilterEnabled]="true" name="reasonCode" [(ngModel)]="updateEwayVehicleform.reasonCode"></sh-select> -->
                        <sh-select class=" input " [options]="ewayUpdateVehicleReasonList" required
                            placeholder="select type" [isFilterEnabled]="true" name="reasonCode"
                            [(ngModel)]="updateEwayVehicleform.reasonCode" [ItemHeight]="33"></sh-select>

                    </div>
                </div>

                <div class="row">
                    <div class="col-md-4 col-lg-4 col-sm-12 mt-2 text-right">
                        <label class="pt-07">Remark*</label>
                    </div>
                    <div class="col-md-8 col-lg-6 col-sm-12 mt-2 ">
                        <textarea name="reasonRem" class="form-control" required
                            [(ngModel)]="updateEwayVehicleform.reasonRem" placeholder="Enter the remarks"></textarea>

                    </div>
                </div>

                <div class="row">
                    <div class="col-md-4 col-lg-4 col-sm-12 mt-2 text-right">
                        <label class="pt-07">Transporter's Doc No.*</label>
                    </div>
                    <div class="col-md-8 col-lg-6 col-sm-12 mt-2 ">
                        <input type="text" placeholder="Enter transporter's doc no." required name="transDocNo"
                            [(ngModel)]="updateEwayVehicleform.transDocNo" class="form-control input" />
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-4 col-lg-4 col-sm-12 mt-2 text-right">
                        <label class="pt-07">Transporter's Doc Date*</label>
                    </div>
                    <div class="col-md-8 col-lg-6 col-sm-12 mt-2 ">
                        <input placeholder="dd/mm/yyyy " name="transDocDate" required type="text " placement="top"
                            [bsConfig]="{dateInputFormat: 'DD/MM/YYYY', adaptivePosition: true}"
                            [(ngModel)]="updateEwayVehicleform.transDocDate" class="form-control " bsDatepicker
                            style="padding-right: 27px !important; " />
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-4 col-lg-4 col-sm-12 mt-2 text-right">

                    </div>
                    <div class="col-md-8 col-lg-6 col-sm-12 mt-2 ">
                        <button type="submit" [disabled]="updateVehicleForm.invalid"
                            [ladda]="updateEwayvehicleProcess$ | async" (click)="updateEwayTransport(updateVehicleForm)"
                            class="btn btn-success mr-2">Save
                        </button>
                        <button type="submit" class="btn btn-danger mr-2" (click)="closeModel()">Cancel</button>
                    </div>
                </div>
            </div>
        </div>

    </ng-template>
</form>


<!-- Reasons for cancellation -->
<form #cancelEwayForm="ngForm" autocomplete="off">
    <ng-template #cancel>
        <div class="modal-header">
            <h3 class="modal-title pull-left">Reasons For Cancellation</h3>
            <button type="button" class="close pull-right" (click)="closeModel()">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>

        <div class="modal-body pb-4">
            <div class="row">
                <div class="col-md-3 col-lg-3 col-sm-12 mt-2 text-right">
                    <label class="pt-07">Reason *</label>
                </div>
                <div class="col-md-8 col-lg-7 col-sm-12 mt-2">
                    <sh-select class=" input " [options]="ewayCancelReason" required placeholder="select type"
                        [isFilterEnabled]="true" name="cancelRsnCode" [(ngModel)]="cancelEwayRequest.cancelRsnCode"
                        [ItemHeight]="33"></sh-select>
                </div>
            </div>
            <div class="row">
                <div class="col-md-3 col-lg-3 col-sm-12 mt-2 text-right">
                    <label class="pt-07">Remark</label>
                </div>
                <div class="col-md-8 col-lg-7 col-sm-12 mt-2">
                    <textarea name="cancelRmrk" class="form-control" [(ngModel)]="cancelEwayRequest.cancelRmrk"
                        placeholder="Enter the remarks"></textarea>
                </div>
            </div>

            <div class="row">
                <div class="col-md-3 col-lg-3 col-sm-12 mt-2 text-right">

                </div>
                <div class="col-md-8 col-lg-7 col-sm-12 mt-2">
                    <button type="submit" (click)="cancelEwayBill(cancelEwayForm)" [disabled]="cancelEwayForm.invalid"
                        [ladda]="cancelEwayInProcess$ | async" class="btn btn-success mr-2">Confirm
                    </button>
                    <button type="submit" class="btn btn-danger mr-2" (click)="closeModel()">Cancel</button>
                </div>
            </div>
        </div>

    </ng-template>
</form>


<ng-template #consolidateModal>
    <div class="modal-header">
        <h3 class="modal-title pull-left">Consolidated Details</h3>
        <button type="button" class="close pull-right" aria-label="Close" (click)="closeModel()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <h4 class="font-22 mb-2">1. Consolidated E-Way Bill Details</h4>
        <div class="table-responsive">
            <table class="table custom basic">
                <tbody>
                    <tr>
                        <td>Consolidated E-Way Bill Details</td>
                        <th>12345678</th>
                    </tr>
                    <tr>
                        <td>Date</td>
                        <th>24/04/2019</th>
                    </tr>
                    <tr>
                        <td>Transporter ID</td>
                        <th>29BHK534534KJH43</th>
                    </tr>

                    <tr>
                        <td>Vehicle No</td>
                        <th>MH87786</th>
                    </tr>
                    <tr>
                        <td>From</td>
                        <th>ABC-HJK7865765JG4</th>
                    </tr>

                    <tr>
                        <td>Mode</td>
                        <th>Road</th>
                    </tr>
                </tbody>
            </table>
        </div>


        <h4 class="font-22 mb-2">2. Item Details</h4>
        <div class="table-responsive">
            <table class="table basic table-bordered">
                <thead class="t-h-bg1">
                    <tr>
                        <th>#</th>
                        <th>E-Way Bill No. & Date</th>
                        <th>EwayBill By</th>
                        <th>Document No. & Date</th>
                        <th>Value</th>
                        <th>To</th>
                        <th>Valid Till Date</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let item of EwaybillLists?.results">
                        <td>{{item?.invoiceDate}}</td>
                        <td>{{item?.docNumber}}</td>
                        <td>{{item?.customerName}}</td>
                        <td>{{item?.customerGstin}}</td>
                        <td>{{item?.ewbNo}}
                            <br>
                            <small href=".." class="cp btn-link text-green">MANUALLY GENERATED</small>
                        </td>
                        <td>{{item?.ewayBillDate}}</td>
                        <td><i class="fa fa-inr"></i> {{item?.totalValue}}</td>
                        <td><a href="../../../../../../../src/app/invoice/eWayBill" class="btn-link">Action</a></td>
                    </tr>

                </tbody>
            </table>
        </div>


    </div>
</ng-template>
