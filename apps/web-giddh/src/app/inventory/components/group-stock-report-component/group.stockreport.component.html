<section class="h100">
    <div class="text-right popover-details">
        <div class="btn-group d-inline-block custom-dropdown ml-1" dropdown placement="bottom right">
            <button
                id="button-alignment"
                dropdownToggle
                type="button"
                class="dropdown-toggle"
                aria-controls="dropdown-alignment"
            >
                <span class="icon-dots-three-vertical"></span>
            </button>
            <ul
                id="dropdown-alignment"
                *dropdownMenu
                class="dropdown-menu dropdown-menu-right bottom-details pt-1 pb-1"
                role="menu"
                aria-labelledby="button-alignment"
            >
                <li role="menuitem">
                    <section
                        *ngIf="
                            groupStockReport && groupStockReport.stockReport && groupStockReport.stockReport.length > 0
                        "
                    >
                        <div class="p-3">
                            <div class="row mr-0 ml-0">
                                <div class="col-sm-5">
                                    <div class="row mr-0 ml-0">
                                        <div class="col-5 p-0 count-text">
                                            <h4 class="text-light pl-0">
                                                <div *ngIf="GroupStockReportRequest.branchDetails === 'allEntity'">
                                                    Transaction Count
                                                </div>
                                                <div
                                                    class=""
                                                    *ngIf="GroupStockReportRequest.branchDetails !== 'allEntity'"
                                                >
                                                    Product Count
                                                </div>
                                                <div class="mt-1">Profit/Loss</div>
                                            </h4>
                                        </div>
                                        <div class="col-7 p-0">
                                            <h4 class="text-purple text-right">
                                                <div *ngIf="GroupStockReportRequest.branchDetails === 'allEntity'">
                                                    <span class="text-purple" *ngIf="groupStockReport.totalItems"
                                                        >&nbsp;{{ groupStockReport.totalItems | giddhCurrency }}</span
                                                    >
                                                </div>
                                                <div
                                                    class=""
                                                    *ngIf="GroupStockReportRequest.branchDetails !== 'allEntity'"
                                                >
                                                    <span class="text-purple" *ngIf="groupStockReport.totalItems"
                                                        >&nbsp;{{ groupStockReport.totalItems | giddhCurrency }}</span
                                                    >
                                                </div>
                                                <div class="mt-1">
                                                    <span class="text-purple d-block"
                                                        >{{ groupStockReport.profit | giddhCurrency }}
                                                    </span>
                                                </div>
                                            </h4>
                                        </div>
                                    </div>
                                    <div class="row" *ngIf="groupStockReport.openingBalance.transactionCount">
                                        <div class="col-10 p-0">
                                            <h4>Inward</h4>
                                        </div>
                                        <div class="col-2 p-0">
                                            <h4>
                                                &nbsp;<span>{{
                                                    groupStockReport.InwardBalance.transactionCount | giddhCurrency
                                                }}</span>
                                            </h4>
                                        </div>
                                    </div>
                                    <div class="row" *ngIf="groupStockReport.outwardBalance.transactionCount">
                                        <div class="col-10 p-0">
                                            <h4>Outward</h4>
                                        </div>
                                        <div class="col-2 p-0">
                                            <h4>
                                                &nbsp;<span>{{
                                                    groupStockReport.outwardBalance.transactionCount | giddhCurrency
                                                }}</span>
                                            </h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-7">
                                    <div class="flex-col">
                                        <div class="cont d-flex justify-content-between pt-1">
                                            <h4 class="text-light">Opening Value</h4>
                                            <h2>{{ groupStockReport.openingBalance.amount | giddhCurrency }}</h2>
                                            <h4 *ngIf="groupStockReport.openingBalance.quantity">
                                                ({{ groupStockReport.openingBalance.quantity | giddhCurrency }}
                                                {{ groupStockReport.openingBalance.stockUnit }})
                                            </h4>
                                        </div>
                                    </div>
                                    <div class="flex-col"></div>
                                    <div class="flex-col">
                                        <div class="cont d-flex justify-content-between pt-1">
                                            <h4 class="text-light">Inward Value</h4>
                                            <h2>{{ groupStockReport.inwardBalance.amount | giddhCurrency }}</h2>
                                            <h4 *ngIf="groupStockReport.inwardBalance.quantity">
                                                ({{ groupStockReport.inwardBalance.quantity | giddhCurrency }}
                                                {{ groupStockReport.inwardBalance.stockUnit }})
                                            </h4>
                                        </div>
                                    </div>
                                    <div class="flex-col"></div>
                                    <div class="flex-col">
                                        <div class="cont d-flex justify-content-between pt-1">
                                            <h4 class="text-light">Outward Value</h4>
                                            <h2>{{ groupStockReport.outwardBalance.amount | giddhCurrency }}</h2>
                                            <h4 *ngIf="groupStockReport.outwardBalance.quantity">
                                                ({{ groupStockReport.outwardBalance.quantity | giddhCurrency }}
                                                {{ groupStockReport.outwardBalance.stockUnit }})
                                            </h4>
                                        </div>
                                    </div>
                                    <div class="flex-col"></div>
                                    <div class="flex-col">
                                        <div class="cont d-flex justify-content-between pt-1">
                                            <h4 class="text-light">Closing Value</h4>
                                            <h2 class="text-purple">
                                                {{ groupStockReport.closingBalance.amount | giddhCurrency }}
                                            </h2>
                                            <h4 class="text-purple" *ngIf="groupStockReport.closingBalance.quantity">
                                                ({{ groupStockReport.closingBalance.quantity | giddhCurrency }}
                                                {{ groupStockReport.closingBalance.stockUnit }})
                                            </h4>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </li>
            </ul>
        </div>
    </div>

    <div class="mb-2 d-none">
        <!-- enable branch selection after implimentation from api-->
        <div class="d-flex">
            <div class="mr-r15 sh-select-dropdown">
                <div class="select-style middle">
                    <sh-select
                        placeholder="Select Branch"
                        name="entity"
                        [(ngModel)]="selectedEntity"
                        (selected)="selectEntity($event)"
                        [options]="entities$ | async"
                        [ItemHeight]="33"
                    ></sh-select>
                </div>
            </div>
        </div>
    </div>
    <div class="fb-1-container mr-b1 mt-3">
        <div class="d-flex justify-content-between w-100">
            <div class="d-flex wrap-head-report">
                <h2 class="mr-2 head-report" *ngIf="groupStockReport">
                    <span>{{ groupStockReport.stockGroupName }}</span> (Group)
                </h2>
                <div class="advance-icon cursor-pointer" tooltip="Advance Search" (click)="onOpenAdvanceSearch()">
                    <span class="icon-advance-filter"></span>
                </div>
            </div>
            <div class="clear-filter" *ngIf="isFilterCorrect && productName?.value?.length > 0">
                <button class="btn btn-filter" (click)="resetFilter()">
                    <span class="icon-cross"></span> Clear Filter
                </button>
            </div>
            <div class="clearfix right-inventory d-flex">
                <div class="btn-group align-items-center" dropdown [autoClose]="true" placement="bottom right">
                    <button class="btn-link icon-btn mr-r15" (click)="editGroup()" tooltip="Edit group">
                        <i class="icon-edit-pencil"></i>
                    </button>
                    <button
                        id="button-alignment"
                        dropdownToggle
                        type="button"
                        class="btn-link cp mr-r15 dropdown-toggle icon-btn"
                        aria-controls="dropdown-alignment"
                        tooltip="Download"
                    >
                        <i class="icon-download-circle strong"></i>
                    </button>
                    <ul
                        id="dropdown-alignment"
                        *dropdownMenu
                        class="dropdown-menu dropdown-menu-right dropdown-menu-download"
                        role="menu"
                        aria-labelledby="button-alignment"
                    >
                        <li role="menuitem" (click)="downloadAllInventoryReports('group', 'csv')">
                            <a class="dropdown-item">CSV</a>
                        </li>
                        <li role="menuitem" (click)="downloadAllInventoryReports('group', 'xlsx')">
                            <a class="dropdown-item">XLS</a>
                        </li>
                    </ul>
                </div>
                <button
                    *ngIf="!(currentOrganizationType !== 'BRANCH' && branches?.length > 1)"
                    class="btn btn-sky-blue transfer-btn"
                    data-toggle="tooltip"
                    tooltip="Alt+N"
                    (click)="toggleTransferAsidePane()"
                >
                    New Transfer
                </button>
                <button class="btn btn-sky-blue mr-0" data-toggle="tooltip" tooltip="Alt+i" (click)="toggleAsidePane()">
                    Create New
                </button>
            </div>
        </div>
    </div>

    <section class="bottom-button-display">
        <div class="mobile-card-wrapper">
            <table
                class="table basic table-border inventory-stock-table on-mobile-view table-responsive"
                [ngClass]="{
                    'mr-b100':
                        groupStockReport && groupStockReport.stockReport && groupStockReport.stockReport.length > 6
                }"
            >
                <thead>
                    <tr>
                        <!-- in case of all entity with group -->
                        <th
                            colspan="4"
                            class="bd-rr p-0"
                            width="30%"
                            *ngIf="GroupStockReportRequest.branchDetails === 'allEntity'"
                        >
                            <!-- in case of all entity with group -->
                        </th>

                        <th
                            colspan="2"
                            class="bd-rr"
                            width="17%"
                            *ngIf="GroupStockReportRequest.branchDetails != 'allEntity'"
                        >
                            <div class="custom-datepicker-wrapper-group">
                                <div class="custom-datepicker" (click)="showGiddhDatepicker($event)">
                                    <input
                                        type="text"
                                        name="selectedDateRange"
                                        [value]="selectedDateRangeUi ? selectedDateRangeUi : ''"
                                        class="giddh-datepicker date-range-picker"
                                    />
                                </div>
                            </div>
                        </th>
                        <ng-container *ngIf="groupStockReport?.count">
                            <th class="text-center bd-rr bd-rb" width="20%" colspan="2">Opening stock</th>
                            <th class="text-center bd-rr bd-rb" width="20%" colspan="2">Inwards</th>
                            <th class="text-center bd-rr bd-rb" width="20%" colspan="2">Outwards</th>
                            <th class="text-center bd-rb" width="20%" colspan="2">Closing Stock</th>
                        </ng-container>
                    </tr>
                    <tr class="bd-rt" [hidden]="!groupStockReport?.count">
                        <th
                            colspan="2"
                            class="bd-rr td-search-box max-width-140"
                            (clickOutside)="clickedOutside($event, null, 'product')"
                        >
                            <div [hidden]="showProductSearch">
                                <span>Product Name</span>
                                <i class="icon-search" (click)="showProductSearchBox()"></i>
                            </div>

                            <div class="input-container" [hidden]="!showProductSearch">
                                <input
                                    type="text"
                                    placeholder="Search Product"
                                    class="w100"
                                    #productName
                                    [formControl]="productUniqueNameInput"
                                />
                            </div>
                        </th>
                        <!-- in case of all entity with group -->
                        <th
                            colspan="2"
                            class="bd-rr td-search-box max-width-140"
                            *ngIf="GroupStockReportRequest.branchDetails === 'allEntity'"
                            (clickOutside)="clickedOutside($event, null, 'source')"
                        >
                            <div [hidden]="showSourceSearch">
                                <span>Source</span>
                                <i class="icon-search" (click)="showSourceSearchBox()"></i>
                            </div>

                            <div class="input-container" [hidden]="!showSourceSearch">
                                <input
                                    type="text"
                                    placeholder="Source"
                                    class="w100"
                                    #sourceName
                                    [formControl]="sourceUniqueNameInput"
                                />
                                <i class="icon-search" (click)="showSourceSearch = false"></i>
                            </div>
                        </th>
                        <!-- in case of all entity with group end -->
                        <th class="text-right border-right-none">
                            <div class="d-flex">
                                <div class="flex-fill">Qty</div>
                                <div class="icon-pointer">
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="GroupStockReportRequest.sortBy !== 'OPENING_STOCK_QTY'"
                                        (click)="sortButtonClicked('asc', 'OPENING_STOCK_QTY')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'OPENING_STOCK_QTY' &&
                                                GroupStockReportRequest.sort === 'asc'
                                        }"
                                    ></div>

                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="
                                            GroupStockReportRequest.sortBy === 'OPENING_STOCK_QTY' &&
                                            GroupStockReportRequest.sort === 'desc'
                                        "
                                        (click)="sortButtonClicked('asc', 'OPENING_STOCK_QTY')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'OPENING_STOCK_QTY' &&
                                                GroupStockReportRequest.sort === 'desc'
                                        }"
                                    ></div>
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="
                                            GroupStockReportRequest.sortBy === 'OPENING_STOCK_QTY' &&
                                            GroupStockReportRequest.sort === 'asc'
                                        "
                                        (click)="sortButtonClicked('desc', 'OPENING_STOCK_QTY')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'OPENING_STOCK_QTY' &&
                                                GroupStockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                </div>
                            </div>
                        </th>

                        <th class="text-right">
                            <div class="d-flex">
                                <div class="flex-fill">Value</div>
                                <div class="icon-pointer">
                                    <!-- default -->
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="GroupStockReportRequest.sortBy !== 'OPENING_STOCK_VALUE'"
                                        (click)="sortButtonClicked('asc', 'OPENING_STOCK_VALUE')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'OPENING_STOCK_VALUE' &&
                                                GroupStockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                    <!-- after sort click -->
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="
                                            GroupStockReportRequest.sortBy === 'OPENING_STOCK_VALUE' &&
                                            GroupStockReportRequest.sort === 'desc'
                                        "
                                        (click)="sortButtonClicked('asc', 'OPENING_STOCK_VALUE')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'OPENING_STOCK_VALUE' &&
                                                GroupStockReportRequest.sort === 'desc'
                                        }"
                                    ></div>
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="
                                            GroupStockReportRequest.sortBy === 'OPENING_STOCK_VALUE' &&
                                            GroupStockReportRequest.sort === 'asc'
                                        "
                                        (click)="sortButtonClicked('desc', 'OPENING_STOCK_VALUE')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'OPENING_STOCK_VALUE' &&
                                                GroupStockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                </div>
                            </div>
                        </th>
                        <th class="text-right border-right-none">
                            <div class="d-flex">
                                <div class="flex-fill">Qty</div>
                                <div class="icon-pointer">
                                    <!-- default -->
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="GroupStockReportRequest.sortBy !== 'INWARDS_STOCK_QTY'"
                                        (click)="sortButtonClicked('asc', 'INWARDS_STOCK_QTY')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'INWARDS_STOCK_QTY' &&
                                                GroupStockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                    <!-- after sort click -->
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="
                                            GroupStockReportRequest.sortBy === 'INWARDS_STOCK_QTY' &&
                                            GroupStockReportRequest.sort === 'desc'
                                        "
                                        (click)="sortButtonClicked('asc', 'INWARDS_STOCK_QTY')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'INWARDS_STOCK_QTY' &&
                                                GroupStockReportRequest.sort === 'desc'
                                        }"
                                    ></div>
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="
                                            GroupStockReportRequest.sortBy === 'INWARDS_STOCK_QTY' &&
                                            GroupStockReportRequest.sort === 'asc'
                                        "
                                        (click)="sortButtonClicked('desc', 'INWARDS_STOCK_QTY')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'INWARDS_STOCK_QTY' &&
                                                GroupStockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                </div>
                            </div>
                        </th>

                        <th class="text-right">
                            <div class="d-flex">
                                <div class="flex-fill">Value</div>
                                <div class="icon-pointer">
                                    <!-- default -->
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="GroupStockReportRequest.sortBy !== 'INWARDS_STOCK_VALUE'"
                                        (click)="sortButtonClicked('asc', 'INWARDS_STOCK_VALUE')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'INWARDS_STOCK_VALUE' &&
                                                GroupStockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                    <!-- after sort click -->
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="
                                            GroupStockReportRequest.sortBy === 'INWARDS_STOCK_VALUE' &&
                                            GroupStockReportRequest.sort === 'desc'
                                        "
                                        (click)="sortButtonClicked('asc', 'INWARDS_STOCK_VALUE')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'INWARDS_STOCK_VALUE' &&
                                                GroupStockReportRequest.sort === 'desc'
                                        }"
                                    ></div>
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="
                                            GroupStockReportRequest.sortBy === 'INWARDS_STOCK_VALUE' &&
                                            GroupStockReportRequest.sort === 'asc'
                                        "
                                        (click)="sortButtonClicked('desc', 'INWARDS_STOCK_VALUE')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'INWARDS_STOCK_VALUE' &&
                                                GroupStockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                </div>
                            </div>
                        </th>
                        <th class="text-right border-right-none">
                            <div class="d-flex">
                                <div class="flex-fill">Qty</div>
                                <div class="icon-pointer">
                                    <!-- default -->
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="GroupStockReportRequest.sortBy !== 'OUTWARDS_STOCK_QTY'"
                                        (click)="sortButtonClicked('asc', 'OUTWARDS_STOCK_QTY')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'OUTWARDS_STOCK_QTY' &&
                                                GroupStockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                    <!-- after sort click -->
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="
                                            GroupStockReportRequest.sortBy === 'OUTWARDS_STOCK_QTY' &&
                                            GroupStockReportRequest.sort === 'desc'
                                        "
                                        (click)="sortButtonClicked('asc', 'OUTWARDS_STOCK_QTY')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'OUTWARDS_STOCK_QTY' &&
                                                GroupStockReportRequest.sort === 'desc'
                                        }"
                                    ></div>
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="
                                            GroupStockReportRequest.sortBy === 'OUTWARDS_STOCK_QTY' &&
                                            GroupStockReportRequest.sort === 'asc'
                                        "
                                        (click)="sortButtonClicked('desc', 'OUTWARDS_STOCK_QTY')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'OUTWARDS_STOCK_QTY' &&
                                                GroupStockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                </div>
                            </div>
                        </th>

                        <th class="text-right">
                            <div class="d-flex">
                                <div class="flex-fill">Value</div>
                                <div class="icon-pointer">
                                    <!-- default -->
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="GroupStockReportRequest.sortBy !== 'OUTWARDS_STOCK_VALUE'"
                                        (click)="sortButtonClicked('asc', 'OUTWARDS_STOCK_VALUE')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'OUTWARDS_STOCK_VALUE' &&
                                                GroupStockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                    <!-- after sort click -->
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="
                                            GroupStockReportRequest.sortBy === 'OUTWARDS_STOCK_VALUE' &&
                                            GroupStockReportRequest.sort === 'desc'
                                        "
                                        (click)="sortButtonClicked('asc', 'OUTWARDS_STOCK_VALUE')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'OUTWARDS_STOCK_VALUE' &&
                                                GroupStockReportRequest.sort === 'desc'
                                        }"
                                    ></div>
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="
                                            GroupStockReportRequest.sortBy === 'OUTWARDS_STOCK_VALUE' &&
                                            GroupStockReportRequest.sort === 'asc'
                                        "
                                        (click)="sortButtonClicked('desc', 'OUTWARDS_STOCK_VALUE')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'OUTWARDS_STOCK_VALUE' &&
                                                GroupStockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                </div>
                            </div>
                        </th>
                        <th class="text-right border-right-none">
                            <div class="d-flex">
                                <div class="flex-fill">Qty</div>
                                <div class="icon-pointer">
                                    <!-- default -->
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="GroupStockReportRequest.sortBy !== 'CLOSING_STOCK_QTY'"
                                        (click)="sortButtonClicked('asc', 'CLOSING_STOCK_QTY')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'CLOSING_STOCK_QTY' &&
                                                GroupStockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                    <!-- after sort click -->
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="
                                            GroupStockReportRequest.sortBy === 'CLOSING_STOCK_QTY' &&
                                            GroupStockReportRequest.sort === 'desc'
                                        "
                                        (click)="sortButtonClicked('asc', 'CLOSING_STOCK_QTY')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'CLOSING_STOCK_QTY' &&
                                                GroupStockReportRequest.sort === 'desc'
                                        }"
                                    ></div>
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="
                                            GroupStockReportRequest.sortBy === 'CLOSING_STOCK_QTY' &&
                                            GroupStockReportRequest.sort === 'asc'
                                        "
                                        (click)="sortButtonClicked('desc', 'CLOSING_STOCK_QTY')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'CLOSING_STOCK_QTY' &&
                                                GroupStockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                </div>
                            </div>
                        </th>

                        <th class="text-right">
                            <div class="d-flex">
                                <div class="flex-fill">Value</div>
                                <div class="icon-pointer">
                                    <!-- default -->
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="GroupStockReportRequest.sortBy !== 'CLOSING_STOCK_VALUE'"
                                        (click)="sortButtonClicked('asc', 'CLOSING_STOCK_VALUE')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'CLOSING_STOCK_VALUE' &&
                                                GroupStockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                    <!-- after sort click -->
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="
                                            GroupStockReportRequest.sortBy === 'CLOSING_STOCK_VALUE' &&
                                            GroupStockReportRequest.sort === 'desc'
                                        "
                                        (click)="sortButtonClicked('asc', 'CLOSING_STOCK_VALUE')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'CLOSING_STOCK_VALUE' &&
                                                GroupStockReportRequest.sort === 'desc'
                                        }"
                                    ></div>
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="
                                            GroupStockReportRequest.sortBy === 'CLOSING_STOCK_VALUE' &&
                                            GroupStockReportRequest.sort === 'asc'
                                        "
                                        (click)="sortButtonClicked('desc', 'CLOSING_STOCK_VALUE')"
                                        [ngClass]="{
                                            'active-text-color':
                                                GroupStockReportRequest.sortBy === 'CLOSING_STOCK_VALUE' &&
                                                GroupStockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                </div>
                            </div>
                        </th>
                    </tr>
                </thead>
                <tbody *ngIf="!groupStockReportInProcess && groupStockReport && groupStockReport.count > 0">
                    <tr *ngFor="let txn of groupStockReport.stockReport">
                        <ng-container *ngIf="txn.openingBalance || txn.inwards || txn.outwards || txn.closingBalance">
                            <td class="bd-rb bd-rr" colspan="2" data-title="Product Name">
                                <span class="justify-content-between d-flex align-items-start">
                                    <span>{{ txn.stockName }}</span>
                                    <span class="unit-badge pull-right text-light nowrap">{{
                                        txn.openingBalance?.stockUnit
                                    }}</span>
                                </span>
                            </td>
                            <!-- in case of all entity with group -->
                            <td
                                colspan="2"
                                class="bd-rb bd-rr max-width-140"
                                data-title="Product Name"
                                *ngIf="GroupStockReportRequest.branchDetails === 'allEntity'"
                            >
                                {{ txn.stockName }}
                            </td>
                            <!-- in case of all entity with group end -->
                            <td data-title="Opening stock -" class="td-mobile-head"></td>

                            <td class="bd-rb bd-rr text-right border-right-none mb-0" data-title="Qty">
                                <span [ngClass]="{ 'text-danger': txn.openingBalance?.quantity < 0 }">{{
                                    txn.openingBalance?.quantity | giddhCurrency
                                }}</span>
                            </td>
                            <td class="bd-rb bd-rr text-right mb-0" data-title="Value">
                                {{ txn.openingBalance?.amount | giddhCurrency }}
                            </td>

                            <td
                                data-title="inwards -"
                                class="td-mobile-head"
                                *ngIf="!isMobileScreen || (isMobileScreen && txn.showAllColumns)"
                            ></td>

                            <td
                                class="bd-rb bd-rr text-right border-right-none mb-0"
                                data-title="Qty"
                                *ngIf="!isMobileScreen || (isMobileScreen && txn.showAllColumns)"
                            >
                                <span [ngClass]="{ 'text-danger': txn.inwards?.quantity < 0 }">{{
                                    txn.inwards?.quantity | giddhCurrency
                                }}</span>
                            </td>
                            <td
                                class="bd-rb bd-rr text-right mb-0"
                                data-title="Value"
                                *ngIf="!isMobileScreen || (isMobileScreen && txn.showAllColumns)"
                            >
                                {{ txn.inwards?.amount | giddhCurrency }}
                            </td>

                            <td
                                data-title="Outwards -"
                                class="td-mobile-head"
                                *ngIf="!isMobileScreen || (isMobileScreen && txn.showAllColumns)"
                            ></td>

                            <td
                                class="bd-rb bd-rr text-right border-right-none mb-0"
                                data-title="Qty"
                                *ngIf="!isMobileScreen || (isMobileScreen && txn.showAllColumns)"
                            >
                                {{ txn.outwards?.quantity | giddhCurrency }}
                            </td>
                            <td
                                class="bd-rb bd-rr text-right mb-0"
                                data-title="Value"
                                *ngIf="!isMobileScreen || (isMobileScreen && txn.showAllColumns)"
                            >
                                {{ txn.outwards?.amount | giddhCurrency }}
                            </td>

                            <td data-title="Closing stock -" class="td-mobile-head"></td>

                            <td class="bd-rb bd-rr text-right border-right-none mb-0" data-title="Qty">
                                <span [ngClass]="{ 'text-danger': txn.closingBalance?.quantity < 0 }">{{
                                    txn.closingBalance?.quantity | giddhCurrency
                                }}</span>
                            </td>
                            <td class="bd-rb bd-rr text-right" data-title="Value">
                                {{ txn.closingBalance?.amount | giddhCurrency }}
                            </td>
                        </ng-container>

                        <ng-container *ngIf="isMobileScreen">
                            <td [attr.colspan]="txn.showAllColumns ? 16 : 10" class="more-table">
                                <a href="javascript:;" (click)="txn.showAllColumns = !txn.showAllColumns">{{
                                    txn.showAllColumns ? "Less" : "More"
                                }}</a>
                            </td>
                        </ng-container>
                    </tr>
                </tbody>

                <tbody *ngIf="groupStockReportInProcess">
                    <!-- in case of all entity with group -->
                    <tr>
                        <td colspan="10" class="text-center empty-table">
                            <giddh-page-loader></giddh-page-loader>
                        </td>
                    </tr>
                </tbody>

                <tfoot *ngIf="groupStockReport && groupStockReport.totalPages > 1">
                    <tr>
                        <td colspan="10" class="text-center">
                            <pagination
                                [totalItems]="groupStockReport.totalPages"
                                [(ngModel)]="groupStockReport.page"
                                [maxSize]="6"
                                class="pagination-sm"
                                [boundaryLinks]="true"
                                [itemsPerPage]="1"
                                [rotate]="false"
                                (pageChanged)="pageChanged($event)"
                            ></pagination>
                        </td>
                    </tr>
                </tfoot>
            </table>
            <div
                class="no-data"
                *ngIf="
                    (groupStockReport && groupStockReport.count < 1 && !groupStockReportInProcess) ||
                    groupNotFoundMessage
                "
            >
                <h1 [class.group-not-found]="groupNotFoundMessage">
                    {{ groupNotFoundMessage ? groupNotFoundMessage : "No entries found within given criteria." }}
                </h1>
                <h1 class="p-0" [class.group-not-found]="groupNotFoundMessage">
                    {{ groupNotFoundMessage ? groupNotFoundMessage : "Do search with some other dates" }}
                </h1>
            </div>
        </div>

        <!-- sticky Footer -->
        <section
            class="mt-5 footer-sticky"
            *ngIf="groupStockReport && groupStockReport.stockReport && groupStockReport.stockReport.length > 0"
        >
            <div class="sticky-footer sticky-footer-sale-amount">
                <div class="inner-content-footer">
                    <div class="row">
                        <div class="col-lg-5 col-md-12 pr-0">
                            <div class="row">
                                <div class="col-4 p-0 count-text">
                                    <h4 class="text-light">
                                        <div *ngIf="GroupStockReportRequest.branchDetails === 'allEntity'">
                                            Transaction Count
                                        </div>
                                        <div class="" *ngIf="GroupStockReportRequest.branchDetails !== 'allEntity'">
                                            Product Count
                                        </div>
                                        <div class="mt-1">Profit/Loss</div>
                                    </h4>
                                </div>
                                <div class="col-8 p-0">
                                    <h4 class="text-purple text-left">
                                        <div *ngIf="GroupStockReportRequest.branchDetails === 'allEntity'">
                                            <span class="text-purple" *ngIf="groupStockReport.totalItems"
                                                >&nbsp;{{ groupStockReport.totalItems | giddhCurrency }}</span
                                            >
                                        </div>
                                        <div class="" *ngIf="GroupStockReportRequest.branchDetails !== 'allEntity'">
                                            <span class="text-purple" *ngIf="groupStockReport.totalItems"
                                                >&nbsp;{{ groupStockReport.totalItems | giddhCurrency }}</span
                                            >
                                        </div>
                                        <div class="mt-1">
                                            <span class="text-purple d-block"
                                                >{{ groupStockReport.profit | giddhCurrency }} ({{
                                                    dateRangePickerCmp?.nativeElement?.value | replaceHyphens
                                                }})</span
                                            >
                                        </div>
                                    </h4>
                                </div>
                            </div>
                            <div class="row" *ngIf="groupStockReport.openingBalance.transactionCount">
                                <div class="col-10 p-0">
                                    <h4>Inward</h4>
                                </div>
                                <div class="col-2 p-0">
                                    <h4>
                                        &nbsp;<span>{{
                                            groupStockReport.InwardBalance.transactionCount | giddhCurrency
                                        }}</span>
                                    </h4>
                                </div>
                            </div>
                            <div class="row" *ngIf="groupStockReport.outwardBalance.transactionCount">
                                <div class="col-10 p-0">
                                    <h4>Outward</h4>
                                </div>
                                <div class="col-2 p-0">
                                    <h4>
                                        &nbsp;<span>{{
                                            groupStockReport.outwardBalance.transactionCount | giddhCurrency
                                        }}</span>
                                    </h4>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-7 col-md-12 opening-value">
                            <div class="flex-col">
                                <div class="cont">
                                    <h4 class="text-light">Opening Value</h4>
                                    <h2>{{ groupStockReport.openingBalance.amount | giddhCurrency }}</h2>
                                    <h4 *ngIf="groupStockReport.openingBalance.quantity">
                                        ({{ groupStockReport.openingBalance.quantity | giddhCurrency }}
                                        {{ groupStockReport.openingBalance.stockUnit }})
                                    </h4>
                                </div>
                            </div>
                            <div class="flex-col"></div>
                            <div class="flex-col">
                                <div class="cont">
                                    <h4 class="text-light">Inward Value</h4>
                                    <h2>{{ groupStockReport.inwardBalance.amount | giddhCurrency }}</h2>
                                    <h4 *ngIf="groupStockReport.inwardBalance.quantity">
                                        ({{ groupStockReport.inwardBalance.quantity | giddhCurrency }}
                                        {{ groupStockReport.inwardBalance.stockUnit }})
                                    </h4>
                                </div>
                            </div>
                            <div class="flex-col"></div>
                            <div class="flex-col">
                                <div class="cont">
                                    <h4 class="text-light">Outward Value</h4>
                                    <h2>{{ groupStockReport.outwardBalance.amount | giddhCurrency }}</h2>
                                    <h4 *ngIf="groupStockReport.outwardBalance.quantity">
                                        ({{ groupStockReport.outwardBalance.quantity | giddhCurrency }}
                                        {{ groupStockReport.outwardBalance.stockUnit }})
                                    </h4>
                                </div>
                            </div>
                            <div class="flex-col"></div>
                            <div class="flex-col">
                                <div class="cont">
                                    <h4 class="text-light">Closing Value</h4>
                                    <h2 class="text-purple">
                                        {{ groupStockReport.closingBalance.amount | giddhCurrency }}
                                    </h2>
                                    <h4 class="text-purple" *ngIf="groupStockReport.closingBalance.quantity">
                                        ({{ groupStockReport.closingBalance.quantity | giddhCurrency }}
                                        {{ groupStockReport.closingBalance.stockUnit }})
                                    </h4>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </section>
</section>
<!-- aside new stock/group/unit pane -->
<div class="aside-overlay" *ngIf="asidePaneState === 'in'"></div>
<aside-pane
    *ngIf="asidePaneState === 'in'"
    [class]="asidePaneState"
    [@slideInOut]="asidePaneState"
    (closeAsideEvent)="toggleAsidePane()"
></aside-pane>
<!-- aside new stock/group/unit -->

<!-- aside inwards/outwards/transfer pane -->
<div class="aside-overlay" *ngIf="asideTransferPaneState === 'in'"></div>
<aside-branch-transfer-pane
    *ngIf="asideTransferPaneState === 'in'"
    [class]="asideTransferPaneState"
    [@slideInOut]="asideTransferPaneState"
    (transferType)="openBranchTransferPopup($event)"
    (closeAsideEvent)="toggleTransferAsidePane()"
></aside-branch-transfer-pane>
<!-- aside inwards/outwards/transfer pane -->

<!-- Advance search popup -->
<div bsModal #advanceSearchModel="bs-modal" class="modal fade" role="dialog">
    <div class="modal-dialog modal-md">
        <div class="modal-content">
            <div class="modal-header theme-bg">
                <h3 class="modal-title bg" id="modal-title">Advance Search</h3>
                <button aria-hidden="true" class="close" data-dismiss="modal" (click)="advanceSearchAction('cancel')">
                    
                </button>
            </div>
            <div class="modal-body clearfix" [hidden]="!showAdvanceSearchModal">
                <form action="" [formGroup]="advanceSearchForm">
                    <div class="row">
                        <div class="col-sm-4">Date Range</div>
                        <div class="col-sm-8">
                            <div class="custom-datepicker" (click)="showGiddhDatepicker($event)">
                                <input
                                    type="text"
                                    name="selectedDateRange"
                                    [value]="selectedDateRangeUi ? selectedDateRangeUi : ''"
                                    class="giddh-datepicker date-range-picker"
                                />
                            </div>
                        </div>
                    </div>
                    <div class="row mr-t2">
                        <div class="col-sm-4">Select Category</div>
                        <div class="col-sm-4">
                            <div class="select-style middle">
                                <sh-select
                                    [options]="CategoryOptions"
                                    (onClear)="clearShSelect('filterCategory')"
                                    [multiple]="false"
                                    [placeholder]="'Select Category'"
                                    #shCategory
                                    formControlName="filterCategory"
                                    (selected)="onDDElementSelect($event, 'filterCategory')"
                                ></sh-select>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="select-style middle">
                                <sh-select
                                    [options]="CategoryTypeOptions"
                                    (onClear)="clearShSelect('filterCategoryType')"
                                    [multiple]="false"
                                    [placeholder]="'Select Type'"
                                    #shCategoryType
                                    formControlName="filterCategoryType"
                                    (selected)="onDDElementSelect($event, 'filterCategoryType')"
                                ></sh-select>
                            </div>
                        </div>
                    </div>
                    <div class="row mr-t2">
                        <div class="col-sm-4">Value</div>
                        <div class="col-sm-4">
                            <div class="select-style middle">
                                <sh-select
                                    [options]="FilterValueCondition"
                                    (onClear)="clearShSelect('filterValueCondition')"
                                    [multiple]="false"
                                    [placeholder]="'Select Type'"
                                    #shValueCondition
                                    formControlName="filterValueCondition"
                                    (selected)="onDDElementSelect($event, 'filterValueCondition')"
                                >
                                </sh-select>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <input
                                type="text"
                                class="form-control"
                                (keyup)="mapAdvFilters()"
                                placeholder="Amount"
                                maxlength="16"
                                formControlName="filterAmount"
                            />
                            <small *ngIf="advanceSearchForm.controls['filterAmount'].invalid" class="text-danger"
                                >input number only</small
                            >
                        </div>
                    </div>

                    <div class="row mr-t4 mr-b3">
                        <div class="col-xs-12 col-sm-12 text-right">
                            <button
                                class="btn btn-success"
                                type="button"
                                [disabled]="
                                    !isFilterCorrect ||
                                    !GroupStockReportRequest.condition ||
                                    !GroupStockReportRequest.entity ||
                                    !GroupStockReportRequest.value ||
                                    !GroupStockReportRequest.number
                                "
                                (click)="advanceSearchAction('search')"
                            >
                                Search
                            </button>
                            <button class="btn btn-danger" type="button" (click)="advanceSearchAction('clear')">
                                Clear
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- Advance  search popup -->

<!-- branch transfer modal -->
<ng-template #template>
    <div class="recept-modal">
        <div class="modal-body">
            <new-branch-transfer (hideModal)="hideModal($event)" [branchTransferMode]="branchTransferMode">
            </new-branch-transfer>
        </div>
    </div>
</ng-template>

<ng-template #datepickerTemplate>
    <div class="datepicker-modal">
        <div class="modal-body">
            <app-datepicker-wrapper
                [inputStartDate]="selectedDateRange?.startDate"
                [inputEndDate]="selectedDateRange?.endDate"
                [alwaysShowCalendars]="true"
                [ranges]="datePickerOption"
                [selectedRangeLabel]="selectedRangeLabel"
                [showCustomRangeLabel]="true"
                [showClearButton]="false"
                [showCancel]="true"
                [linkedCalendars]="true"
                [showDropdowns]="true"
                (rangeClicked)="dateSelectedCallback($event)"
                (datesUpdated)="dateSelectedCallback($event)"
                [keepCalendarOpeningWithRange]="false"
                [showRangeLabelOnInput]="false"
                [dateFieldPosition]="dateFieldPosition"
            ></app-datepicker-wrapper>
        </div>
    </div>
</ng-template>
