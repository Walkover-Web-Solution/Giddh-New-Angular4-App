<div class="aside-pane">

    <div class="form-header">
        <div>
            <h3 class=""><span>Account Details</span></h3>
        </div>
    </div>

    <button id="close" class="" (click)="closeAsidePane($event)"><i class="icon-cross"></i></button>

    <div class="aside-pane-conatainer">
        <form name="addAccountForm" [formGroup]="addAccountForm" (ngSubmit)="submit()">
            <div class="">
                <div class="upper-form">
                    <div class="row ">
                        <div class="col-sm-4">
                            <div class="ng-select-wrap liq selectGroup">
                                <label>Select Group<span class="red-text">*</span> </label>
                                <ng-select placeholder="Select Group" filterPlaceholder="Type to search..."
                                    (selected)="selectGroup($event)" formControlName="activeGroupUniqueName"
                                    [options]="flatGroupsOptions" style="width:100%">
                                    <ng-template #optionTemplate let-option="option">
                                        <div class="account-list-item">{{option?.label}}</div>
                                        <div class="account-list-item fs12">{{option?.value}}</div>
                                    </ng-template>
                                </ng-select>
                            </div>
                        </div>
                        <div class="col-sm-8">
                            <div class="form-group">
                                <label>Account Name </label>
                                <input type="text" class="form-control" #autoFocus formControlName="name"
                                    name="accountName" placeholder="Account Name">
                            </div>
                        </div>
                    </div>
                    <div class="row ">
                        <div class="col-sm-4">
                            <div class="form-group" formGroupName="country">
                                <label>Country </label>
                                <sh-select [options]="countrySource" [isFilterEnabled]="true"
                                    formControlName="countryCode" (selected)="selectCountry($event)"></sh-select>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                                <label>Currency (account) </label>
                                <sh-select [options]="currencySource$ | async" formControlName="currency"
                                    [isFilterEnabled]="true"></sh-select>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group cr-dr-account">
                                <label>Opening Balance </label>
                                <!-- <input type="text" value="INR" class="form-control">
                            <span class="dr-label active">DR</span>
                            <span class="cr-label">CR</span> -->
                                <div class="input-group"
                                    [ngClass]="{'input-group': addAccountForm.get('openingBalance').value > 0}">
                                    <input type="text" min="0" class="form-control text-right"
                                        (click)="openingBalanceClick()" decimalDigitsDirective
                                        formControlName="openingBalance" placeholder="00.00" />
                                    <div class="input-group-addon" (click)="openingBalanceTypeChnaged('DEBIT')"
                                        [ngClass]="
                 {'active-toggle-btn': addAccountForm.get('openingBalanceType').value === 'DEBIT' && addAccountForm.get('openingBalance').value > 0,
                  'cp': addAccountForm.get('openingBalance').value > 0}"
                                        *ngIf="addAccountForm.get('openingBalance').value > 0">DR.
                                    </div>
                                    <div class="input-group-addon" (click)="openingBalanceTypeChnaged('CREDIT')"
                                        [ngClass]="
                 {'active-toggle-btn': addAccountForm.get('openingBalanceType').value === 'CREDIT' && addAccountForm.get('openingBalance').value > 0,
                  'cp': addAccountForm.get('openingBalance').value > 0}"
                                        *ngIf="addAccountForm.get('openingBalance').value > 0">CR.
                                    </div>
                                </div>


                            </div>
                        </div>
                    </div>
                    <ng-container *ngIf="isHsnSacEnabledAcc">
                        <div class="row">
                            <div class="col-xs-6 form-group">
                                <label class="d-block">HSN</label>
                                <div class="input-group">
                                    <span class="input-group-addon">
                                        <input type="radio" class="" formControlName="hsnOrSac" value='hsn'
                                            name="hsnOrSac">
                                    </span>
                                    <input type="text" class="form-control" digitsOnlyDirective
                                        formControlName="hsnNumber" class="form-control" name="hsnNumber"
                                        maxLength="10">
                                </div>
                            </div>
                            <div class="col-xs-6 form-group">
                                <label class="d-block">SAC</label>
                                <div class="input-group">
                                    <span class="input-group-addon">
                                        <input type="radio" class="" formControlName="hsnOrSac" value='sac'
                                            name="hsnOrSac" />
                                    </span>
                                    <input type="text" digitsOnlyDirective formControlName="sacNumber"
                                        class="form-control " name="sacNumber" maxLength="10">
                                </div>
                            </div>
                        </div>
                    </ng-container>

                </div>
            </div>

            <tabset #staticTabs class="custom-tabs " id="aside-pane-form-tabs">
                <tab heading="Address" class="gstinAddress">
                    <ng-container>
                        <div class="gstinForm" formArrayName="addresses">
                            <ng-container
                                *ngFor="let gst of addAccountForm.get('addresses')['controls'] | slice: 0:gstDetailsLength;let i = index;let f = first; let l = last"
                                [formGroupName]="i">
                                <div class="row">
                                    <div class="col-sm-12">
                                        <div class="add-address-default">
                                            <h3>Address {{i+1}}</h3>
                                            <div class="inputRadio">
                                                <input type="checkbox" name="defaultGst_{{i}}"
                                                    formControlName="isDefault"
                                                    (change)="isDefaultAddressSelected(gst.get('isDefault').value, i)"
                                                    tooltip="DEFAULT GST" placement="left">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>Street</label>
                                            <!-- <textarea class="form-control" rows="4" cols="5"></textarea> -->
                                            <textarea name="gstAddr_{{i}}" formControlName="address" rows="4" cols="5"
                                                maxlength="120" class="form-control"></textarea>
                                        </div>

                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-4">
                                        <div class="form-group">
                                            <label>State <sup *ngIf="isDebtorCreditor">*</sup></label>
                                            <div class="custom-select">
                                                <sh-select #states [options]="statesSource$ | async"
                                                    [isFilterEnabled]="true" (selected)="selectedState(gst, $event)"
                                                    [forceClearReactive]="forceClear$ | async"
                                                    formControlName="stateCode" style="width:100%">
                                                </sh-select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-4">
                                        <div class="form-group">
                                            <label>City</label>
                                            <input type="text" disabled class="form-control" placeholder="City Name">
                                        </div>
                                    </div>
                                    <div class="col-sm-4">
                                        <div class="form-group">
                                            <label>Zip Code</label>
                                            <input type="text" disabled class="form-control" placeholder="Enter Code">
                                        </div>
                                    </div>
                                    <div class="col-sm-4">
                                        <div class="form-group" *ngIf="formFields['taxName'] !== undefined">
                                            <label for="gstinNum" class="d-block">{{formFields['taxName'].label}}<sup
                                                    class="text-danger">*</sup></label>
                                            <input type="text" class="form-control" autocomplete="false"
                                                autocomplete="false" #gstNumberField
                                                (keyup)="getStateCode(gst, states); checkGstNumValidation(gstNumberField);"
                                                name="gstNumber" formControlName="gstNumber"
                                                placeholder="Enter {{formFields['taxName'].label}}" />
                                        </div>
                                    </div>
                                    <div class="col-sm-4">
                                        <div class="form-group">
                                            <label>Party Type<span class="red-text">*</span></label>
                                            <div class="custom-select pos-rel">
                                                <sh-select [options]="partyTypeSource" formControlName="partyType"
                                                    [isFilterEnabled]="true"></sh-select>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm-4"
                                        [ngStyle]="{display : gst.get('gstNumber').value && isGstValid ? 'block' : ' none' }">
                                        <div class="form-group">
                                            <label class="d-block">&nbsp;</label>
                                            <label *ngIf="gst.get('gstNumber').value && isGstValid">
                                                <input type="checkbox" formControlName="isComposite"><label>&nbsp; Is
                                                    Composite?
                                                </label></label>
                                            <a href="javascript:void(0);" *ngIf="!f" (click)="removeGstDetailsForm(i)"
                                                class="grey_clr btn btn-danger">
                                                <i class="fa fa-times"> </i> Remove
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <div class="row" *ngIf="l">
                                    <a class="text-right pull-right btn btn-primary" href="javascript:void(0);"
                                        (click)="addGstDetailsForm(gst.get('gstNumber').value)">
                                        <i class="fa fa-plus"></i> + Add Address
                                    </a>
                                </div>
                            </ng-container>
                        </div>
                    </ng-container>

                    <!-- <div class="row">
                        <div class="col-sm-12"> <button class="btn btn-primary mrT2" (click)="addAddress = !addAddress">+ Add
                Address</button></div>
                    </div> -->

                </tab>
                <tab heading="Contact" class="ContactFromWrap">
                    <div class="contactForm">
                        <div class="row">
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label>Attention to (will be used in Invoice)</label>
                                    <input type="text" class="form-control" formControlName="attentionTo"
                                        name="attention" />
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label>Mobile Number</label>
                                    <div class="d-flex">
                                        <sh-select [placeholder]="'+91'" [options]="countryPhoneCode"
                                            formControlName="mobileCode" style="width: 60px; margin-right: 10px;">
                                        </sh-select>
                                        <input type="text" pattern="[0-9]*" class="form-control pull-right"
                                            placeholder="98XXXXXXXX" formControlName="mobileNo" id="contactNo"
                                            autocomplete="off" (blur)="isValidMobileNumber(mobileNoEl)" #mobileNoEl />
                                        <small class="clearfix error-msg"
                                            *ngIf="addAccountForm.get('mobileNo').value && !addAccountForm.get('mobileCode').value">Phone
                                            code
                                            required
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label>Email Id</label>
                                    <input type="email" class="form-control" formControlName="email" name="emailId" />
                                    <span class="error-msg"
                                        *ngIf="addAccountForm.get('email').dirty && addAccountForm.get('email').errors">*Invalid
                                        Email
                                        address</span>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label>PAN</label>
                                    <input type="text" disabled class="form-control" placeholder="PAN Number">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label>Other Details</label>
                                    <input type="text" disabled class="form-control" placeholder="Other">
                                </div>
                            </div>

                        </div>
                    </div>
                    <!-- <div class="row">
                <div class="col-sm-12 mrT3">
                    <div class="button-group">
                        <button class="btn btn-cancel">Cancel</button>
                        <button class="btn btn-success">Save</button>
                    </div>
                </div>
            </div> -->
                </tab>


                <!-- bank details visible when sundry credtiors selected , right now is hide -->
                <tab heading="Bank Details" class="bankDetialsForm">
                    <div *ngIf="showBankDetail">
                        <div formArrayName="accountBankDetails">
                            <div class="row"
                                *ngFor="let bank of addAccountForm.get('accountBankDetails')['controls'];let i = index;let f = first; let l = last"
                                [formGroupName]="i">
                                <div class="form-group col-sm-5">
                                    <label for="">Bank Name</label>
                                    <input type="text" class="form-control" name="bankName_{{i}}"
                                        formControlName="bankName" />
                                </div>
                                <div class="form-group col-sm-4">
                                    <div class="">
                                        <label for="">Account No.</label>
                                        <input type="text" class="form-control" name="accountNum_{{i}}"
                                            formControlName="bankAccountNo" />
                                    </div>
                                </div>
                                <div class="form-group col-sm-3">
                                    <label for="">IFSC Code</label>
                                    <input type="text" class="form-control" name="ifsc_{{i}}" formControlName="ifsc" />
                                </div>
                            </div>
                        </div>
                    </div>

                </tab>

                <tab heading="Others " class="otherFormWrap ">

                    <div class="otherForm ">
                        <div class="row ">
                            <div class="col-sm-6 ">
                                <div class="form-group ">
                                    <label>Account Unique Name</label>
                                    <input type="text" class="form-control" [control]="addAccountForm.get('uniqueName')"
                                        textCaseChangeDirective UniqueNameDirective formControlName="uniqueName"
                                        name="accUnqname" />
                                </div>
                            </div>

                            <div class="form-group col-sm-6">
                                <label for="">Balance for Trigger</label>
                                <div class="input-group"
                                    [ngClass]="{'input-group': addAccountForm.get('closingBalanceTriggerAmount').value > 0}">
                                    <input type="number" min="0" class="form-control text-right"
                                        formControlName="closingBalanceTriggerAmount" placeholder="00.00" />
                                    <div class="input-group-addon" (click)="closingBalanceTypeChanged('DEBIT')"
                                        [ngClass]="
                {'active-toggle-btn': addAccountForm.get('closingBalanceTriggerAmountType').value === 'DEBIT',
                'cp': addAccountForm.get('closingBalanceTriggerAmount').value > 0}"
                                        *ngIf="addAccountForm.get('closingBalanceTriggerAmount').value > 0">DR.
                                    </div>
                                    <div class="input-group-addon" (click)="closingBalanceTypeChanged('CREDIT')"
                                        [ngClass]="
                {'active-toggle-btn': addAccountForm.get('closingBalanceTriggerAmountType').value === 'CREDIT',
                'cp': addAccountForm.get('closingBalanceTriggerAmount').value > 0}"
                                        *ngIf="addAccountForm.get('closingBalanceTriggerAmount').value > 0">CR.
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div class="row ">
                            <div class="col-sm-6 ">
                                <div class="form-group ">
                                    <label>Default Discount</label>
                                    <input type="text " class="form-control " placeholder="Select Discount ">
                                </div>
                            </div>
                            <div class="col-sm-6 ">
                                <div class="form-group ">
                                    <label>Default Tax</label>
                                    <input type="text " class="form-control " placeholder="Select Tax ">
                                </div>
                            </div>
                        </div>
                        <div class="row ">
                            <div class="col-sm-12 ">
                                <div class="form-group ">
                                    <label>Description</label>
                                    <textarea rows="3 " cols="4" name="description" formControlName="description"
                                        class="form-control "></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- <div class="row ">
                    <div class="col-sm-10 ">
                        <div class="form-group ">
                            <label>Move to Group</label>
                            <input type="text " class="form-control " placeholder="Group Name ">
                        </div>
                    </div>
                    <div class="col-sm-2 pdL0 ">
                        <label>&nbsp;</label>
                        <button class="btn btn-pink ">Move</button>
                    </div>
                </div>
                <div class="row ">
                    <div class="col-sm-10 ">
                        <div class="form-group ">
                            <label>Select account to merge with</label>
                            <input type="text " class="form-control " placeholder="Select account ">
                        </div>
                    </div>
                    <div class="col-sm-2 pdL0 ">
                        <label>&nbsp;</label>
                        <button class="btn btn-pink ">Merge</button>
                    </div>
                </div> -->
                    </div>

                </tab>
                <div class="row">
                    <div class="col-sm-12 mrT3">
                        <div class="button-group">
                            <button class="btn btn-cancel">Cancel</button>
                            <button type="submit" class="btn btn-success" [ladda]="createAccountInProcess$ | async"
                                [disabled]="addAccountForm.invalid">Save</button>
                        </div>
                    </div>
                </div>
            </tabset>
        </form>
    </div>
</div>

<!-- </div> -->
