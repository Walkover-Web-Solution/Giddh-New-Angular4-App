<section class="h100">
    <form [formGroup]="entityAndInventoryTypeForm" class="form-inline mr-b1">
        <div class="pr d-flex mb-2 inventory-branch-dropdown justify-content-between">
            <!-- enable branch selection after implimentation from api-->
            <div class="d-flex">
                <div class="mr-r15 sh-select-dropdown">
                    <div class="select-style middle">
                        <sh-select
                            placeholder="Select Branch"
                            formControlName="selectedEntity"
                            (selected)="selectEntity($event)"
                            [(ngModel)]="selectedEntity"
                            [options]="entities$ | async"
                            [ItemHeight]="33"
                        ></sh-select>
                    </div>
                </div>
            </div>
        </div>

        <div class="d-flex w-100 justify-content-between">
            <div class="d-flex wrap-head-report">
                <h2 class="head-report" *ngIf="stockReport && stockReport.stockUnit">
                    <span> {{ stockReport.stockName }}</span> (Stock)
                </h2>

                <div class="advance-icon cursor-pointer" (click)="onOpenAdvanceSearch()" tooltip="Advance Search">
                    <span class="icon-advance-filter"></span>
                </div>
            </div>
            <div class="clear-filter">
                <button class="btn btn-filter" *ngIf="isFilterCorrect" (click)="resetFilter()">
                    <span class="icon-cross"></span> Clear Filter
                </button>
            </div>

            <div class="right-inventory">
                <div class="btn-group" dropdown [autoClose]="true" placement="bottom right">
                    <button class="btn-link icon-btn mr-r15" (click)="editStock()" tooltip="Edit Stock">
                        <i class="icon-edit-pencil"></i>
                    </button>
                    <button
                        id="button-alignment"
                        dropdownToggle
                        type="button"
                        class="btn-link cp mr-r15 dropdown-toggle icon-btn"
                        aria-controls="dropdown-alignment"
                        tooltip="Download"
                    >
                        <i class="icon-download-circle strong"></i>
                    </button>
                    <ul
                        id="dropdown-alignment"
                        *dropdownMenu
                        class="dropdown-menu dropdown-menu-right dropdown-menu-download"
                        role="menu"
                        aria-labelledby="button-alignment"
                    >
                        <li role="menuitem" (click)="downloadAllInventoryReports('stock', 'csv')">
                            <a class="dropdown-item">CSV</a>
                        </li>
                        <li role="menuitem" (click)="downloadAllInventoryReports('stock', 'xlsx')">
                            <a class="dropdown-item">XLS</a>
                        </li>
                    </ul>
                </div>
                <button
                    *ngIf="!(currentOrganizationType !== 'BRANCH' && branches?.length > 1)"
                    class="btn btn-sky-blue transfer-btn"
                    data-toggle="tooltip"
                    tooltip="Alt+N"
                    (click)="toggleTransferAsidePane()"
                >
                    New Transfer
                </button>
                <button class="btn btn-sky-blue mr-0" (click)="toggleAsidePane()" data-toggle="tooltip" tooltip="Alt+i">
                    Create New
                </button>
            </div>
        </div>
    </form>

    <section>
        <div class="mobile-card-wrapper">
            <table
                class="table basic on-mobile-view table-responsive"
                [ngClass]="{
                    'mr-b100': stockReport && stockReport.transactions && stockReport.transactions.length > 6
                }"
            >
                <thead>
                    <tr>
                        <th colspan="3" width="40%">
                            <div class="d-flex">
                                <div class="custom-datepicker" (click)="showGiddhDatepicker($event)">
                                    <i class="icon-calender calendar-addon"></i>
                                    <input
                                        type="text"
                                        name="selectedDateRange"
                                        [value]="selectedDateRangeUi ? selectedDateRangeUi : ''"
                                        class="giddh-datepicker date-range-picker"
                                    />
                                </div>
                            </div>
                        </th>
                        <th
                            [hidden]="
                                !stockReport?.transactions?.length &&
                                !stockReportRequest?.accountName &&
                                stockReportRequest?.voucherTypes?.length !== VOUCHER_TYPES.length
                            "
                            colspan="4"
                            width="40%"
                            class="text-center bd-rr bd-rb"
                        >
                            Transactions
                        </th>
                        <th
                            [hidden]="
                                !stockReport?.transactions?.length &&
                                !stockReportRequest?.accountName &&
                                stockReportRequest?.voucherTypes?.length !== VOUCHER_TYPES.length
                            "
                            colspan="1"
                            width="10%"
                            class="bd-rl text-center"
                        >
                            Closing Stock
                        </th>
                    </tr>
                    <tr
                        class="bd-rt"
                        [hidden]="
                            !stockReport?.transactions?.length &&
                            !stockReportRequest?.accountName &&
                            !stockReportRequest?.voucherTypes?.length
                        "
                    >
                        <th width="100">
                            <div class="d-flex">
                                <div class="">Date</div>
                                <div class="icon-pointer">
                                    <!-- default -->
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="stockReportRequest.sortBy !== 'entry_date'"
                                        (click)="sortButtonClicked('asc', 'entry_date')"
                                        [ngClass]="{
                                            'active-text-color':
                                                stockReportRequest.sortBy === 'entry_date' &&
                                                stockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                    <!-- after sort click -->
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="
                                            stockReportRequest.sortBy === 'entry_date' &&
                                            stockReportRequest.sort === 'desc'
                                        "
                                        (click)="sortButtonClicked('asc', 'entry_date')"
                                        [ngClass]="{
                                            'active-text-color':
                                                stockReportRequest.sortBy === 'entry_date' &&
                                                stockReportRequest.sort === 'desc'
                                        }"
                                    ></div>
                                    <div
                                        class="icon-sort-asc text-right"
                                        *ngIf="
                                            stockReportRequest.sortBy === 'entry_date' &&
                                            stockReportRequest.sort === 'asc'
                                        "
                                        (click)="sortButtonClicked('desc', 'entry_date')"
                                        [ngClass]="{
                                            'active-text-color':
                                                stockReportRequest.sortBy === 'entry_date' &&
                                                stockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                </div>
                            </div>
                        </th>

                        <th class="bd-rr bd-rb" width="14%">
                            <div
                                class="btn-group btn-group-voucher-type"
                                dropdown
                                placement="bottom right"
                                container="body"
                            >
                                <button
                                    id="button-alignment"
                                    dropdownToggle
                                    type="button"
                                    class="btn-link btn cp p-0 dropdown-toggle c-3 p-0"
                                    aria-controls="dropdown-alignment"
                                >
                                    Voucher Type
                                    <i class="fa fa-ellipsis-v pull-right text-light-2" aria-hidden="true"></i>
                                </button>
                                <ul
                                    id="dropdown-alignment"
                                    *dropdownMenu
                                    class="dropdown-menu dropdown-menu-right voucher-type"
                                    role="menu"
                                    aria-labelledby="button-alignment"
                                >
                                    <li role="menuitem dropdown-item" *ngFor="let item of VOUCHER_TYPES">
                                        <label
                                            ><input
                                                type="checkbox"
                                                [(ngModel)]="item.checked"
                                                (click)="filterByCheck(item.value, $event.target?.checked)"
                                            />
                                            {{ item.label }}</label
                                        >
                                    </li>
                                </ul>
                            </div>
                        </th>
                        <th class="td-search-box" width="15%" (clickOutside)="clickedOutside($event, null, 'account')">
                            <div [hidden]="showAccountSearch">
                                <span>Account Name</span>
                                <i class="icon-search" (click)="showAccountSearchBox()"></i>
                            </div>
                            <div class="input-container" [hidden]="!showAccountSearch">
                                <input
                                    type="text"
                                    placeholder="Search Account"
                                    class="w100"
                                    #accountName
                                    [formControl]="accountUniqueNameInput"
                                />
                            </div>
                        </th>

                        <th class="bd-rr">
                            <div class="d-flex">
                                <div class="flex-fill text-right">Inwards</div>
                                <div class="icon-pointer text-right">
                                    <!-- default -->
                                    <div
                                        class="icon-sort-asc"
                                        *ngIf="stockReportRequest.sortBy !== 'inward_quantity'"
                                        (click)="sortButtonClicked('asc', 'inward_quantity')"
                                        [ngClass]="{
                                            'active-text-color':
                                                stockReportRequest.sortBy === 'inward_quantity' &&
                                                stockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                    <!-- after sort click -->
                                    <div
                                        class="icon-sort-asc"
                                        *ngIf="
                                            stockReportRequest.sortBy === 'inward_quantity' &&
                                            stockReportRequest.sort === 'desc'
                                        "
                                        (click)="sortButtonClicked('asc', 'inward_quantity')"
                                        [ngClass]="{
                                            'active-text-color':
                                                stockReportRequest.sortBy === 'inward_quantity' &&
                                                stockReportRequest.sort === 'desc'
                                        }"
                                    ></div>
                                    <div
                                        class="icon-sort-asc"
                                        *ngIf="
                                            stockReportRequest.sortBy === 'inward_quantity' &&
                                            stockReportRequest.sort === 'asc'
                                        "
                                        (click)="sortButtonClicked('desc', 'inward_quantity')"
                                        [ngClass]="{
                                            'active-text-color':
                                                stockReportRequest.sortBy === 'inward_quantity' &&
                                                stockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                </div>
                            </div>
                        </th>

                        <th class="bd-rr">
                            <div class="d-flex">
                                <div class="flex-fill text-right">Outwards</div>
                                <div class="icon-pointer text-right">
                                    <!-- default -->
                                    <div
                                        class="icon-sort-asc"
                                        *ngIf="stockReportRequest.sortBy !== 'outward_quantity'"
                                        (click)="sortButtonClicked('asc', 'outward_quantity')"
                                        [ngClass]="{
                                            'active-text-color':
                                                stockReportRequest.sortBy === 'outward_quantity' &&
                                                stockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                    <!-- after sort click -->
                                    <div
                                        class="icon-sort-asc"
                                        *ngIf="
                                            stockReportRequest.sortBy === 'outward_quantity' &&
                                            stockReportRequest.sort === 'desc'
                                        "
                                        (click)="sortButtonClicked('asc', 'outward_quantity')"
                                        [ngClass]="{
                                            'active-text-color':
                                                stockReportRequest.sortBy === 'outward_quantity' &&
                                                stockReportRequest.sort === 'desc'
                                        }"
                                    ></div>
                                    <div
                                        class="icon-sort-asc"
                                        *ngIf="
                                            stockReportRequest.sortBy === 'outward_quantity' &&
                                            stockReportRequest.sort === 'asc'
                                        "
                                        (click)="sortButtonClicked('desc', 'outward_quantity')"
                                        [ngClass]="{
                                            'active-text-color':
                                                stockReportRequest.sortBy === 'outward_quantity' &&
                                                stockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                </div>
                            </div>
                        </th>

                        <th class="bd-rr">
                            <div class="d-flex">
                                <div class="flex-fill text-right">Rate</div>
                                <div class="icon-pointer text-right">
                                    <!-- default -->
                                    <div
                                        class="icon-sort-asc"
                                        *ngIf="stockReportRequest.sortBy !== 'rate'"
                                        (click)="sortButtonClicked('asc', 'rate')"
                                        [ngClass]="{
                                            'active-text-color':
                                                stockReportRequest.sortBy === 'rate' &&
                                                stockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                    <!-- after sort click -->
                                    <div
                                        class="icon-sort-asc"
                                        *ngIf="
                                            stockReportRequest.sortBy === 'rate' && stockReportRequest.sort === 'desc'
                                        "
                                        (click)="sortButtonClicked('asc', 'rate')"
                                        [ngClass]="{
                                            'active-text-color':
                                                stockReportRequest.sortBy === 'rate' &&
                                                stockReportRequest.sort === 'desc'
                                        }"
                                    ></div>
                                    <div
                                        class="icon-sort-asc"
                                        *ngIf="
                                            stockReportRequest.sortBy === 'rate' && stockReportRequest.sort === 'asc'
                                        "
                                        (click)="sortButtonClicked('desc', 'rate')"
                                        [ngClass]="{
                                            'active-text-color':
                                                stockReportRequest.sortBy === 'rate' &&
                                                stockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                </div>
                            </div>
                        </th>

                        <th class="bd-rr">
                            <div class="d-flex">
                                <div class="flex-fill text-right">Value</div>
                                <div class="icon-pointer text-right">
                                    <!-- default -->
                                    <div
                                        class="icon-sort-asc"
                                        *ngIf="stockReportRequest.sortBy !== 'transaction_val'"
                                        (click)="sortButtonClicked('asc', 'transaction_val')"
                                        [ngClass]="{
                                            'active-text-color':
                                                stockReportRequest.sortBy === 'transaction_val' &&
                                                stockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                    <!-- after sort click -->
                                    <div
                                        class="icon-sort-asc"
                                        *ngIf="
                                            stockReportRequest.sortBy === 'transaction_val' &&
                                            stockReportRequest.sort === 'desc'
                                        "
                                        (click)="sortButtonClicked('asc', 'transaction_val')"
                                        [ngClass]="{
                                            'active-text-color':
                                                stockReportRequest.sortBy === 'transaction_val' &&
                                                stockReportRequest.sort === 'desc'
                                        }"
                                    ></div>
                                    <div
                                        class="icon-sort-asc"
                                        *ngIf="
                                            stockReportRequest.sortBy === 'transaction_val' &&
                                            stockReportRequest.sort === 'asc'
                                        "
                                        (click)="sortButtonClicked('desc', 'transaction_val')"
                                        [ngClass]="{
                                            'active-text-color':
                                                stockReportRequest.sortBy === 'transaction_val' &&
                                                stockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                </div>
                            </div>
                        </th>

                        <th class="bd-rr text-center">
                            <div class="d-flex">
                                <div class="flex-fill text-right">Qty</div>
                                <div class="icon-pointer text-right">
                                    <!-- default -->
                                    <div
                                        class="icon-sort-asc"
                                        *ngIf="stockReportRequest.sortBy !== 'closing_quantity'"
                                        (click)="sortButtonClicked('asc', 'closing_quantity')"
                                        [ngClass]="{
                                            'active-text-color':
                                                stockReportRequest.sortBy === 'closing_quantity' &&
                                                stockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                    <!-- after sort click -->
                                    <div
                                        class="icon-sort-asc"
                                        *ngIf="
                                            stockReportRequest.sortBy === 'closing_quantity' &&
                                            stockReportRequest.sort === 'desc'
                                        "
                                        (click)="sortButtonClicked('asc', 'closing_quantity')"
                                        [ngClass]="{
                                            'active-text-color':
                                                stockReportRequest.sortBy === 'closing_quantity' &&
                                                stockReportRequest.sort === 'desc'
                                        }"
                                    ></div>
                                    <div
                                        class="icon-sort-asc"
                                        *ngIf="
                                            stockReportRequest.sortBy === 'closing_quantity' &&
                                            stockReportRequest.sort === 'asc'
                                        "
                                        (click)="sortButtonClicked('desc', 'closing_quantity')"
                                        [ngClass]="{
                                            'active-text-color':
                                                stockReportRequest.sortBy === 'closing_quantity' &&
                                                stockReportRequest.sort === 'asc'
                                        }"
                                    ></div>
                                </div>
                            </div>
                        </th>
                    </tr>
                </thead>
                <tbody *ngIf="!stockReportInProcess && stockReport">
                    <tr *ngFor="let txn of stockReport.transactions">
                        <td class="bd-rr" data-title="Date">{{ txn.entryDate }}</td>
                        <td class="bd-rr {{ txn.voucherType }}" data-title="Voucher Type">{{ txn.voucherType }}</td>
                        <td class="bd-rr" data-title="Account Name">{{ txn.account?.name }}</td>
                        <td data-title="Transactions -" class="td-mobile-head"></td>
                        <td class="text-right bd-rr" data-title="Inwards">
                            <span *ngIf="txn.type == 'dr'">
                                {{ txn.quantity | giddhCurrency }}
                            </span>
                            <span *ngIf="txn.type == 'dr'" class="unit-badge">
                                {{ txn.stockUnit }}
                            </span>
                            <span *ngIf="txn.type == 'cr'">-</span>
                        </td>

                        <td class="text-right bd-rr" data-title="Outwards">
                            <span *ngIf="txn.type == 'cr'">
                                {{ txn.quantity | giddhCurrency }}
                            </span>
                            <span *ngIf="txn.type == 'cr'" class="unit-badge">
                                {{ txn.stockUnit }}
                            </span>
                            <span *ngIf="txn.type == 'dr'">-</span>
                        </td>

                        <td class="text-right bd-rr" data-title="Rate" [ngClass]="txn.type === 'cr' ? 'cr' : 'dr'">
                            {{ txn.rate | giddhCurrency }}
                        </td>

                        <td data-title="Closing Stock -" class="td-mobile-head"></td>

                        <td class="text-right bd-rr" data-title="Value" [ngClass]="txn.type === 'cr' ? 'cr' : 'dr'">
                            {{ txn.amount | giddhCurrency }}
                        </td>
                        <td class="text-right bd-rr" data-title="Quantity">
                            {{ txn.closingQuantity | giddhCurrency
                            }}<span class="unit-badge">{{ stockReport.stockUnit }}</span>
                        </td>
                    </tr>
                </tbody>

                <tbody *ngIf="stockReportInProcess">
                    <tr>
                        <td colspan="10" class="text-center empty-table">
                            <giddh-page-loader></giddh-page-loader>
                        </td>
                    </tr>
                </tbody>
                <tfoot *ngIf="stockReport && stockReport.totalPages > 1">
                    <tr>
                        <td colspan="10" class="text-center">
                            <pagination
                                [totalItems]="stockReport.totalPages"
                                [(ngModel)]="stockReport.page"
                                [maxSize]="6"
                                class="pagination-sm"
                                [boundaryLinks]="true"
                                [itemsPerPage]="1"
                                [rotate]="false"
                                (pageChanged)="pageChanged($event)"
                            ></pagination>
                        </td>
                    </tr>
                </tfoot>
            </table>
            <div
                class="no-data"
                *ngIf="(stockReport && stockReport.count < 1 && !stockReportInProcess) || stockNotFoundMessage"
            >
                <h1 [class.stock-not-found]="stockNotFoundMessage">
                    {{ stockNotFoundMessage ? stockNotFoundMessage : "No entries found within given criteria." }}
                </h1>
                <h1 class="p-0" [class.stock-not-found]="stockNotFoundMessage">
                    {{ stockNotFoundMessage ? stockNotFoundMessage : "Do search with some other dates" }}
                </h1>
            </div>
        </div>
    </section>

    <!-- sticky Footer -->
    <section class="mt-5" *ngIf="stockReport && stockReport.transactions && stockReport.transactions.length > 0">
        <div class="sticky-footer sticky-footer-sale-amount">
            <div class="inner-content-footer">
                <div class="row">
                    <div class="col-sm-3 pr-0">
                        <div class="row">
                            <div class="col-6">
                                <h4 class="text-light text-left">Profit/Loss</h4>
                            </div>
                            <div class="col-12">
                                <h4 class="text-purple text-left">
                                    &nbsp;{{ stockReport.profit | giddhCurrency }} ({{
                                        selectedDateRangeUi | replaceHyphens
                                    }})
                                </h4>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-2 pr-0">
                        <div class="row">
                            <div class="col-10 p-0">
                                <h4 class="text-light">Transaction Count</h4>
                            </div>
                            <div class="col-2 p-0">
                                <h4 class="text-purple text-left">
                                    {{
                                        stockReport.inwardBalance.transactionCount +
                                            stockReport.outwardBalance.transactionCount | giddhCurrency
                                    }}
                                </h4>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-10 p-0">
                                <h4>Inward</h4>
                            </div>
                            <div class="col-2 p-0">
                                <h4 class="text-left">
                                    &nbsp;<span *ngIf="stockReport.inwardBalance.transactionCount">{{
                                        stockReport.inwardBalance.transactionCount | giddhCurrency
                                    }}</span
                                    ><span *ngIf="!stockReport.inwardBalance.transactionCount">0</span>
                                </h4>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-10 p-0">
                                <h4>Outward</h4>
                            </div>
                            <div class="col-2 p-0">
                                <h4 class="text-left">
                                    &nbsp;<span *ngIf="stockReport.outwardBalance.transactionCount">{{
                                        stockReport.outwardBalance.transactionCount | giddhCurrency
                                    }}</span
                                    ><span *ngIf="!stockReport.outwardBalance.transactionCount">0</span>
                                </h4>
                            </div>
                        </div>
                    </div>

                    <div class="col-sm-7">
                        <div class="flex-col">
                            <div class="cont">
                                <h4 class="text-light">Opening</h4>
                                <h2>{{ stockReport.openingBalance.amount | giddhCurrency }}</h2>
                                <h4>
                                    ({{ stockReport.openingBalance.quantity | giddhCurrency }}
                                    {{ stockReport.openingBalance.stockUnit }})
                                </h4>
                            </div>
                        </div>
                        <div class="flex-col">
                            <div class="cont">
                                <h4 class="text-light">Inward</h4>
                                <h2>{{ stockReport.inwardBalance.amount | giddhCurrency }}</h2>
                                <h4>
                                    ({{ stockReport.inwardBalance.quantity | giddhCurrency }}
                                    {{ stockReport.inwardBalance.stockUnit }})
                                </h4>
                            </div>
                        </div>
                        <div class="flex-col">
                            <div class="cont">
                                <h4 class="text-light">Outward</h4>
                                <h2>{{ stockReport.outwardBalance.amount | giddhCurrency }}</h2>
                                <h4>
                                    ({{ stockReport.outwardBalance.quantity | giddhCurrency }}
                                    {{ stockReport.outwardBalance.stockUnit }})
                                </h4>
                            </div>
                        </div>
                        <div class="flex-col">
                            <div class="cont">
                                <h4 class="text-light">Closing Stock</h4>
                                <h2 class="text-purple">{{ stockReport.closingBalance.amount | giddhCurrency }}</h2>
                                <h4>
                                    ({{ stockReport.closingBalance.quantity | giddhCurrency }}
                                    {{ stockReport.closingBalance.stockUnit }})
                                </h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</section>
<!-- aside menu section -->
<div class="aside-overlay" *ngIf="asideMenuState === 'in'"></div>
<aside-pane
    *ngIf="asideMenuState === 'in'"
    [class]="asideMenuState"
    [@slideInOut]="asideMenuState"
    (closeAsideEvent)="toggleAsidePane()"
></aside-pane>
<!-- aside menu section -->

<!-- Advance search popup -->
<div bsModal #advanceSearchModel="bs-modal" class="modal fade" role="dialog">
    <div class="modal-dialog modal-md">
        <div class="modal-content">
            <div class="modal-header theme-bg">
                <h3 class="modal-title bg" id="modal-title">Advance Search</h3>
                <button aria-hidden="true" class="close" data-dismiss="modal" (click)="advanceSearchAction('cancel')">
                    Ã—
                </button>
            </div>
            <div class="modal-body advance-search clearfix" *ngIf="advanceSearchModalShow">
                <form action="" [formGroup]="advanceSearchForm">
                    <div class="row">
                        <div class="col-sm-4">Date Range</div>
                        <div class="col-sm-8">
                            <div class="custom-datepicker" (click)="showGiddhDatepicker($event)">
                                <i class="icon-calender calendar-addon"></i>
                                <input
                                    type="text"
                                    name="selectedDateRange"
                                    [value]="selectedDateRangeUi ? selectedDateRangeUi : ''"
                                    class="giddh-datepicker date-range-picker"
                                />
                            </div>
                        </div>
                    </div>
                    <div class="row mr-t2">
                        <div class="col-sm-4">Select Category</div>
                        <div class="col-sm-4">
                            <div class="select-style middle">
                                <sh-select
                                    [options]="CategoryOptions"
                                    (onClear)="clearShSelect('filterCategory')"
                                    [multiple]="false"
                                    [placeholder]="'Select Category'"
                                    #shCategory
                                    formControlName="filterCategory"
                                    (selected)="onDDElementSelect($event, 'filterCategory')"
                                ></sh-select>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="select-style middle" *ngIf="stockReportRequest.param !== 'qty_closing'">
                                <sh-select
                                    [options]="CategoryTypeOptions"
                                    (onClear)="clearShSelect('filterCategoryType')"
                                    [multiple]="false"
                                    [placeholder]="'Select Type'"
                                    #shCategoryType
                                    formControlName="filterCategoryType"
                                    (selected)="onDDElementSelect($event, 'filterCategoryType')"
                                ></sh-select>
                            </div>
                            <input
                                *ngIf="stockReportRequest.param === 'qty_closing'"
                                readonly
                                type="text"
                                class="form-control"
                                value="Quantity"
                            />
                        </div>
                    </div>
                    <div class="row mr-t2">
                        <div class="col-sm-4">Value</div>
                        <div class="col-sm-4">
                            <div class="select-style middle">
                                <sh-select
                                    [options]="FilterValueCondition"
                                    (onClear)="clearShSelect('filterValueCondition')"
                                    [multiple]="false"
                                    [placeholder]="'Select Type'"
                                    #shValueCondition
                                    formControlName="filterValueCondition"
                                    (selected)="onDDElementSelect($event, 'filterValueCondition')"
                                >
                                </sh-select>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <input
                                type="text"
                                class="form-control"
                                (keyup)="mapAdvFilters()"
                                placeholder="Amount"
                                maxlength="16"
                                formControlName="filterAmount"
                            />
                            <small *ngIf="advanceSearchForm.controls['filterAmount'].invalid" class="text-danger"
                                >input number only
                            </small>
                        </div>
                    </div>

                    <div class="row mr-t4">
                        <div class="col-12 text-right">
                            <button
                                class="btn btn-success"
                                type="button"
                                [disabled]="
                                    !isFilterCorrect ||
                                    !stockReportRequest.param ||
                                    !stockReportRequest.expression ||
                                    !stockReportRequest.val
                                "
                                (click)="advanceSearchAction('search')"
                            >
                                Search
                            </button>
                            <button class="btn btn-danger mr-0" type="button" (click)="advanceSearchAction('clear')">
                                Clear
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- Advance  search popup -->
<!-- aside inwards/outwards/transfer pane -->
<div class="aside-overlay" *ngIf="asideTransferPaneState === 'in'"></div>
<aside-branch-transfer-pane
    *ngIf="asideTransferPaneState === 'in'"
    [class]="asideTransferPaneState"
    [@slideInOut]="asideTransferPaneState"
    (transferType)="openBranchTransferPopup($event)"
    (closeAsideEvent)="toggleTransferAsidePane()"
></aside-branch-transfer-pane>
<!-- aside inwards/outwards/transfer pane -->

<!-- branch transfer modal -->
<ng-template #template>
    <div class="recept-modal">
        <div class="modal-body">
            <new-branch-transfer (hideModal)="hideModal($event)" [branchTransferMode]="branchTransferMode">
            </new-branch-transfer>
        </div>
    </div>
</ng-template>

<ng-template #datepickerTemplate>
    <div class="datepicker-modal">
        <div class="modal-body">
            <app-datepicker-wrapper
                [inputStartDate]="selectedDateRange?.startDate"
                [inputEndDate]="selectedDateRange?.endDate"
                [alwaysShowCalendars]="true"
                [ranges]="datePickerOption"
                [selectedRangeLabel]="selectedRangeLabel"
                [showCustomRangeLabel]="true"
                [showClearButton]="false"
                [showCancel]="true"
                [linkedCalendars]="true"
                [showDropdowns]="true"
                (rangeClicked)="dateSelectedCallback($event)"
                (datesUpdated)="dateSelectedCallback($event)"
                [keepCalendarOpeningWithRange]="false"
                [showRangeLabelOnInput]="false"
                [dateFieldPosition]="dateFieldPosition"
            ></app-datepicker-wrapper>
        </div>
    </div>
</ng-template>
