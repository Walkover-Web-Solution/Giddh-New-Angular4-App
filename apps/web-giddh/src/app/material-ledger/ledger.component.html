<ng-container appTranslate [file]="'ledger'" (localeData)="localeData = $event"
    (commonLocaleData)="commonLocaleData = $event" (translationComplete)="translationComplete($event)">
    <div validateSectionPermission [hasPermission]="hasLedgerPermission">
        <ng-container *ngIf="localeData?.page_heading && commonLocaleData?.app_ac">
            <div class="btn-group ledger-ellipse" *ngIf="isMobileScreen">
                <button mat-button id="button-basic" [matMenuTriggerFor]="menu" type="button" class="dropdown-toggle btn mr-0">
                    <i class="icon-dots-three-vertical"></i>
                </button>
                <mat-menu #menu="matMenu">
                    <button mat-menu-item>
                        <a class="dropdown-item" id="share-ledger" href="javascript:void(0)"
                        (click)="showShareLedgerModal()">{{localeData?.share_ledger}}</a>
                    </button>
                    <button mat-menu-item disabled>
                        <a class="dropdown-item" id="export-ledger-mobile-view" href="javascript:void(0)"
                        (click)="showExportLedgerModal()">{{commonLocaleData?.app_export}}</a>
                    </button>
                </mat-menu>
            </div>
            <hamburger-menu
                [pageHeading]="(lc?.activeAccount?.name) ? ((!isMobileScreen ? localeData?.page_heading: '') + lc?.activeAccount?.name) + ' ' + commonLocaleData?.app_ac : ''">
            </hamburger-menu>
            <section class="container ledger-section" [hidden]="isShowLedgerColumnarReportTable">
                <!-- region ledger table-->
                <div class="ledg-head transactions-page mr-t15 position-relative">
                    <!-- region ledger header -->
                    <div class="clearfix row mr-b15" [ngClass]="{'mr-b5' :  currentCompanyBranches?.length > 2}">
                        <!-- region currency toggle -->
                        <div class="col-lg-4 col-md-12 col-sm-12 col-xs-12 search-ledger-wrapper">
                            <div class="d-flex search-ledger-field">
                                <!-- please remove hidden attribute after functionality works -->
                                <div class="select-all-icons" *ngIf="checkedTrxWhileHovering?.length > 0 && isMobileScreen">
                                    <div *ngIf="visibleTransactionTypeMobile && checkedTrxWhileHovering?.length > 0">
                                        <mat-checkbox *ngIf="visibleTransactionTypeMobile === 'all'" id="select-all-entries"
                                            [(ngModel)]="debitCreditSelectAll" (change)="selectAllEntries($event, visibleTransactionTypeMobile)"></mat-checkbox>
                                        <mat-checkbox *ngIf="visibleTransactionTypeMobile === 'credit'" id="select-all-entries-cr"
                                            [(ngModel)]="creditSelectAll"
                                            (click)="selectAllEntries($event, visibleTransactionTypeMobile)"></mat-checkbox>
                                        <mat-checkbox *ngIf="visibleTransactionTypeMobile === 'debit'" id="select-all-entries-dr"
                                            [(ngModel)]="debitSelectAll"
                                            (click)="selectAllEntries($event, visibleTransactionTypeMobile)"></mat-checkbox>
                                        {{commonLocaleData?.app_select_all}}
                                    </div>
                                    <div class="d-flex mr-l15">
                                        <button mat-button
                                            [disabled]="currentOrganizationType === 'COMPANY' && currentCompanyBranches?.length > 2"
                                            class="btn btn-danger" id="delete-ledger-mobile-view"
                                            (click)="performBulkAction('delete')"
                                            [matTooltip]="commonLocaleData?.app_delete" [matTooltipPosition]="'above'"><i
                                                class="icon-trash"></i>
                                        </button>

                                        <button mat-button
                                            [disabled]="currentOrganizationType === 'COMPANY' && currentCompanyBranches?.length > 2"
                                            class="btn btn-warning" id="generate-invoice-mobile-view"
                                            (click)="performBulkAction('generate')"
                                            [matTooltip]="commonLocaleData?.app_generate_voucher" [matTooltipPosition]="'above'"><i
                                                class="icon-generate-invoice"></i>
                                        </button>
                                    </div>
                                    <button mat-button
                                        [disabled]="currentOrganizationType === 'COMPANY' && currentCompanyBranches?.length > 2"
                                        class="btn btn-success mr-0" id="attach-file-mobile-view"
                                        (click)="performBulkAction('upload', BulkUploadfileInput)"
                                        [matTooltip]="localeData?.attach_file" [matTooltipPosition]="'above'"><i
                                            class="icon-file-path"></i>
                                    </button>
                                    <input type="file" #BulkUploadfileInput class="d-none" name="BulkUploadfileInput"
                                        id="BulkUploadfileInput" [options]="fileUploadOptions" ngFileSelect
                                        [uploadInput]="uploadInput" (uploadOutput)="onUploadOutput($event)">
                                </div>
                                <div class="single-search-box d-flex" *ngIf="checkedTrxWhileHovering?.length === 0">
                                    <span
                                        [ngClass]="{'default-width-input': (searchText || isAdvanceSearchImplemented) && isMobileScreen, 'full-width-input': (searchText || !isAdvanceSearchImplemented) && isMobileScreen }">
                                        <mat-form-field appearance="fill">
                                            <input matInput id="ledger-search" [(ngModel)]="searchText" name="searchText" [placeholder]="localeData?.search_ledger" (keyup)="search(searchText)">
                                            <button *ngIf="searchText" matSuffix mat-icon-button (click)="searchText='';search(searchText);">
                                                <i aria-hidden="true" class="icon-cross"></i>
                                            </button>
                                            <span matPrefix><i class="icon-search pos-abs"></i></span>
                                        </mat-form-field>
                                    </span>
                                    <a class="cp mr-l1 clear-filter-btn"
                                        *ngIf="(searchText || isAdvanceSearchImplemented) && isMobileScreen"
                                        href="javascript:;" (click)="resetAdvanceSearch()"
                                        [matTooltip]="commonLocaleData?.app_reset_advance_search"
                                        [matTooltipPosition]="'above'">
                                        <i aria-hidden="true" class="icon-refresh"></i>
                                    </a>
                                </div>

                                <!-- Functionality not working -->
                                <div class="ledger-datepicker" id="giddh-datepicker-mobile-view" container="body"
                                    *ngIf="isMobileScreen">
                                    <img (click)="showGiddhDatepicker($event)" src="{{imgPath}}calender-icon.svg">
                                </div>
                                <span class="input-wrapper ipad-view-datepicker">
                                    <mat-form-field appearance="fill">
                                        <input matInput id="giddh-datepicker-ipad-view" type="text" name="selectedDateRange"
                                        (click)="showGiddhDatepicker($event)"
                                        [value]="(selectedDateRangeUi) ? selectedDateRangeUi : ''"
                                        class="giddh-datepicker date-range-picker" />
                                    </mat-form-field>
                                </span>
                                <span id="advance-filter" (click)="onOpenAdvanceSearch()"
                                    class="advance-icon d-flex advance-search-filter pointer"
                                    [matTooltip]="commonLocaleData?.app_advance_search" [matTooltipPosition]="'above'"
                                    [ngStyle]="{'margin-left': checkedTrxWhileHovering?.length === 0 ? '7px': '0px'}">
                                    <span class="icon-advance-filter"></span>
                                </span>
                                <a class="cp clear-filter-btn" id="clear-filter"
                                    *ngIf="isAdvanceSearchImplemented && !isMobileScreen" href="javascript:;"
                                    (click)="resetAdvanceSearch()" [matTooltip]="commonLocaleData?.app_reset_advance_search">
                                    <i aria-hidden="true" class="icon-refresh"></i>
                                </a>
                                <div class="d-flex xs-mb-1" *ngIf="checkedTrxWhileHovering?.length > 0 && !isMobileScreen">
                                    <button mat-button
                                        [disabled]="currentOrganizationType === 'COMPANY' && currentCompanyBranches?.length > 2"
                                        class="btn btn-danger" id="delete-ledger" (click)="performBulkAction('delete')"
                                        container="body" [matTooltip]="commonLocaleData?.app_delete" [matTooltipPosition]="'above'"><i
                                            class="icon-trash"></i>
                                    </button>

                                    <button mat-button
                                        [disabled]="currentOrganizationType === 'COMPANY' && currentCompanyBranches?.length > 2"
                                        class="btn btn-warning" id="generate-invoice"
                                        (click)="performBulkAction('generate')" container="body"
                                        [matTooltip]="commonLocaleData?.app_generate_voucher" [matTooltipPosition]="'above'"><i
                                            class="icon-generate-invoice"></i>
                                    </button>

                                    <button mat-button
                                        [disabled]="currentOrganizationType === 'COMPANY' && currentCompanyBranches?.length > 2"
                                        class="btn btn-success mr-0" id="attach-file"
                                        (click)="performBulkAction('upload', BulkUploadfileInput)" container="body"
                                        [matTooltip]="localeData?.attach_file" [matTooltipPosition]="'above'"><i
                                            class="icon-file-path"></i>
                                    </button>
                                    <input type="file" #BulkUploadfileInput name="BulkUploadfileInput"
                                        id="BulkUploadfileInput" [options]="fileUploadOptions" ngFileSelect
                                        [uploadInput]="uploadInput" (uploadOutput)="onUploadOutput($event)" class="d-none">
                                </div>
                            </div>
                            <div class="form-group mr-r15 linked-entities"
                                *ngIf="showBranchSwitcher && currentCompanyBranches?.length > 2 && currentOrganizationType === 'COMPANY' && isMobileScreen">
                                <div class="form-group">
                                    <sh-select [options]="currentCompanyBranches" [(ngModel)]="currentBranch.uniqueName"
                                        [borderConfiguration]="branchDropdownBorderConfiguration" [showClear]="false"
                                        [ItemHeight]="33" width="100%" (selected)="handleBranchChange($event)"
                                        [isFilterEnabled]="true" [placeholder]="commonLocaleData?.app_select_branch"
                                        [fixedValue]="currentBranch?.alias">
                                        <ng-template #optionTemplate let-option="option">
                                            <ng-container>
                                                <a href="javascript:void(0)" class="list-item d-flex">
                                                    <span class="entity-icon">
                                                        <i class="icon-branch-icon pull-right" *ngIf="!option.isCompany"
                                                            [matTooltip]="commonLocaleData?.app_branch"></i>
                                                        <i class="icon-company-profile pull-right" *ngIf="option.isCompany"
                                                            [matTooltip]="commonLocaleData?.app_company"></i>
                                                    </span>
                                                    <span class="entity-details">
                                                        <div class="item giddh-limit single-line-clamp">{{ option.label ||
                                                            '-' }}</div>
                                                        <div class="item-unique giddh-limit single-line-clamp">
                                                            {{ option.name || '-' }}
                                                        </div>
                                                    </span>
                                                </a>
                                            </ng-container>
                                        </ng-template>
                                    </sh-select>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-4 col-md-12 col-sm-12 col-xs-12 text-center date-range-options"
                            *ngIf="!isMobileScreen">
                            <div class="advance-search-by-date date-advance-search">
                                <span class="input-wrapper">
                                    <mat-form-field appearance="fill">
                                        <input matInput id="giddh-datepicker" type="text" name="selectedDateRange"
                                        (click)="showGiddhDatepicker($event)"
                                        [value]="(selectedDateRangeUi) ? selectedDateRangeUi : ''"
                                        class="giddh-datepicker date-range-picker" />
                                    </mat-form-field>
                                </span>
                            </div>
                        </div>
                        <!-- endregion -->
                        <div class="col-lg-4 col-md-12 col-sm-12 col-xs-12 text-right C-flex-end search-options"
                            *ngIf="!isMobileScreen">
                            <div class="d-flex xs-width-100 ledger-head-top">
                                <div class="form-group mr-r15 linked-entities"
                                    *ngIf="showBranchSwitcher && currentCompanyBranches?.length > 2 && currentOrganizationType === 'COMPANY'">
                                    <div class="form-group">
                                        <sh-select [options]="currentCompanyBranches" [(ngModel)]="currentBranch.uniqueName"
                                            [borderConfiguration]="branchDropdownBorderConfiguration" [showClear]="false"
                                            [ItemHeight]="33" width="100%" (selected)="handleBranchChange($event)"
                                            [isFilterEnabled]="true" [placeholder]="commonLocaleData?.app_select_branch"
                                            [fixedValue]="currentBranch?.alias">
                                            <ng-template #optionTemplate let-option="option">
                                                <ng-container>
                                                    <a href="javascript:void(0)" class="list-item d-flex">
                                                        <span class="entity-icon">
                                                            <i class="icon-branch-icon pull-right" *ngIf="!option.isCompany"
                                                                [matTooltip]="commonLocaleData?.app_branch"></i>
                                                            <i class="icon-company-profile pull-right"
                                                                *ngIf="option.isCompany"
                                                                [matTooltip]="commonLocaleData?.app_company"></i>
                                                        </span>
                                                        <span class="entity-details">
                                                            <div class="item giddh-limit single-line-clamp">{{ option.label
                                                                || '-' }}</div>
                                                            <div class="item-unique giddh-limit single-line-clamp">
                                                                {{ option.name || '-' }}
                                                            </div>
                                                        </span>
                                                    </a>
                                                </ng-container>
                                            </ng-template>
                                        </sh-select>
                                    </div>
                                </div>
                                <div *ngIf="isLedgerAccountAllowsMultiCurrency" class="advance-search-block">
                                    <span class="mr-r15 d-inline-block font-14">{{ baseCurrencyDetails?.code }}</span>
                                    <div class="toggle d-inline-block currency-toggler" data-key="disabled">
                                        <mat-slide-toggle [(ngModel)]="currencyTogglerModel" (change)="toggleCurrency($event)"></mat-slide-toggle>
                                    </div>
                                    <span class="mr-l15 d-inline-block font-14">{{ foreignCurrencyDetails?.code }}</span>
                                </div>

                                <div class="d-flex">
                                    <a mat-button href="javascript:void(0)" id="upload" class="icomoon-ico d-flex align-items-center"
                                        [matTooltip]="localeData?.import_statement" [matTooltipPosition]="'above'"
                                        (click)="showUploadBankStatementModal()">
                                        <i class="icon-upload lh-0"></i>
                                    </a>
                                    <a mat-button href="javascript:void(0)" id="share" class="icomoon-ico d-flex align-items-center"
                                        [matTooltip]="localeData?.share_ledger" [matTooltipPosition]="'above'"
                                        (click)="showShareLedgerModal()">
                                        <i class="icon-ledger-path lh-0"></i>
                                    </a>
                                    <a mat-button class="icomoon-ico d-flex align-items-center" id="export-ledger"
                                        href="javascript:void(0)" [matTooltip]="commonLocaleData?.app_export"
                                        [matTooltipPosition]="'above'" (click)="showExportLedgerModal()">
                                        <i class="icon-ledger-union-5 lh-0"></i>
                                    </a>
                                    <a mat-button class="icomoon-ico d-flex align-items-center" id="delete-bank-transaction"
                                        href="javascript:void(0)" [matTooltip]="localeData?.delete_bank_transactions"
                                        [matTooltipPosition]="'above'" (click)="showBulkDeleteBankTransactionsConfirmationModal()" *ngIf="entryUniqueNamesForBulkAction?.length > 0">
                                        <i class="icon-trash lh-0"></i>
                                    </a>
                                    <a mat-button class="icomoon-ico d-flex align-items-center mr-0" id="reload-bank-transaction"
                                        href="javascript:void(0)" [matTooltip]="localeData?.reload_bank_transactions"
                                        [matTooltipPosition]="'above'" (click)="getBankTransactions()">
                                        <i class="icon-refresh lh-0 font-18"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="isLedgerAccountAllowsMultiCurrency && isMobileScreen" class="advance-search-block mr-t05">
                        <span class="mr-r15 d-inline-block font-14">{{ baseCurrencyDetails?.code }}</span>
                        <div class="toggle d-inline-block currency-toggler" data-key="disabled">
                            <mat-slide-toggle [(ngModel)]="currencyTogglerModel" (change)="toggleCurrency($event)"></mat-slide-toggle>
                        </div>
                        <span class="mr-l15 d-inline-block font-14">{{ foreignCurrencyDetails?.code }}</span>
                    </div>
                    <!-- endregion -->
                    <div class="custom-tabs mt-2 mb-2">
                        <ul class="nav nav-tabs pt-0">
                            <li [ngClass]="{'active': visibleTransactionTypeMobile === 'all'}">
                                <a href="javascript:void(0)" id="ledger-all-tab"
                                    (click)="toggleMobileTransactionType('all');">{{commonLocaleData?.app_all}}</a>
                            </li>
                            <li role="presentation" [ngClass]="{'active': visibleTransactionTypeMobile === 'debit'}">
                                <a href="javascript:void(0)" id="ledger-debit-tab"
                                    (click)="toggleMobileTransactionType('debit')">{{commonLocaleData?.app_debit}}</a>
                            </li>
                            <li role="presentation" [ngClass]="{'active': visibleTransactionTypeMobile === 'credit'}">
                                <a href="javascript:void(0)" id="ledger-credit-tab"
                                    (click)="toggleMobileTransactionType('credit')">{{commonLocaleData?.app_credit}}</a>
                            </li>
                        </ul>
                    </div>

                    <!-- region bank ledgers-->
                    <div class="clearfix"></div>
                    <div *ngIf="!isMobileScreen">
                        <h1 class="mr-t2 primary-color" [hidden]="!isBankTransactionLoading">
                            {{localeData?.loading_transactions}}</h1>
                        <section id="eledgerwrap" class="mr-t2" [hidden]="(!lc.showEledger || isBankTransactionLoading)">
                            <div class="alert alert-danger ledger-book fade in position-relative pd-r15">
                                <button mat-button type="button" class="close">
                                    <span class="font-12 font-weight-normal"
                                        (click)="hideEledgerWrap()">{{commonLocaleData?.app_close}}</span>
                                </button>

                                <div>
                                    <div class="clearfix ledger-top-header-left">
                                        <h3 class="ledger-main-head">
                                            <span>{{localeData?.mapped_account_transactions}}</span>
                                        </h3>
                                    </div>
                                </div>
                                <div class="wrap-transaction-map clearfix">
                                    <div class="row">
                                        <div class="px-3 w-100">
                                            <table mat-table class="ledger-head transaction-mapped mt-0" width="100%" colspan="100%">
                                                <ng-container matColumnDef="debit">
                                                    <th colspan="6" class="pd-l15 pr-2 font-14" mat-header-cell *matHeaderCellDef> {{commonLocaleData?.app_debit}} <span
                                                        class="pull-right text-gray">{{localeData?.dr}}</span> </th>
                                                </ng-container>
                                                <ng-container matColumnDef="credit">
                                                    <th colspan="6" class="pd-r15 pl-1 font-14" mat-header-cell *matHeaderCellDef> {{commonLocaleData?.app_credit}} <span
                                                        class="pull-right text-gray">{{localeData?.cr}}</span> </th>
                                                </ng-container>
                                                <tr mat-header-row *matHeaderRowDef="bankTransactionsTableHeadingColumns"></tr>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="ledger-book">
                                        <div class="left-col-new">
                                            <table mat-table [dataSource]="lc.bankTransactionsDebitData" [trackBy]="trackById" id="ledger-transaction-left-list" class="width-100"
                                                (clickOutside)="hideBankLedgerPopup($event)"
                                                (click)="$event.stopPropagation()">

                                                <ng-container *ngFor="let column of bankTransactionsTable;" [matColumnDef]="column.columnDef">
                                                    <th [ngClass]="{'col-3 col-md-3 col-lg-3' : column.columnDef === 'date', 'col-5 col-md-6 col-lg-6' : column.columnDef === 'particular', 'col-4 col-md-3 col-lg-3 text-right': column.columnDef === 'amount'}" mat-header-cell *matHeaderCellDef>
                                                        {{ column.columnDef === 'date' ? commonLocaleData?.app_date : column.columnDef === 'particular' ? commonLocaleData?.app_particular :  commonLocaleData?.app_amount }}
                                                    </th>
                                                    <td mat-cell *matCellDef="let item">
                                                        <ng-container *ngIf="column.columnDef === 'date'">
                                                            <div class="d-flex align-items-center">
                                                                <span class="pd-l05 checkbox-span">
                                                                    <mat-checkbox
                                                                        [id]="'transaction-mapped-select-entry-dr-' + item.index"
                                                                        (change)="selectEntryForBulkAction($event, item)"
                                                                        [disabled]="(currentOrganizationType === 'COMPANY' && currentCompanyBranches?.length > 2)"></mat-checkbox>
                                                                </span>
                                                                <span class="mr-l05">
                                                                    <giddh-datepicker name="bsdateledger" [(ngModel)]="item.entryDate" (dateSelected)="onChangeEntryDate(item)"></giddh-datepicker>
                                                                </span>
                                                            </div>
                                                        </ng-container>
                                                        <ng-container *ngIf="column.columnDef === 'particular'">
                                                            <div class="w-100"
                                                                (click)="item.transactions[0].showDropdown = true;showBankLedgerPopup(item.transactions[0], item);">
                                                                <span
                                                                    [ngClass]="{'account-placeholder': true, 'account-placeholder-text': item.transactions[0].selectedAccount && item.transactions[0].selectedAccount.name}"
                                                                    *ngIf="!item.transactions[0].showDropdown">{{item.transactions[0].selectedAccount
                                                                    ? (item.transactions[0].selectedAccount.name) :
                                                                    commonLocaleData?.app_select_accounts}}</span>
                                                                <sh-select *ngIf="item.transactions[0].showDropdown"
                                                                    class="transaction-list-sh-select"
                                                                    #debitShSelect
                                                                    (viewInitEvent)="debitShSelect?.show()"
                                                                    [options]="searchResults"
                                                                    [(ngModel)]="item.transactions[0].particular"
                                                                    [disabled]="(currentOrganizationType === 'COMPANY' && currentCompanyBranches?.length > 2)"
                                                                    [isPaginationEnabled]="true"
                                                                    (scrollEnd)="handleScrollEnd()"
                                                                    (dynamicSearchedQuery)="onSearchQueryChanged($event)"
                                                                    [notFoundMsg]="noResultsFoundLabel"
                                                                    [showSearchSuggestion]="!(currentOrganizationType === 'COMPANY' && currentCompanyBranches?.length > 2)"
                                                                    [readonlyInput]="currentOrganizationType === 'COMPANY' && currentCompanyBranches?.length > 2"
                                                                    [enableDynamicSearch]="true"
                                                                    (selected)="selectAccount($event, item.transactions[0])"
                                                                    [placeholder]="commonLocaleData?.app_select_accounts"
                                                                    [notFoundLink]="true"
                                                                    (noResultsClicked)="toggleAsidePane()"
                                                                    [showClear]="false" [multiple]="false"
                                                                    [ItemHeight]="67"
                                                                    [useInBuiltFilterForFlattenAc]="true">
                                                                    <ng-template #optionTemplate
                                                                        let-option="option">
                                                                        <ng-container
                                                                            *ngIf="!option.additional?.stock">
                                                                            <a href="javascript:void(0)" class="list-item">
                                                                                <div class="item">{{ option.label }}</div>
                                                                                <div class="item-unique">{{ option.additional?.uniqueName }}</div>
                                                                            </a>
                                                                        </ng-container>
                                                                        <ng-container
                                                                            *ngIf="option.additional?.stock">
                                                                            <a href="javascript:void(0)" class="list-item">
                                                                                <div class="item">{{ option.label }}</div>
                                                                                <div class="item-unique">{{ option.additional?.uniqueName }}</div>
                                                                                <div class="item-stock">{{commonLocaleData?.app_stock}}: {{ option.additional?.stock.name }}</div>
                                                                            </a>
                                                                        </ng-container>
                                                                    </ng-template>
                                                                </sh-select>
                                                                <ul class="no-result-template"
                                                                    *ngIf="lc.noAccountChosenForNewEntry">
                                                                    <li>{{localeData?.create_account}}</li>
                                                                </ul>
                                                            </div>
                                                        </ng-container>
                                                        <ng-container *ngIf="column.columnDef === 'amount'">
                                                            <input matInput class="form-control text-right" type="text"
                                                                [id]="'enter-amount-dr-' + item.index"
                                                                decimalDigitsDirective [DecimalPlaces]="2"
                                                                [(ngModel)]="item.transactions[0].amount"
                                                                (input)="needToReCalculate.next(true)"
                                                                (click)="blankLedgerAmountClick()"
                                                                (click)="showBankLedgerPopup(item.transactions[0], item);">
                                                        </ng-container>
                                                        <div class="position-absolute entry-modal"
                                                            *ngIf="lc.showBankLedgerPanel && lc.currentBlankTxn?.id === item.transactions[0].id">
                                                            <new-ledger-entry-panel #newLedPanel
                                                                [trxRequest]="advanceSearchRequest"
                                                                [isBankTransaction]="true" [blankLedger]="item"
                                                                [currentTxn]="lc.currentBlankTxn"
                                                                [needToReCalculate]="needToReCalculate"
                                                                [isReadOnly]="(currentOrganizationType === 'COMPANY' && currentCompanyBranches?.length > 2)"
                                                                (moreDetailOpen)="handleOpenMoreDetail($event)"
                                                                (changeTransactionType)="toggleTransactionType($event)"
                                                                [showTaxationDiscountBox]="lc.currentBlankTxn.showTaxationDiscountBox"
                                                                (saveBlankLedger)="saveBankTransaction()"
                                                                (clickedOutsideEvent)="hideBankLedgerPopup($event)"
                                                                (clickUnpaidInvoiceList)="clickUnpaidInvoiceList($event)"
                                                                [invoiceList]="invoiceList"
                                                                (getInvoiceListsForCreditNote)="getInvoiceListsForCreditNote($event)"
                                                                [isTouristSchemeApplicable]="isTouristSchemeApplicable"
                                                                (saveOtherTax)="saveOtherTax(item, $event)"
                                                                [localeData]="localeData"
                                                                [commonLocaleData]="commonLocaleData">
                                                            </new-ledger-entry-panel>
                                                        </div>
                                                    </td>
                                                </ng-container>
                                                
                                                <tr mat-header-row *matHeaderRowDef="bankTransactionsTableColumns"></tr>
                                                <mat-row *matRowDef="let row; columns: bankTransactionsTableColumns;"></mat-row>
                                            </table>
                                        </div>
                                        <div class="right-col-new">
                                            <table mat-table [dataSource]="lc.bankTransactionsCreditData" [trackBy]="trackById" id="ledger-transaction-right-list" class="width-100"
                                                (clickOutside)="hideBankLedgerPopup($event)"
                                                (click)="$event.stopPropagation()">

                                                <ng-container *ngFor="let column of bankTransactionsTable;" [matColumnDef]="column.columnDef">
                                                    <th [ngClass]="{'col-3 col-md-3 col-lg-3' : column.columnDef === 'date', 'col-5 col-md-6 col-lg-6' : column.columnDef === 'particular', 'col-4 col-md-3 col-lg-3 text-right': column.columnDef === 'amount'}" mat-header-cell *matHeaderCellDef>
                                                        {{ column.columnDef === 'date' ? commonLocaleData?.app_date : column.columnDef === 'particular' ? commonLocaleData?.app_particular :  commonLocaleData?.app_amount }}
                                                    </th>
                                                    <td mat-cell *matCellDef="let item">
                                                        <ng-container *ngIf="column.columnDef === 'date'">
                                                            <div class="d-flex align-items-center">
                                                                <span class="pd-l05 checkbox-span">
                                                                    <mat-checkbox
                                                                        [id]="'transaction-mapped-select-entry-cr-' + item.index"
                                                                        (change)="selectEntryForBulkAction($event, item)"
                                                                        [disabled]="(currentOrganizationType === 'COMPANY' && currentCompanyBranches?.length > 2)"></mat-checkbox>
                                                                </span>
                                                                <span class="mr-l05">
                                                                    <giddh-datepicker name="bsdateledger" [(ngModel)]="item.entryDate" (dateSelected)="onChangeEntryDate(item)"></giddh-datepicker>
                                                                </span>
                                                            </div>
                                                        </ng-container>
                                                        <ng-container *ngIf="column.columnDef === 'particular'">
                                                            <div class="w-100"
                                                                (click)="item.transactions[0].showDropdown = true;showBankLedgerPopup(item.transactions[0], item);">
                                                                <span
                                                                    [ngClass]="{'account-placeholder': true, 'account-placeholder-text': item.transactions[0].selectedAccount && item.transactions[0].selectedAccount.name}"
                                                                    *ngIf="!item.transactions[0].showDropdown">{{item.transactions[0].selectedAccount
                                                                    ? (item.transactions[0].selectedAccount.name) :
                                                                    commonLocaleData?.app_select_accounts}}</span>
                                                                <sh-select *ngIf="item.transactions[0].showDropdown"
                                                                    class="transaction-list-sh-select"
                                                                    #creditShSelect
                                                                    (viewInitEvent)="creditShSelect?.show()"
                                                                    [options]="searchResults"
                                                                    [(ngModel)]="item.transactions[0].particular"
                                                                    [disabled]="(currentOrganizationType === 'COMPANY' && currentCompanyBranches?.length > 2)"
                                                                    (selected)="selectAccount($event,item.transactions[0])"
                                                                    [isPaginationEnabled]="true"
                                                                    (scrollEnd)="handleScrollEnd()"
                                                                    (dynamicSearchedQuery)="onSearchQueryChanged($event)"
                                                                    [notFoundMsg]="noResultsFoundLabel"
                                                                    [showSearchSuggestion]="!(currentOrganizationType === 'COMPANY' && currentCompanyBranches?.length > 2)"
                                                                    [readonlyInput]="currentOrganizationType === 'COMPANY' && currentCompanyBranches?.length > 2"
                                                                    [enableDynamicSearch]="true"
                                                                    [placeholder]="commonLocaleData?.app_select_accounts"
                                                                    [notFoundLink]="true"
                                                                    (noResultsClicked)="toggleAsidePane()"
                                                                    [multiple]="false" [ItemHeight]="67"
                                                                    [showClear]="false"
                                                                    [useInBuiltFilterForFlattenAc]="true">
                                                                    <ng-template #optionTemplate
                                                                        let-option="option">
                                                                        <ng-container
                                                                            *ngIf="!option.additional?.stock">
                                                                            <a href="javascript:void(0)"
                                                                                class="list-item">
                                                                                <div class="item">{{ option.label }}</div>
                                                                                <div class="item-unique">{{ option.additional?.uniqueName }}</div>
                                                                            </a>
                                                                        </ng-container>
                                                                        <ng-container
                                                                            *ngIf="option.additional?.stock">
                                                                            <a href="javascript:void(0)"
                                                                                class="list-item">
                                                                                <div class="item">{{ option.label }}</div>
                                                                                <div class="item-unique">{{ option.additional?.uniqueName }}</div>
                                                                                <div class="item-stock">{{commonLocaleData?.app_stock}}: {{ option.additional?.stock.name }}</div>
                                                                            </a>
                                                                        </ng-container>
                                                                    </ng-template>
                                                                </sh-select>
                                                                <ul class="no-result-template"
                                                                    *ngIf="lc.noAccountChosenForNewEntry">
                                                                    <li>{{localeData?.create_account}}</li>
                                                                </ul>
                                                            </div>
                                                        </ng-container>
                                                        <ng-container *ngIf="column.columnDef === 'amount'">
                                                            <input matInput class="form-control text-right" type="text"
                                                                [id]="'enter-amount-cr-' + item.index"
                                                                decimalDigitsDirective [DecimalPlaces]="2"
                                                                [(ngModel)]="item.transactions[0].amount"
                                                                (input)="needToReCalculate.next(true)"
                                                                (click)="blankLedgerAmountClick()"
                                                                (click)="showBankLedgerPopup(item.transactions[0], item);">
                                                        </ng-container>
                                                        <div class="position-absolute entry-modal"
                                                            *ngIf="lc.showBankLedgerPanel && lc.currentBlankTxn?.id === item.transactions[0].id">
                                                            <new-ledger-entry-panel #newLedPanel
                                                                [trxRequest]="advanceSearchRequest"
                                                                [isBankTransaction]="true" [blankLedger]="item"
                                                                [currentTxn]="lc.currentBlankTxn"
                                                                [needToReCalculate]="needToReCalculate"
                                                                [isReadOnly]="(currentOrganizationType === 'COMPANY' && currentCompanyBranches?.length > 2)"
                                                                (moreDetailOpen)="handleOpenMoreDetail($event)"
                                                                (changeTransactionType)="toggleTransactionType($event)"
                                                                [showTaxationDiscountBox]="lc.currentBlankTxn.showTaxationDiscountBox"
                                                                (saveBlankLedger)="saveBankTransaction()"
                                                                (clickedOutsideEvent)="hideBankLedgerPopup($event)"
                                                                (clickUnpaidInvoiceList)="clickUnpaidInvoiceList($event)"
                                                                (getInvoiceListsForCreditNote)="getInvoiceListsForCreditNote($event)"
                                                                [invoiceList]="invoiceList"
                                                                (saveOtherTax)="saveOtherTax(item, $event)"
                                                                [localeData]="localeData"
                                                                [commonLocaleData]="commonLocaleData">
                                                            </new-ledger-entry-panel>
                                                        </div>
                                                    </td>
                                                </ng-container>
                                                
                                                <tr mat-header-row *matHeaderRowDef="bankTransactionsTableColumns"></tr>
                                                <mat-row *matRowDef="let row; columns: bankTransactionsTableColumns;"></mat-row>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div class="text-center mr-t2 page-count position-absolute">
                                    <span class="grey">{{ bankTransactionsResponse?.totalItems }}
                                        {{localeData?.transactions}}, </span>
                                    <span class="black">{{ bankTransactionsResponse?.totalPages }}
                                        {{localeData?.pages}}</span>
                                    <pagination
                                        [totalItems]="(bankTransactionsResponse?.countPerPage)*(bankTransactionsResponse?.totalPages)"
                                        [itemsPerPage]="bankTransactionsResponse?.countPerPage" [maxSize]="5"
                                        class="pagination-sm" [(ngModel)]="bankTransactionsResponse.page"
                                        (pageChanged)="bankTransactionPageChanged($event)" [boundaryLinks]="true"
                                        [firstText]="commonLocaleData?.app_first"
                                        [previousText]="commonLocaleData?.app_previous"
                                        [nextText]="commonLocaleData?.app_next" [lastText]="commonLocaleData?.app_last">
                                    </pagination>
                                </div>
                                <table class="w-100">
                                    <tr>
                                        <td colspan="12" class="py-2 px-3 font-14">
                                            <div class="pull-right" *ngIf="eLedgType == 'CREDIT'">
                                                {{localeData?.cf_balance}}
                                                <span class="pd-l15 digit-blue d-inline-flex" *ngIf="eLedgType == 'CREDIT'">
                                                    <amount-field [amount]="eDrBalAmnt" [currencySymbol]="false"
                                                        [currencyCode]="false">
                                                    </amount-field>
                                                </span>
                                            </div>
                                        </td>
                                        <td colspan="12" class="bd-rl py-2 px-3 font-14" *ngIf="eLedgType == 'DEBIT'">
                                            <div class="pull-right">
                                                {{localeData?.cf_balance}}
                                                <span class="pd-l15 digit-blue d-inline-flex" *ngIf="eLedgType == 'DEBIT'">
                                                    <amount-field [amount]="eCrBalAmnt" [currencySymbol]="false"
                                                        [currencyCode]="false">
                                                    </amount-field>
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </section>
                    </div>
                    <!-- endregion -->
                    <!-- region account table-->
                    <!-- Need to make this code correctly working -->
                    <table mat-table class="col-sm-12 ledger-head mr-t1 width-100"
                    *ngIf="!isMobileScreen || (isMobileScreen && visibleTransactionTypeMobile !== 'all')">
                        <ng-container matColumnDef="debit">
                            <th [ngClass]="(Shown && !isMobileScreen) || (isMobileScreen && visibleTransactionTypeMobile === 'debit') ? 'active' : ''"
                            class="col-sm-6 hidden-xs sticky-header pr-0" mat-header-cell *matHeaderCellDef> <b> {{lc.ledgerUnderStandingObj.text.dr}}</b>
                            <span class="dr-cr-category pull-right text-gray">{{localeData?.dr}}</span> </th>
                        </ng-container>
                        <ng-container matColumnDef="credit">
                            <th [ngClass]="(!Shown && !isMobileScreen) || (isMobileScreen && visibleTransactionTypeMobile === 'credit') ? 'active' : ''"
                            class="col-sm-6 hidden-xs sticky-header pl-0" mat-header-cell *matHeaderCellDef> <b> {{lc.ledgerUnderStandingObj.text.cr}}</b>
                            <span class="dr-cr-category pull-right text-gray">{{localeData?.cr}}</span> </th>
                        </ng-container>
                        <tr mat-header-row *matHeaderRowDef="ledgerTransactionsTableHeadingColumns"></tr>
                    </table>
                    <!-- endregion -->
                    <div class="mobile-ledger-view clearfix" *ngIf="isMobileScreen">
                        <ng-container *ngIf="allTransactionDates && allTransactionDates.length > 0">
                            <ng-container *ngFor="let transactionDate of allTransactionDates;">
                                <div class="border-none pt-0 pb-0">
                                    <div class="transaction-date pd-l15 pd-r15 pd-t05">
                                        {{transactionDate}}
                                    </div>
                                    <table width="100%" mat-table [dataSource]="allTransactionsList[transactionDate]">
                                        <ng-container matColumnDef="particular">
                                            <th mat-header-cell *matHeaderCellDef class="hide"></th>
                                            <td mat-cell *matCellDef="let transactions" class="pd-l15 pd-r15 relative"
                                                [ngClass]="{'compound-entry': transactions.entryUniqueName === lc.selectedTxnUniqueName || transactions.isChecked}"
                                                [matTooltip]="transactions.description"
                                                (mouseover)="entryHovered(transactions.entryUniqueName)"
                                                (mouseout)="selectedTrxWhileHovering = ''">
                                                <span class="pull-left account-holder-checkbox">
                                                    <mat-checkbox [id]="'mobile-view-select-entry-cr-' + transactions.index"
                                                        [ngClass]="{'d-none': (selectedTrxWhileHovering !== transactions.entryUniqueName && !(transactions.isChecked) && checkedTrxWhileHovering?.length === 0)}"
                                                        [(ngModel)]="transactions.isChecked"
                                                        (change)="entrySelected($event, transactions.entryUniqueName, visibleTransactionTypeMobile)"></mat-checkbox>
                                                </span>
                                                <span class="account-holder-name">
                                                    <span *ngIf="transactions.type === 'CREDIT'"
                                                        class="text-gray mr-r05">{{localeData?.by}}</span>
                                                    <span *ngIf="transactions.type === 'DEBIT'"
                                                        class="text-gray mr-r05">{{localeData?.to}}</span>
                                                    <span>{{ transactions?.inventory ? transactions?.particular?.name +
                                                        ' (' + transactions?.inventory?.stock?.name + ')' :
                                                        transactions?.particular?.name }}</span>
                                                    <span class="download-invoice-ledger d-flex"
                                                        *ngIf="transactions.attachedFileUniqueName"
                                                        (click)="downloadAttachedFile(transactions.attachedFileUniqueName , $event)">
                                                        <i class="icon-download-circle pull-left"></i>
                                                    </span>
                                                    <span class="download-invoice-ledger d-flex"
                                                        *ngIf="transactions.voucherGenerated"
                                                        (click)="downloadInvoice(transactions.voucherNumber, transactions.voucherGeneratedType, $event)">
                                                        <i class="icon-download-circle pull-left"></i>
                                                    </span>
                                                </span>
                                            </td>
                                        </ng-container>
                                        <ng-container matColumnDef="amount">
                                            <th mat-header-cell *matHeaderCellDef class="hide"></th>
                                            <td mat-cell *matCellDef="let transactions" class="pd-l15 pd-r15 text-right">
                                                <div class="d-flex justify-content-end">
                                                    <div>
                                                        <amount-field [amount]="transactions.amount"
                                                            [currencySymbol]="transactions.currencySymbol"
                                                            [currencyCode]="transactions.currencyCode">
                                                        </amount-field>
                                                        <p class="mb-0 amount-total"
                                                            *ngIf="isLedgerAccountAllowsMultiCurrency">
                                                            <amount-field [amount]="transactions.convertedAmount"
                                                                [currencySymbol]="transactions.convertedCurrencySymbol"
                                                                [currencyCode]="transactions.convertedCurrencyCode">
                                                            </amount-field>
                                                        </p>
                                                    </div>
                                                </div>
                                            </td>
                                        </ng-container>
                                        <tr mat-header-row *matHeaderRowDef="ledgerTransactionsTableMobileHeadingColumns"></tr>
                                        <tr mat-row *matRowDef="let row; columns: ledgerTransactionsTableMobileHeadingColumns;"></tr>
                                    </table>
                                </div>
                            </ng-container>
                        </ng-container>
                        <!-- region pagination -->
                        <div class="text-center mr-t2 page-count position-absolute">
                            <span class="grey">{{ (lc.transactionData$ | async)?.totalItems }}
                                {{localeData?.transactions}}, </span>
                            <span class="black">{{ (lc.transactionData$ | async)?.totalPages }}
                                {{localeData?.pages}}</span>
                            <div id="pagination" element-view-container-ref #paginationChild=elementviewcontainerref></div>
                        </div>
                        <!-- endregion -->
                    </div>
                    <!-- end mobile view -->
                    <!-- region main transactions-->
                    <div class="ledger-book" *ngIf="!isMobileScreen"
                        [navigationWalker]="{horizontal:'hr-item',vertical:'vr-item', ignore: 'no-tree'}"
                        #navigator="navigationWalker" #root (onReset)="initNavigator(navigator,root.children[0])"
                        (onLeft)="onLeftArrow(navigator,$event)" (onRight)="onRightArrow(navigator,$event)">

                        <!-- region debit transaction-->
                        <div [ngClass]="Shown ? 'active' : ''" hr-item
                            (ngInit)="initNavigator(navigator,$event?.nativeElement); navigator.nextVertical();"
                            class="left-col-new"
                            [ngClass]="{'bd-rr': (lc.transactionData$ | async)?.debitTransactions?.length >= (lc.transactionData$ | async)?.creditTransactions?.length}">

                            <!-- region debit transaction header-->
                            <table mat-table class="width-100 h-table table-head hidden-xs">
                                <ng-container matColumnDef="date">
                                    <th class="col-xs-3 col-md-3 col-lg-3" width="25%" mat-header-cell *matHeaderCellDef> <span class="cp">{{commonLocaleData?.app_date}}</span></th>
                                </ng-container>
                                <ng-container matColumnDef="particular">
                                    <th class="col-xs-5 col-md-6 col-lg-6" width="50%" mat-header-cell *matHeaderCellDef> {{commonLocaleData?.app_particular}}</th>
                                </ng-container>
                                <ng-container matColumnDef="amount">
                                    <th class="col-xs-4 col-md-3 col-lg-3 text-right" width="25%" mat-header-cell *matHeaderCellDef> {{commonLocaleData?.app_amount}}</th>
                                </ng-container>
                                <tr mat-header-row class="thead-background1 row" *matHeaderRowDef="ledgerTransactionsTableColumns"></tr>
                            </table>
                            <!-- endregion -->


                            <table class="width-100 h-table">
                                <tbody>
                                    <!-- region debit transaction if forwardedBalance -->
                                    <tr class="ledger-row row" container="body" vr-item tabindex="-1"
                                        *ngIf="ledgerTxnBalance?.forwardedBalance?.amount > 0 && ledgerTxnBalance?.forwardedBalance?.type === 'DEBIT'">
                                        <td class="col-xs-3 col-md-3 col-lg-3"
                                            [attr.data-title]="commonLocaleData?.app_date">
                                            <mat-checkbox id="select-entries-date-cr" [(ngModel)]="debitSelectAll"
                                                *ngIf="checkedTrxWhileHovering?.length > 0"
                                                (change)="selectAllEntries($event, 'debit')"></mat-checkbox>
                                        </td>
                                        <td [attr.data-title]="commonLocaleData?.app_particular"
                                            class="col-xs-5 col-md-6 col-lg-6">
                                            <span
                                                *ngIf="(lc.transactionData$ | async)?.page <= 1">{{localeData?.to_balance_bf}}
                                            </span>
                                        </td>
                                        <td [attr.data-title]="commonLocaleData?.app_amount"
                                            class="col-xs-4 col-md-3 col-lg-3 text-right">
                                            <div class="d-flex flex-column">
                                                <ng-container *ngIf="(lc.transactionData$ | async)?.page <= 1">
                                                    <span *ngIf="ledgerTxnBalance?.forwardedBalance?.type === 'DEBIT'">
                                                        <amount-field [amount]="ledgerTxnBalance?.forwardedBalance?.amount"
                                                            [currencySymbol]="ledgerTxnBalance?.currencySymbol"
                                                            [currencyCode]="ledgerTxnBalance?.currencyCode">
                                                        </amount-field>
                                                    </span><br>
                                                    <span class="amount-total" *ngIf="isLedgerAccountAllowsMultiCurrency">
                                                        <amount-field
                                                            [amount]="ledgerTxnBalance?.convertedForwardedBalance?.amount"
                                                            [currencySymbol]="ledgerTxnBalance?.convertedCurrencySymbol"
                                                            [currencyCode]="ledgerTxnBalance?.convertedCurrencyCode">
                                                        </amount-field>
                                                    </span>
                                                    <span
                                                        *ngIf="ledgerTxnBalance?.forwardedBalance?.type === 'CREDIT'">{{commonLocaleData?.app_numbers?.zero}}</span>
                                                </ng-container>
                                            </div>
                                        </td>
                                    </tr>
                                    <!-- endregion -->

                                    <!-- region debit transaction if no forwardedBalance -->
                                    <tr class="ledger-row row"
                                        *ngIf="(ledgerTxnBalance?.forwardedBalance?.type !== 'DEBIT') || (ledgerTxnBalance?.forwardedBalance?.amount == 0)">
                                        <td class="col-xs-3 col-md-3 col-lg-3" [attr.data-title]="commonLocaleData?.app_select_all">
                                            <mat-checkbox [(ngModel)]="debitSelectAll" id="select-entries-all-cr"
                                                *ngIf="checkedTrxWhileHovering?.length > 0"
                                                (change)="selectAllEntries($event, 'debit')"></mat-checkbox>
                                        </td>
                                        <td class="col-xs-5 col-md-6 col-lg-6"></td>
                                        <td class="col-xs-4 col-md-3 col-lg-3"></td>
                                    </tr>
                                    <!-- endregion -->

                                    <!-- region debit transaction loop over transactions -->
                                    <tr vr-item tabindex="-1" class="ledger-row row"
                                        *ngFor="let txn of (lc.transactionData$ | async)?.debitTransactions; let i = index; trackBy:trackByTransactionUniqueName"
                                        (dblclick)="showUpdateLedgerModal(txn)" (keydown.enter)="showUpdateLedgerModal(txn)"
                                        [ngClass]="{'compound-entry': txn.entryUniqueName === lc.selectedTxnUniqueName || txn.isChecked}"
                                        [matTooltip]="txn.description" [matTooltipPosition]="'right'" (mouseover)="entryHovered(txn.entryUniqueName)"
                                        (mouseout)="selectedTrxWhileHovering = ''">

                                        <td class="col-xs-3 col-md-3 col-lg-3"
                                            [attr.data-title]="commonLocaleData?.app_date">

                                            <div class="d-flex align-items-center">
                                                <span class='float-left'>
                                                    <mat-checkbox [id]="'select-entry-dr-' + i"
                                                        [ngClass]="{'d-none': (selectedTrxWhileHovering !== txn.entryUniqueName && !(txn.isChecked) && checkedTrxWhileHovering?.length === 0)}"
                                                        [(ngModel)]="txn.isChecked"
                                                        (change)="entrySelected($event, txn.entryUniqueName, 'debit')"></mat-checkbox>
                                                </span>
                                                <span>{{ txn.entryDate }}</span>
                                            </div>

                                        </td>

                                        <td class="col-xs-5 col-md-6 col-lg-6"
                                            [attr.data-title]="commonLocaleData?.app_particular">
                                            <div class="d-flex align-items-center justify-content-between w-100">

                                                <div class="text-ellipsis">
                                                    {{ txn | particular:'to':localeData?.by_particular:localeData?.to_particular }}
                                                </div>

                                                <span class="download-invoice-ledger d-flex"
                                                    *ngIf="txn.attachedFileUniqueName"
                                                    (click)="downloadAttachedFile(txn.attachedFileUniqueName , $event)"
                                                    [matTooltip]="localeData?.download_file + ' : ' + txn.attachedFileName"
                                                    [matTooltipPosition]="'right'">
                                                    <i class="icon-download-circle pull-left"></i>
                                                </span>
                                                <span class="download-invoice-ledger d-flex" *ngIf="txn.voucherGenerated"
                                                    (click)="downloadInvoice(txn.voucherNumber, txn.voucherGeneratedType, $event)"
                                                    [matTooltip]="commonLocaleData?.app_download + ' ' + (txn.voucherGeneratedType === 'sales' ? commonLocaleData?.app_invoice: commonLocaleData?.app_voucher) + ' : ' + txn.voucherNumber"
                                                    [matTooltipPosition]="'right'">
                                                    <i class="icon-download-circle pull-left"></i>
                                                </span>
                                            </div>
                                        </td>

                                        <td [ngClass]="{'multicurrency-amount':isLedgerAccountAllowsMultiCurrency}"
                                            class="col-xs-4 col-md-3 col-lg-3 position-relative text-right"
                                            [attr.data-title]="commonLocaleData?.app_amount">
                                            <amount-field [amount]="txn.amount" [currencySymbol]="txn.currencySymbol"
                                                [currencyCode]="txn.currencyCode">
                                            </amount-field>
                                            <p class="mb-0 amount-total" *ngIf="isLedgerAccountAllowsMultiCurrency">
                                                <amount-field [amount]="txn.convertedAmount"
                                                    [currencySymbol]="txn.convertedCurrencySymbol"
                                                    [currencyCode]="txn.convertedCurrencyCode">
                                                </amount-field>
                                            </p>
                                        </td>
                                    </tr>
                                    <!-- endregion -->
                                </tbody>
                            </table>

                            <!-- region blank ledger-->
                            <table class="width-100 h-table" no-tree (click)="$event.stopPropagation();"
                                id="blank-ledger-container" (clickOutside)="hideNewLedgerEntryPopup($event)">
                                <tbody>

                                    <tr *ngFor="let txn of lc.blankLedger.transactions; let i = index">

                                        <td class="width-100 no-left-border" *ngIf="txn.type === 'DEBIT'">

                                            <table class="width-100">
                                                <tbody class="ledger-main">
                                                    <tr class="ledger-row row" container="body">

                                                        <td class="col-xs-3 col-md-3 col-lg-3"
                                                            [attr.data-title]="commonLocaleData?.app_date">
                                                            <div class="d-flex align-items-center">
                                                                <span class="ledger-checkbox pull-left">

                                                                </span>
                                                                <giddh-datepicker name="ledgDate" [(ngModel)]="lc.blankLedger.entryDate" [placeholder]="lc.formatPlaceholder" (dateSelected)="getInvoiceListsForCreditNote(true)"></giddh-datepicker>
                                                            </div>
                                                        </td>

                                                        <td [attr.data-title]="commonLocaleData?.app_particular"
                                                            class="col-xs-5 col-md-6 col-lg-6 select2-parent select2-ledger"
                                                            (mousedown)="showNewLedgerEntryPopup(txn);">
                                                            <div class="ledger-account-label d-flex">
                                                                <span
                                                                    *ngIf="( (!shDebit.isOpen && txn.particular) ||
                                                                            (shDebit.isOpen && shDebit.filter))">{{localeData?.to}}
                                                                </span>
                                                                <sh-select [id]="'select-account-dr-' + i" [idEl]="txn.id"
                                                                    #shDebit [isPaginationEnabled]="true"
                                                                    (scrollEnd)="handleScrollEnd()"
                                                                    (dynamicSearchedQuery)="onSearchQueryChanged($event)"
                                                                    [enableDynamicSearch]="true"
                                                                    [notFoundMsg]="noResultsFoundLabel"
                                                                    [options]="searchResults" [(ngModel)]="txn.particular"
                                                                    vr-item tabindex="-1" #select [showClear]="false"
                                                                    (keydown.enter)="onEnter(select,txn)"
                                                                    (onShow)="isSelectOpen=true;"
                                                                    (onHide)="onSelectHide()"
                                                                    (selected)="selectAccount($event,txn)"
                                                                    (keydown)="keydownPressed($event)"
                                                                    [placeholder]="localeData?.to_select_accounts"
                                                                    [notFoundLink]="true"
                                                                    (noResultsClicked)="toggleAsidePane(null, shDebit)"
                                                                    [multiple]="false" [ItemHeight]="67"
                                                                    [useInBuiltFilterForFlattenAc]="true">
                                                                    <ng-template #optionTemplate let-option="option">
                                                                        <ng-container *ngIf="!option.additional?.stock">
                                                                            <a href="javascript:void(0)" class="list-item">
                                                                                <div class="item">{{ option.label }}</div>
                                                                                <div class="item-unique">
                                                                                    {{ option.additional?.uniqueName }}
                                                                                </div>
                                                                            </a>
                                                                        </ng-container>
                                                                        <ng-container *ngIf="option.additional?.stock">
                                                                            <a href="javascript:void(0)" class="list-item">
                                                                                <div class="item">{{ option.label }}</div>
                                                                                <div class="item-unique">
                                                                                    {{ option.additional?.uniqueName }}
                                                                                </div>
                                                                                <div class="item-stock">
                                                                                    {{commonLocaleData?.app_stock}}:
                                                                                    {{ option.additional?.stock.name }}
                                                                                </div>
                                                                            </a>
                                                                        </ng-container>
                                                                    </ng-template>
                                                                    <ng-template #notFoundLinkTemplate>
                                                                        <a [ngClass]="{'active': keydownClassAdded}"
                                                                            class="notfound-option"
                                                                            [keyboardShortcut]="'alt+c'"
                                                                            (onShortcutPress)="toggleAsidePane(null, shDebit)">
                                                                            <span class="pl-0"
                                                                                [ngClass]="{'active': keydownClassAdded}">Create
                                                                                {{localeData?.new_account}}</span>
                                                                            <span>{{commonLocaleData?.app_alt_c}}</span>
                                                                        </a>
                                                                    </ng-template>
                                                                </sh-select>
                                                            </div>
                                                            <ul class="no-result-template"
                                                                *ngIf="lc.noAccountChosenForNewEntry">
                                                                <li>{{localeData?.create_account}}</li>
                                                            </ul>
                                                        </td>

                                                        <td [attr.data-title]="commonLocaleData?.app_amount"
                                                            class="col-xs-4 col-md-3 col-lg-3 position-relative">
                                                            <input matInput class="form-control text-right" type="text"
                                                                [id]="'enter-bank-amount-dr-' + i"
                                                                [prefix]="selectedPrefixForCurrency"
                                                                [suffix]="selectedSuffixForCurrency"
                                                                [mask]="inputMaskFormat" [(ngModel)]="txn.amount"
                                                                (input)="handleAmountInput(txn);"
                                                                (click)="showNewLedgerEntryPopup(txn);blankLedgerAmountClick()">
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>

                                            <!--new ledge popup-->
                                            <div class="pos-abs entry-modal" (click)="shDebit?.hide()"
                                                *ngIf="lc.showNewLedgerPanel && lc.currentBlankTxn?.type === 'DEBIT' && lc.currentBlankTxn?.id === txn.id ">
                                                <new-ledger-entry-panel #newLedPanel [blankLedger]="lc.blankLedger"
                                                    [currentTxn]="lc.currentBlankTxn"
                                                    [needToReCalculate]="needToReCalculate" [tcsOrTds]="tcsOrTds"
                                                    [baseCurrencyDetails]="baseCurrencyDetails"
                                                    (moreDetailOpen)="handleOpenMoreDetail($event)"
                                                    [foreignCurrencyDetails]="foreignCurrencyDetails"
                                                    [giddhBalanceDecimalPlaces]="giddhBalanceDecimalPlaces"
                                                    [selectedCurrency]="selectedCurrency"
                                                    [selectedPrefixForCurrency]="selectedPrefixForCurrency"
                                                    [selectedSuffixForCurrency]="selectedSuffixForCurrency"
                                                    [isLedgerAccountAllowsMultiCurrency]="isLedgerAccountAllowsMultiCurrency"
                                                    [inputMaskFormat]="inputMaskFormat"
                                                    (changeTransactionType)="toggleTransactionType($event)"
                                                    [showTaxationDiscountBox]="lc.currentBlankTxn.showTaxationDiscountBox"
                                                    (resetBlankLedger)="resetBlankTransaction()"
                                                    (saveBlankLedger)="saveBlankTransaction()"
                                                    (clickedOutsideEvent)="hideNewLedgerEntryPopup()"
                                                    (getInvoiceListsForCreditNote)="getInvoiceListsForCreditNote($event)"
                                                    (clickUnpaidInvoiceList)="clickUnpaidInvoiceList($event)"
                                                    [invoiceList]="invoiceList"
                                                    [shouldShowRcmTaxableAmount]="shouldShowRcmTaxableAmount"
                                                    [shouldShowItcSection]="shouldShowItcSection"
                                                    [isTouristSchemeApplicable]="isTouristSchemeApplicable"
                                                    (saveOtherTax)="saveOtherTax(lc.blankLedger, $event)"
                                                    [localeData]="localeData" [commonLocaleData]="commonLocaleData">
                                                </new-ledger-entry-panel>
                                            </div>

                                        </td>
                                    </tr>

                                </tbody>
                            </table>
                            <!-- endregion -->
                        </div>
                        <!-- endregion -->

                        <!-- region credit transaction-->
                        <div [ngClass]="isHide ? 'active' : 'right-col-new'" class="right-col-new" hr-item
                            (ngInit)="initNavigator(navigator,$event?.nativeElement); navigator.nextVertical();"
                            [ngClass]="{'bd-rl': (lc.transactionData$ | async)?.debitTransactions?.length < (lc.transactionData$ | async)?.creditTransactions?.length}">
                            <!-- region credit transaction header-->
                            <table class="width-100 h-table hidden-xs">
                                <thead>
                                    <tr class="thead-background1 row">
                                        <th class="col-xs-3 col-md-3 col-lg-3" width="25%">
                                            <span class="cp">{{commonLocaleData?.app_date}}</span>
                                        </th>
                                        <th class="col-xs-5 col-md-6 col-lg-6" width="50%">
                                            {{commonLocaleData?.app_particular}}</th>
                                        <th class="col-xs-4 col-md-3 col-lg-3 text-right" width="25%">
                                            {{commonLocaleData?.app_amount}}</th>
                                    </tr>
                                </thead>
                            </table>
                            <!-- endregion -->

                            <table class="width-100 h-table">
                                <tbody>

                                    <!-- region credit transaction if forwardedBalance -->
                                    <tr class="ledger-row row" vr-item tabindex="-1"
                                        *ngIf="ledgerTxnBalance?.forwardedBalance?.amount > 0 && ledgerTxnBalance?.forwardedBalance?.type === 'CREDIT'">
                                        <td class="col-xs-3 col-md-3 col-lg-3"
                                            [attr.data-title]="commonLocaleData?.app_date">
                                            <mat-checkbox id="select-all-entries-dr" [(ngModel)]="creditSelectAll"
                                                *ngIf="checkedTrxWhileHovering?.length > 0"
                                                (change)="selectAllEntries($event,'credit')"></mat-checkbox>
                                        </td>
                                        <td [attr.data-title]="localeData?.bf_balance" class="col-xs-5 col-md-6 col-lg-6">
                                            <span *ngIf="(lc.transactionData$ | async)?.page <= 1">
                                                {{localeData?.by_balance_bf}} </span>
                                        </td>
                                        <td [attr.data-title]="commonLocaleData?.app_amount"
                                            class="col-xs-4 col-md-3 col-lg-3 text-right">
                                            <div class="d-flex flex-column">
                                                <ng-container *ngIf="(lc.transactionData$ | async)?.page <= 1">
                                                    <span *ngIf="ledgerTxnBalance?.forwardedBalance?.type === 'CREDIT'">
                                                        <amount-field [amount]="ledgerTxnBalance?.forwardedBalance?.amount"
                                                            [currencySymbol]="ledgerTxnBalance?.currencySymbol"
                                                            [currencyCode]="ledgerTxnBalance?.currencyCode">
                                                        </amount-field>

                                                    </span>
                                                    <span class="amount-total" *ngIf="isLedgerAccountAllowsMultiCurrency">
                                                        <amount-field
                                                            [amount]="ledgerTxnBalance?.convertedForwardedBalance?.amount"
                                                            [currencySymbol]="ledgerTxnBalance?.convertedCurrencySymbol"
                                                            [currencyCode]="ledgerTxnBalance?.convertedCurrencyCode">
                                                        </amount-field>

                                                    </span>
                                                    <span
                                                        *ngIf="ledgerTxnBalance?.forwardedBalance?.type === 'DEBIT'">{{commonLocaleData?.app_numbers?.zero}}</span>

                                                </ng-container>
                                            </div>

                                        </td>
                                    </tr>
                                    <!-- endregion -->

                                    <!-- region credit transaction no forwardedBalance -->
                                    <tr class="ledger-row row"
                                        *ngIf="ledgerTxnBalance?.forwardedBalance?.type !== 'CREDIT' || (ledgerTxnBalance?.forwardedBalance?.amount == 0)">
                                        <td class="col-xs-3 col-md-3 col-lg-3">
                                            <mat-checkbox id="select-all-entries-credit"
                                                [(ngModel)]="creditSelectAll" *ngIf="checkedTrxWhileHovering?.length > 0"
                                                (change)="selectAllEntries($event,'credit')"></mat-checkbox>
                                        </td>
                                        <td class="col-xs-5 col-md-6 col-lg-6"></td>
                                        <td class="col-xs-4 col-md-3 col-lg-3"></td>
                                    </tr>
                                    <!-- endregion -->

                                    <!-- region credit transaction loop over transactions -->
                                    <tr class="ledger-row row"
                                        *ngFor="let txn of (lc.transactionData$ | async)?.creditTransactions; let i = index; trackBy:trackByTransactionUniqueName"
                                        (dblclick)="showUpdateLedgerModal(txn)" vr-item tabindex="-1"
                                        (keydown.enter)="showUpdateLedgerModal(txn)"
                                        [ngClass]="{'compound-entry': txn.entryUniqueName === lc.selectedTxnUniqueName || txn.isChecked}"
                                        [matTooltip]="txn.description" [matTooltipPosition]="'right'"
                                        (mouseover)="entryHovered(txn.entryUniqueName)"
                                        (mouseout)="selectedTrxWhileHovering = ''">

                                        <td class="col-xs-3 col-md-3 col-lg-3"
                                            [attr.data-title]="commonLocaleData?.app_date">

                                            <div class="d-flex align-items-center">
                                                <span class="ledger-checkbox pull-left">

                                                    <mat-checkbox [id]="'select-entry-cr-' + i"
                                                        [ngClass]="{'d-none': (selectedTrxWhileHovering !== txn.entryUniqueName && !(txn.isChecked) && checkedTrxWhileHovering?.length === 0)}"
                                                        class="d-none" [(ngModel)]="txn.isChecked"
                                                        (change)="entrySelected($event, txn.entryUniqueName, 'credit')"></mat-checkbox>
                                                </span>
                                                <span>{{ txn.entryDate }}</span>
                                            </div>

                                        </td>

                                        <td class="col-xs-5 col-md-6 col-lg-6"
                                            [attr.data-title]="commonLocaleData?.app_particular">

                                            <div class="d-flex align-items-center justify-content-between w-100">
                                                <div class="text-ellipsis">
                                                    {{ txn | particular:'by':localeData?.by_particular:localeData?.to_particular }}
                                                </div>

                                                <span class="download-invoice-ledger d-flex"
                                                    *ngIf="txn.attachedFileUniqueName"
                                                    (click)="downloadAttachedFile(txn.attachedFileUniqueName , $event)"
                                                    [matTooltip]="localeData?.download_file + ' : ' + txn.attachedFileName"
                                                    [matTooltipPosition]="'right'">
                                                    <i class="icon-download-circle pull-left"></i>
                                                </span>
                                                <span class="download-invoice-ledger d-flex" *ngIf="txn.voucherGenerated"
                                                    (click)="downloadInvoice(txn.voucherNumber, txn.voucherGeneratedType, $event)"
                                                    [matTooltip]="commonLocaleData?.app_download + ' ' + (txn.voucherGeneratedType === 'sales' ? commonLocaleData?.app_invoice: commonLocaleData?.app_voucher) + ' : ' + txn.voucherNumber"
                                                    [matTooltipPosition]="'right'">
                                                    <i class="icon-download-circle pull-left"></i>
                                                </span>
                                            </div>
                                        </td>

                                        <td [ngClass]="{'multicurrency-amount':isLedgerAccountAllowsMultiCurrency}"
                                            [attr.data-title]="commonLocaleData?.app_amount"
                                            class="col-xs-4 col-md-3 col-lg-3 position-relative text-right">
                                            <amount-field [amount]="txn.amount" [currencySymbol]="txn.currencySymbol"
                                                [currencyCode]="txn.currencyCode">
                                            </amount-field>
                                            <p class="mb-0 amount-total" *ngIf="isLedgerAccountAllowsMultiCurrency">
                                                <amount-field [amount]="txn.convertedAmount"
                                                    [currencySymbol]="txn.convertedCurrencySymbol"
                                                    [currencyCode]="txn.convertedCurrencyCode">
                                                </amount-field>
                                            </p>
                                        </td>
                                    </tr>
                                    <!-- endregion -->
                                </tbody>
                            </table>

                            <!-- region blank ledger-->
                            <table class="width-100" no-tree (clickOutside)="hideNewLedgerEntryPopup($event)"
                                (click)="$event.stopPropagation()">
                                <tbody>

                                    <tr *ngFor="let txn of lc.blankLedger.transactions; let i = index">

                                        <td class="width-100" *ngIf="txn.type === 'CREDIT'">

                                            <table class="width-100 h-table">
                                                <tbody class="ledger-main">
                                                    <tr class="ledger-row row" container="body">
                                                        <td class="col-xs-3 col-md-3 col-lg-3"
                                                            [attr.data-title]="commonLocaleData?.app_date">
                                                            <div class="d-flex align-items-center">
                                                                <span class="ledger-checkbox pull-left">

                                                                </span>
                                                                <giddh-datepicker name="bsdateledger" [(ngModel)]="lc.blankLedger.entryDate"
                                                                [placeholder]="lc.formatPlaceholder"></giddh-datepicker>
                                                            </div>

                                                        </td>
                                                        <td class="col-xs-5 col-md-6 col-lg-6 select2-parent select2-ledger"
                                                            [attr.data-title]="commonLocaleData?.app_particular"
                                                            (mousedown)="showNewLedgerEntryPopup(txn);">

                                                            <div class="ledger-account-label d-flex">
                                                                <span
                                                                    *ngIf="(
                                                                    (!shCredit.isOpen && txn.particular) ||
                                                                    (shCredit.isOpen && shCredit.filter))">{{localeData?.by}}</span>

                                                                <sh-select [id]="'select-account-cr-' + i" [idEl]="txn.id"
                                                                    #shCredit [options]="searchResults" vr-item
                                                                    tabindex="-1" [isPaginationEnabled]="true"
                                                                    (scrollEnd)="handleScrollEnd()"
                                                                    (dynamicSearchedQuery)="onSearchQueryChanged($event)"
                                                                    [enableDynamicSearch]="true"
                                                                    [notFoundMsg]="noResultsFoundLabel" #select
                                                                    (keydown.enter)="onEnter(shCredit,txn)"
                                                                    (onShow)="isSelectOpen=true;"
                                                                    (onHide)="onSelectHide()" [(ngModel)]="txn.particular"
                                                                    (selected)="selectAccount($event,txn)"
                                                                    [showClear]="false"
                                                                    [placeholder]="localeData?.by_select_accounts"
                                                                    (keydown)="keydownPressed($event)" [notFoundLink]="true"
                                                                    (noResultsClicked)="toggleAsidePane(null, shCredit)"
                                                                    [multiple]="false" [ItemHeight]="67"
                                                                    [useInBuiltFilterForFlattenAc]="true">
                                                                    <ng-template #optionTemplate let-option="option">
                                                                        <ng-container *ngIf="!option.additional?.stock">
                                                                            <a href="javascript:void(0)" class="list-item">
                                                                                <div class="item">{{ option.label }}</div>
                                                                                <div class="item-unique">
                                                                                    {{ option.additional?.uniqueName }}
                                                                                </div>
                                                                            </a>
                                                                        </ng-container>
                                                                        <ng-container *ngIf="option.additional?.stock">
                                                                            <a href="javascript:void(0)" class="list-item">
                                                                                <div class="item">{{ option.label }}</div>
                                                                                <div class="item-unique">
                                                                                    {{ option.additional?.uniqueName }}
                                                                                </div>
                                                                                <div class="item-stock">
                                                                                    {{commonLocaleData?.app_stock}}:
                                                                                    {{ option.additional?.stock.name }}
                                                                                </div>
                                                                            </a>
                                                                        </ng-container>
                                                                    </ng-template>
                                                                    <ng-template #notFoundLinkTemplate>
                                                                        <a [ngClass]="{'active': keydownClassAdded}"
                                                                            class="notfound-option"
                                                                            [keyboardShortcut]="'alt+c'"
                                                                            (onShortcutPress)="toggleAsidePane(null, shCredit)">
                                                                            <span class="pl-0"
                                                                                [ngClass]="{'active': keydownClassAdded}">Create
                                                                                {{localeData?.new_account}}</span>
                                                                            <span>{{commonLocaleData?.app_alt_c}}</span>
                                                                        </a>
                                                                    </ng-template>
                                                                </sh-select>
                                                            </div>
                                                            <ul class="no-result-template"
                                                                *ngIf="lc.noAccountChosenForNewEntry">
                                                                <li>{{localeData?.create_account}}</li>
                                                            </ul>
                                                        </td>
                                                        <td class="col-xs-4 col-md-3 col-lg-3 position-relative"
                                                            [attr.data-title]="commonLocaleData?.app_amount">
                                                            <input matInput class="form-control text-right" type="text"
                                                                id="enter-bank-amount-cr"
                                                                [prefix]="selectedPrefixForCurrency"
                                                                [suffix]="selectedSuffixForCurrency"
                                                                [mask]="inputMaskFormat" [(ngModel)]="txn.amount"
                                                                (input)="handleAmountInput(txn);"
                                                                (click)="showNewLedgerEntryPopup(txn);blankLedgerAmountClick()">
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>

                                            <!--new ledge popup-->
                                            <div class="position-absolute entry-modal" (click)="shCredit?.hide()"
                                                (keydown)="$event.stopPropagation()"
                                                *ngIf="lc.showNewLedgerPanel && lc.currentBlankTxn?.type === 'CREDIT' && lc.currentBlankTxn?.id === txn.id ">
                                                <new-ledger-entry-panel #newLedPanel [blankLedger]="lc.blankLedger"
                                                    [currentTxn]="lc.currentBlankTxn"
                                                    [needToReCalculate]="needToReCalculate" [tcsOrTds]="tcsOrTds"
                                                    [baseCurrencyDetails]="baseCurrencyDetails"
                                                    [foreignCurrencyDetails]="foreignCurrencyDetails"
                                                    (moreDetailOpen)="handleOpenMoreDetail($event)"
                                                    [selectedCurrency]="selectedCurrency"
                                                    [giddhBalanceDecimalPlaces]="giddhBalanceDecimalPlaces"
                                                    [selectedPrefixForCurrency]="selectedPrefixForCurrency"
                                                    [selectedSuffixForCurrency]="selectedSuffixForCurrency"
                                                    [inputMaskFormat]="inputMaskFormat"
                                                    [isLedgerAccountAllowsMultiCurrency]="isLedgerAccountAllowsMultiCurrency"
                                                    (changeTransactionType)="toggleTransactionType($event)"
                                                    [showTaxationDiscountBox]="lc.currentBlankTxn.showTaxationDiscountBox"
                                                    (resetBlankLedger)="resetBlankTransaction()"
                                                    (saveBlankLedger)="saveBlankTransaction()"
                                                    (clickedOutsideEvent)="hideNewLedgerEntryPopup()"
                                                    (clickUnpaidInvoiceList)="clickUnpaidInvoiceList($event)"
                                                    (getInvoiceListsForCreditNote)="getInvoiceListsForCreditNote($event)"
                                                    [invoiceList]="invoiceList"
                                                    [shouldShowRcmTaxableAmount]="shouldShowRcmTaxableAmount"
                                                    [shouldShowItcSection]="shouldShowItcSection"
                                                    [isTouristSchemeApplicable]="isTouristSchemeApplicable"
                                                    (saveOtherTax)="saveOtherTax(lc.blankLedger, $event)"
                                                    [localeData]="localeData" [commonLocaleData]="commonLocaleData">
                                                </new-ledger-entry-panel>
                                            </div>

                                        </td>
                                    </tr>

                                </tbody>
                            </table>
                            <!-- endregion -->

                        </div>
                        <!--endregion-->

                        <!-- region footer-->
                        <div class="w-100">
                            <table class="ledger-footer-1 left-align">
                                <tbody>
                                    <tr class="total-col">
                                        <td colspan="12" class="col-xs-12 text-right white h32 pd-r1">
                                            <span *ngIf="ledgerTxnBalance?.closingBalance?.type === 'CREDIT'"
                                                [matTooltip]="lc.ledgerUnderStandingObj.balanceText.cr" [matTooltipPosition]="'left'">
                                                {{localeData?.to_balance_cf}}:
                                                <span class="digit-blue">
                                                    <div class="d-inline-flex">
                                                        <amount-field [amount]="ledgerTxnBalance?.closingBalance?.amount"
                                                            [currencySymbol]="ledgerTxnBalance?.currencySymbol"
                                                            [currencyCode]="ledgerTxnBalance?.currencyCode">
                                                        </amount-field>
                                                    </div>
                                                </span>
                                            </span>
                                        </td>
                                    </tr>
                                    <tr class="total-col">
                                        <td colspan="12" class="col-xs-12 text-right white h32 border-top pd-r1">
                                            <div class="d-flex flex-column">
                                                <span class="bd-rt padding-ledger">
                                                    <amount-field [amount]="lc.reckoningDebitTotal"
                                                        [currencySymbol]="ledgerTxnBalance?.currencySymbol"
                                                        [currencyCode]="ledgerTxnBalance?.currencyCode">
                                                    </amount-field>
                                                </span>
                                                <span class="bd-rt text-gray padding-ledger"
                                                    *ngIf="isLedgerAccountAllowsMultiCurrency">
                                                    <amount-field [amount]="lc.convertedReckoningDebitTotal"
                                                        [currencySymbol]="ledgerTxnBalance?.convertedCurrencySymbol"
                                                        [currencyCode]="ledgerTxnBalance?.convertedCurrencyCode">
                                                    </amount-field>
                                                </span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <table class="ledger-footer-1 right-align">
                                <tbody>

                                    <tr class="total-col">

                                        <td colspan="12" class="col-xs-12 text-right white h32 pd-r1">
                                            <span *ngIf="ledgerTxnBalance?.closingBalance?.type === 'DEBIT'"
                                                [matTooltip]="lc.ledgerUnderStandingObj.balanceText.dr" [matTooltipPosition]="'left'">
                                                <!-- By -->
                                                {{localeData?.by_balance_cf}}:
                                                <span class="digit-blue d-inline-flex">
                                                    <amount-field [amount]="ledgerTxnBalance?.closingBalance?.amount"
                                                        [currencySymbol]="ledgerTxnBalance?.currencySymbol"
                                                        [currencyCode]="ledgerTxnBalance?.currencyCode">
                                                    </amount-field>
                                                </span>
                                            </span>
                                        </td>

                                    </tr>

                                    <tr class="total-col">
                                        <td colspan="12" class="col-xs-12 text-right white h32 border-top pd-r1">

                                            <div class="d-flex flex-column">
                                                <span class="bd-rt padding-ledger">
                                                    <amount-field [amount]="lc.reckoningCreditTotal"
                                                        [currencySymbol]="ledgerTxnBalance?.currencySymbol"
                                                        [currencyCode]="ledgerTxnBalance?.currencyCode">
                                                    </amount-field>
                                                </span>

                                                <span class="bd-rt text-gray padding-ledger"
                                                    *ngIf="isLedgerAccountAllowsMultiCurrency">
                                                    <amount-field [amount]="lc.convertedReckoningCreditTotal"
                                                        [currencySymbol]="ledgerTxnBalance?.convertedCurrencySymbol"
                                                        [currencyCode]="ledgerTxnBalance?.convertedCurrencyCode">
                                                    </amount-field>
                                                </span>
                                            </div>

                                        </td>

                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <!-- endregion -->

                        <!-- region pagination -->
                        <div class="text-center mr-t2 page-count position-absolute">
                            <span class="grey">{{ (lc.transactionData$ | async)?.totalItems }}
                                {{localeData?.transactions}}, </span>
                            <span class="black">{{ (lc.transactionData$ | async)?.totalPages }}
                                {{localeData?.pages}}</span>
                            <div id="pagination" element-view-container-ref #paginationChild=elementviewcontainerref>

                            </div>

                        </div>
                        <!-- endregion -->
                    </div>
                    <!--endregion-->
                </div>
                <!--endregion-->
            </section>

            <div class="container" *ngIf="!isShowLedgerColumnarReportTable">
                <div>
                    <div class="text-right mr-t1 mr-b1" [hidden]="!isBankOrCashAccount">
                        <button mat-button [hidden]="!closingBalanceBeforeReconcile || showLoader" class="btn btn-primary btn-sm mr-0"
                            (click)="getReconciledBack();">{{commonLocaleData?.app_back}}
                        </button>
                        <div *ngIf="closingBalanceBeforeReconcile && !showLoader"
                            class="box balance-detail mr-t2 mr-b2 clearfix text-center">
                            <div class="row">
                                <div class="col-md-6 col-sm-6 col-12 text-right">{{localeData?.balance_bank}}
                                    <h3 class="font-20 primary-color">
                                        <span class="d-inline-flex">
                                            <amount-field [amount]="reconcileClosingBalanceForBank?.amount"
                                                [currencySymbol]="false" [currencyCode]="false">
                                            </amount-field>
                                            {{reconcileClosingBalanceForBank?.type}}
                                        </span>
                                    </h3>
                                </div>
                                <div class="col-md-6 col-sm-6 col-12 text-left">{{localeData?.pending_cheque}}
                                    <h3 class="font-20 primary-color">
                                        <span class="d-inline-flex">
                                            <amount-field [amount]="closingBalanceBeforeReconcile?.amount"
                                                [currencySymbol]="false" [currencyCode]="false">
                                            </amount-field>
                                            {{closingBalanceBeforeReconcile?.type}}
                                        </span>
                                    </h3>
                                </div>
                            </div>
                        </div>
                        <button mat-button [hidden]="closingBalanceBeforeReconcile || showLoader" class="btn btn-primary btn-sm mr-0"
                            (click)="getReconciliation();">{{localeData?.reconciliation}}
                        </button>
                    </div>
                </div>
            </div>

            <!-- region total section -->
            <!-- commented due to API  -->
            <div class="transaction-in-short" *ngIf="!isShowLedgerColumnarReportTable">
                <div class="container">
                    <section class="ledger-stat mr-t3" *ngIf="!showLoader">
                        <div class="row">
                            <div class="col-sm-3 col-xs-12 stat-block">
                                <div class="ledger-state-box">
                                    <h1>{{localeData?.total_transactions}}
                                        <span class="digit-blue d-inline-flex">
                                            <amount-field
                                                [amount]="(lc.transactionData$ | async)?.debitTransactionsCount + (lc.transactionData$ | async)?.creditTransactionsCount"
                                                [currencySymbol]="false" [currencyCode]="false">
                                            </amount-field>
                                        </span>
                                    </h1>
                                    <span class="mr-r2 grey-text-color">{{commonLocaleData?.app_debit}}
                                        <span class="digit-blue d-inline-flex">
                                            <amount-field [amount]="(lc.transactionData$ | async)?.debitTransactionsCount"
                                                [currencySymbol]="false" [currencyCode]="false">
                                            </amount-field>
                                        </span>
                                    </span><br>
                                    <span class="mr-r2 grey-text-color">{{commonLocaleData?.app_credit}}
                                        <span class="digit-blue d-inline-flex">
                                            <amount-field [amount]="(lc.transactionData$ | async)?.creditTransactionsCount"
                                                [currencySymbol]="false" [currencyCode]="false">
                                            </amount-field>
                                        </span>
                                    </span>
                                </div>
                            </div>
                            <div class="col-sm-3 col-xs-12 stat-block">
                                <div class="ledger-state-box">
                                    <h1>{{localeData?.opening_balance}}</h1>
                                    <h3 class="digit-blue d-flex">
                                        <amount-field [amount]="ledgerTxnBalance?.forwardedBalance?.amount"
                                            [currencySymbol]="ledgerTxnBalance?.currencySymbol"
                                            [currencyCode]="ledgerTxnBalance?.currencyCode">
                                        </amount-field>
                                        &nbsp;
                                        {{ ledgerTxnBalance?.forwardedBalance?.amount > 0 ?
                                        (ledgerTxnBalance?.forwardedBalance?.type === 'DEBIT' ? localeData?.dr :
                                        localeData?.cr) : '' }}
                                    </h3>

                                    <h3 class="digit-blue font-12 sub-total d-inline-flex"
                                        *ngIf="isLedgerAccountAllowsMultiCurrency">
                                        <amount-field [amount]="ledgerTxnBalance?.convertedForwardedBalance?.amount"
                                            [currencySymbol]="ledgerTxnBalance?.convertedCurrencySymbol"
                                            [currencyCode]="ledgerTxnBalance?.convertedCurrencyCode">
                                        </amount-field>

                                        &nbsp;
                                        {{ ledgerTxnBalance?.convertedForwardedBalance?.amount > 0 ?
                                        (ledgerTxnBalance?.forwardedBalance?.type === 'DEBIT' ? localeData?.dr :
                                        localeData?.cr) : '' }}

                                    </h3>

                                </div>
                            </div>

                            <div class="col-sm-3 col-xs-12 stat-block">
                                <div class="ledger-state-box">
                                    <h1>{{localeData?.net_total}}</h1>
                                    <div class="d-flex justify-content-between">
                                        <div *ngIf="ledgerTxnBalance?.creditTotal > ledgerTxnBalance?.debitTotal">
                                            <h3 class="digit-blue d-flex">
                                                <amount-field
                                                    [amount]="ledgerTxnBalance?.creditTotal - ledgerTxnBalance?.debitTotal"
                                                    [currencySymbol]="ledgerTxnBalance?.currencySymbol"
                                                    [currencyCode]="ledgerTxnBalance?.currencyCode">
                                                </amount-field>
                                                &nbsp;
                                                <span class="capitalize">{{commonLocaleData?.app_cr}}</span>
                                            </h3>

                                            <h3 class="digit-blue sub-total font-12 d-inline-flex"
                                                *ngIf="isLedgerAccountAllowsMultiCurrency">
                                                <amount-field
                                                    [amount]="ledgerTxnBalance?.convertedCreditTotal - ledgerTxnBalance?.convertedDebitTotal"
                                                    [currencySymbol]="ledgerTxnBalance?.convertedCurrencySymbol"
                                                    [currencyCode]="ledgerTxnBalance?.convertedCurrencyCode">
                                                </amount-field>
                                                &nbsp;
                                                <span class="capitalize">{{commonLocaleData?.app_cr}}</span>
                                            </h3>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <div *ngIf="ledgerTxnBalance?.creditTotal < ledgerTxnBalance?.debitTotal">
                                            <h3 class="digit-blue d-inline-flex">
                                                <amount-field
                                                    [amount]="ledgerTxnBalance?.debitTotal - ledgerTxnBalance?.creditTotal"
                                                    [currencySymbol]="ledgerTxnBalance?.currencySymbol"
                                                    [currencyCode]="ledgerTxnBalance?.currencyCode">
                                                </amount-field>
                                                &nbsp;
                                                <span class="capitalize">{{commonLocaleData?.app_dr}}</span>
                                            </h3>

                                            <h3 class="digit-blue sub-total font-12 d-inline-flex"
                                                *ngIf="isLedgerAccountAllowsMultiCurrency">
                                                <amount-field
                                                    [amount]="ledgerTxnBalance?.convertedDebitTotal - ledgerTxnBalance?.convertedCreditTotal"
                                                    [currencySymbol]="ledgerTxnBalance?.convertedCurrencySymbol"
                                                    [currencyCode]="ledgerTxnBalance?.convertedCurrencyCode">
                                                </amount-field>
                                                &nbsp;
                                                <span class="capitalize">{{commonLocaleData?.app_dr}}</span>
                                            </h3>
                                        </div>
                                    </div>
                                    <br>

                                    <div class="d-flex debit-credit-amount">

                                        <h1 class="mr-t05 font-16 grey-text-color d-flex flex-column">
                                            {{commonLocaleData?.app_debit}}
                                            <span class="digit-blue mt-1 d-inline-flex">
                                                <amount-field [amount]="ledgerTxnBalance?.debitTotal"
                                                    [currencySymbol]="ledgerTxnBalance?.currencySymbol"
                                                    [currencyCode]="ledgerTxnBalance?.currencyCode">
                                                </amount-field>
                                            </span>
                                            <span class="digit-blue font-12 sub-total d-inline-flex"
                                                *ngIf="isLedgerAccountAllowsMultiCurrency">
                                                <amount-field [amount]="ledgerTxnBalance?.convertedDebitTotal"
                                                    [currencySymbol]="ledgerTxnBalance?.convertedCurrencySymbol"
                                                    [currencyCode]="ledgerTxnBalance?.convertedCurrencyCode">
                                                </amount-field>
                                            </span>
                                        </h1>

                                        <h1 class="mr-t05 font-16 grey-text-color d-flex flex-column">
                                            {{commonLocaleData?.app_credit}}
                                            <span class="digit-blue d-flex mt-1">
                                                <amount-field [amount]="ledgerTxnBalance?.creditTotal"
                                                    [currencySymbol]="ledgerTxnBalance?.currencySymbol"
                                                    [currencyCode]="ledgerTxnBalance?.currencyCode">
                                                </amount-field>
                                            </span>
                                            <span class="digit-blue font-12 sub-total d-flex"
                                                *ngIf="isLedgerAccountAllowsMultiCurrency">
                                                <amount-field [amount]="ledgerTxnBalance?.convertedCreditTotal"
                                                    [currencySymbol]="ledgerTxnBalance?.convertedCurrencySymbol"
                                                    [currencyCode]="ledgerTxnBalance?.convertedCurrencyCode">
                                                </amount-field>
                                            </span>
                                        </h1>

                                    </div>

                                </div>
                            </div>

                            <div class="col-sm-3 col-xs-12 stat-block">
                                <div class="ledger-state-box">
                                    <h1>{{localeData?.closing_balance}}</h1>
                                    <div class="d-flex flex-column justify-content-between">
                                        <h3 class="digit-blue d-inline-flex">
                                            <span class="d-flex"
                                                [matTooltip]="(ledgerTxnBalance?.closingBalance?.type === 'DEBIT' ? lc.ledgerUnderStandingObj.balanceText.dr : lc.ledgerUnderStandingObj.balanceText.cr)">
                                                <amount-field [amount]="ledgerTxnBalance?.closingBalance?.amount"
                                                    [currencySymbol]="ledgerTxnBalance?.currencySymbol"
                                                    [currencyCode]="ledgerTxnBalance?.currencyCode">
                                                </amount-field>
                                                &nbsp;
                                                {{ ledgerTxnBalance?.closingBalance?.amount > 0 ?
                                                (ledgerTxnBalance?.closingBalance?.type === 'DEBIT' ? localeData?.dr :
                                                localeData?.cr) : '' }}
                                            </span>
                                        </h3>
                                        <h3 class="digit-blue d-flex"
                                            *ngIf="isLedgerAccountAllowsMultiCurrency">
                                            <span class="d-flex"
                                                [matTooltip]="(ledgerTxnBalance?.closingBalance?.type === 'DEBIT' ? lc.ledgerUnderStandingObj.balanceText.dr : lc.ledgerUnderStandingObj.balanceText.cr)">
                                                <amount-field [amount]="ledgerTxnBalance?.convertedClosingBalance?.amount"
                                                    [currencySymbol]="ledgerTxnBalance?.convertedCurrencySymbol"
                                                    [currencyCode]="ledgerTxnBalance?.convertedCurrencyCode">
                                                </amount-field>
                                                &nbsp;
                                                {{ ledgerTxnBalance?.convertedClosingBalance?.amount > 0 ?
                                                (ledgerTxnBalance?.convertedClosingBalance?.type === 'DEBIT'
                                                ? localeData?.dr : localeData?.cr) : '' }}
                                            </span>
                                        </h3>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>

            <div class="show-if-ledger-open" *ngIf="isMoreDetailsOpened">
            </div>
            <!-- modal sections -->

            <div *ngIf="isShowLedgerColumnarReportTable">
                <div class="back-btn text-right pr-1 mt-1 mr-b1">
                    <button mat-button class="btn btn-default"
                        (click)="isShowLedgerColumnarReportTable=false">{{commonLocaleData?.app_back}}</button>
                </div>
                <ledger-columnar-report-table [columnarReportExportRequest]="columnarReportExportRequest"
                    [accountUniquename]="accountUniquename" (backClick)="isShowLedgerColumnarReportTable=false">
                </ledger-columnar-report-table>
            </div>

            <!-- aside menu section -->
            <div class="aside-overlay" *ngIf="asideMenuState === 'in'"></div>
            <ledger-aside-pane [class]="asideMenuState" *ngIf="asideMenuState === 'in'" [@slideInOut]="asideMenuState"
                [keyboardShortcut]="'esc'" [localeData]="localeData" [commonLocaleData]="commonLocaleData"
                (onShortcutPress)="toggleAsidePane()" (closeAsideEvent)="toggleAsidePane()">
            </ledger-aside-pane>
            <!-- aside menu section -->

            <!-- update ladger entry popup -->
            <div bsModal #updateLedgerModal="bs-modal" class="modal fade update-ledger-modal" role="dialog"
                [config]="{keyboard: true}" tabindex="-1">
                <div class="modal-dialog modal-xl modal-ledger">
                    <div class="modal-content">
                        <div element-view-container-ref #updateledgercomponent=elementviewcontainerref>
                        </div>
                    </div>
                </div>
                <div class="show-if-update-ledger-open">
                </div>
            </div>
            <!-- update ladger entry popup -->

            <!-- aside menu section -->
            <div class="aside-overlay" *ngIf="asideMenuStateForOtherTaxes === 'in'"></div>
            <app-aside-menu-sales-other-taxes *ngIf="asideMenuStateForOtherTaxes === 'in' && updateLedgerComponentInstance"
                [class]="asideMenuStateForOtherTaxes" [taxes]="companyTaxesList"
                [otherTaxesModal]="updateLedgerComponentInstance.vm.selectedLedger.otherTaxModal"
                [commonLocaleData]="commonLocaleData" [@slideInOut]="asideMenuStateForOtherTaxes"
                (closeModal)="toggleOtherTaxesAsidePane(null)"
                (applyTaxes)="calculateOtherTaxes($event);toggleOtherTaxesAsidePane(null);">
            </app-aside-menu-sales-other-taxes>

            <!-- endregion -->
            <ng-template #datepickerTemplate>
                <div class="datepicker-modal">
                    <div class="modal-body">
                        <app-datepicker-wrapper [inputStartDate]="selectedDateRange?.startDate"
                            [inputEndDate]="selectedDateRange?.endDate" [alwaysShowCalendars]="true"
                            [ranges]="datePickerRanges" [selectedRangeLabel]="selectedRangeLabel"
                            [showCustomRangeLabel]="true" [showClearButton]="false" [showCancel]="true"
                            [linkedCalendars]="true" [showDropdowns]="true"
                            (rangeClicked)="dateSelectedCallback($event)" (datesUpdated)="dateSelectedCallback($event)"
                            [keepCalendarOpeningWithRange]="false" [showRangeLabelOnInput]="false"
                            [dateFieldPosition]="dateFieldPosition"></app-datepicker-wrapper>
                    </div>
                </div>
            </ng-template>
        </ng-container>
    </div>
</ng-container>
