<div class="add-company-wrapper">
    <ng-container
        appTranslate
        [file]="'create-company'"
        (localeData)="localeData = $event"
        (commonLocaleData)="commonLocaleData = $event"
    >
        <div>
            <p class="text-center p-3">{{ localeData?.create_company_note }}</p>
        </div>
        <mat-stepper linear #stepper [formGroup]="companyForm" name="companyForm" autocomplete="off" novalidate>
            <mat-step [stepControl]="firstStepForm">
                <form [formGroup]="firstStepForm" name="firstStepForm" autocomplete="off" novalidate>
                    <ng-template matStepLabel>{{ commonLocaleData?.app_company_name }}</ng-template>
                    <div class="row row-gap">
                        <div class="col-lg-12">
                            <input-field
                                [name]="'name'"
                                [placeholder]="commonLocaleData?.app_company_name + '*'"
                                [type]="'text'"
                                formControlName="name"
                                [showError]="isFormSubmitted && !firstStepForm.get('name')?.value"
                            >
                            </input-field>
                        </div>
                        <div class="col-lg-6 country-space">
                            <dropdown-field
                                [name]="'country'"
                                [placeholder]="commonLocaleData?.app_country + '*'"
                                [options]="countries"
                                (selectedOption)="selectCountry($event)"
                                [showError]="isFormSubmitted && !firstStepForm.get('country')?.value"
                            >
                            </dropdown-field>
                        </div>
                        <div class="col-lg-6 currency-space">
                            <dropdown-field
                                [name]="'currency'"
                                [placeholder]="commonLocaleData?.app_currency + '*'"
                                [options]="currencies"
                                [showError]="isFormSubmitted && !firstStepForm.get('currency')?.value"
                                [defaultValue]="firstStepForm.get('currency')?.value?.value"
                                (selectedOption)="selectCurrency($event)"
                            >
                            </dropdown-field>
                        </div>
                        <div class="col-lg-12 mobile-number pb-3 pt-1">
                            <input-field
                                [name]="'mobile'"
                                [type]="'tel'"
                                #mobileNo
                                [id]="'init-contact-proforma'"
                                (keydown.enter)="$event.preventDefault()"
                                [label]="commonLocaleData?.app_mobile_number + '*'"
                                [placeholder]="commonLocaleData?.app_mobile_number + '*'"
                                [floatLabel]="intl?.getNumber() ? 'always' : 'auto'"
                                (onChange)="firstStepForm.controls['mobile'].setValue(intl?.getNumber())"
                                [showError]="
                                    isFormSubmitted && !firstStepForm.get('mobile')?.value && isMobileNumberInvalid
                                "
                            >
                            </input-field>
                            <span id="init-contact-proforma-valid-msg" class="d-none"></span>
                            <span id="init-contact-proforma-error-msg" class="d-none"></span>
                        </div>
                    </div>
                    <div>
                        <button mat-stroked-button color="primary" matStepperNext (click)="nextStepForm()">
                            {{ commonLocaleData?.app_next }}
                        </button>
                    </div>
                </form>
            </mat-step>
            <mat-step [stepControl]="secondStepForm" name="secondStepForm" autocomplete="off" novalidate>
                <form [formGroup]="secondStepForm">
                    <ng-template matStepLabel>{{ localeData?.company_address }}</ng-template>
                    <div class="row row-gap">
                        <div class="col-lg-12 fill-form">
                            <input-field
                                [placeholder]="firstStepForm.get('name')?.value"
                                [placeholder]="commonLocaleData?.app_company_name + '*'"
                                [type]="'text'"
                                [readonly]="true"
                                [floatLabel]="'always'"
                            >
                            </input-field>
                        </div>
                        <div class="col-lg-6 country-space">
                            <dropdown-field
                                [readonly]="true"
                                [label]="commonLocaleData?.app_country + '*'"
                                [defaultValue]="firstStepForm.get('country')?.value.label"
                            >
                            </dropdown-field>
                        </div>
                        <div class="col-lg-6 currency-space">
                            <dropdown-field
                                [readonly]="true"
                                [label]="commonLocaleData?.app_currency + '*'"
                                [defaultValue]="firstStepForm.get('currency')?.value.value"
                            >
                            </dropdown-field>
                        </div>
                        <div class="col-lg-12 mobile-number fill-form">
                            <img
                                class="country-flag"
                                *ngIf="firstStepForm.get('country')?.value.value"
                                src="https://cdn.jsdelivr.net/gh/hjnilsson/country-flags@master/svg/{{
                                    firstStepForm.get('country')?.value.value?.toLowerCase()
                                }}.svg"
                                width="27"
                            />
                            <input-field
                                [name]="'mobile'"
                                [type]="'tel'"
                                [label]="commonLocaleData?.app_mobile_number + '*'"
                                [placeholder]="firstStepForm.controls['mobile'].value"
                                [floatLabel]="'always'"
                            >
                            </input-field>
                        </div>
                        <div class="col-lg-12" *ngIf="isOtherCountry">
                            <dropdown-field
                                [name]="'businessType'"
                                [placeholder]="localeData?.select_business_type"
                                [options]="businessTypeOtherCountryOptions"
                                (selectedOption)="selectBusinessType($event)"
                                [defaultValue]="businessTypeOtherCountryOptions[0].label"
                            >
                            </dropdown-field>
                        </div>
                        <div class="col-lg-12" *ngIf="!isOtherCountry">
                            <dropdown-field
                                [name]="'businessType'"
                                [placeholder]="localeData?.select_business_type"
                                [options]="businessTypeList"
                                (selectedOption)="selectBusinessType($event)"
                            >
                            </dropdown-field>
                        </div>
                        <div class="col-lg-12">
                            <dropdown-field
                                [name]="'bussinessNature'"
                                [placeholder]="localeData?.select_business_nature"
                                [options]="businessNatureList"
                                (selectedOption)="selectBusinessNature($event)"
                            >
                            </dropdown-field>
                        </div>
                        <div class="col-lg-12" *ngIf="secondStepForm.controls['businessType']?.value === 'Registered'">
                            <input-field
                                [name]="'gstin'"
                                [placeholder]="getEnterTaxText()"
                                [type]="'text'"
                                formControlName="gstin"
                                [showError]="isGstinValid && !secondStepForm.get('gstin')?.value"
                                [label]="formFields['taxName']?.label + '*'"
                                [maxlength]="15"
                            >
                            </input-field>
                        </div>
                        <div class="col-lg-12" *ngIf="secondStepForm.controls['businessType']?.value === 'Registered'">
                            <dropdown-field
                                [name]="'state'"
                                [placeholder]="commonLocaleData?.app_state + '*'"
                                [options]="states"
                                [showError]="isFormSubmitted && !secondStepForm.get('state')?.value"
                                [readonly]="isGstinValid"
                                [label]="isGstinValid ? commonLocaleData?.app_state + '*' : ''"
                                [defaultValue]="selectedState"
                            >
                            </dropdown-field>
                        </div>
                        <div class="col-lg-12" *ngIf="secondStepForm.controls['businessType']?.value === 'Registered'">
                            <mat-form-field class="w-100" appearance="outline">
                                <mat-label>{{ localeData?.applicable_tax }}</mat-label>
                                <mat-select
                                    [placeholder]="commonLocaleData?.app_select_tax"
                                    [formControlName]="'taxes'"
                                    multiple
                                >
                                    <mat-option *ngFor="let tax of taxesList" [value]="tax?.value">{{
                                        tax?.label
                                    }}</mat-option>
                                    <mat-option
                                        class="create-update-no-data"
                                        [disabled]="true"
                                        *ngIf="!taxesList?.length"
                                        >{{ commonLocaleData?.app_no_result_found }}</mat-option
                                    >
                                </mat-select>
                            </mat-form-field>
                        </div>
                        <div
                            class="col-lg-12"
                            *ngIf="
                                secondStepForm.controls['businessType']?.value === localeData?.unregistered ||
                                secondStepForm.controls['businessType']?.value === localeData?.registered
                            "
                        >
                            <input-field
                                [name]="'pincode'"
                                [placeholder]="'PIN Code'"
                                [type]="'text'"
                                formControlName="pincode"
                            >
                            </input-field>
                        </div>
                        <div
                            class="col-lg-12"
                            *ngIf="
                                secondStepForm.controls['businessType']?.value === localeData?.unregistered ||
                                secondStepForm.controls['businessType']?.value === localeData?.registered
                            "
                        >
                            <mat-form-field appearance="outline" class="w-100">
                                <mat-label>Company Address</mat-label>
                                <textarea matInput rows="3" [name]="'address'" formControlName="address"></textarea>
                            </mat-form-field>
                        </div>
                        <div class="col-lg-12">
                            <p class="pb-4">{{ localeData?.onboarding_note }}</p>
                            <p
                                class="taxation-not-supported"
                                [innerHTML]="localeData?.tax_reports_note"
                                *ngIf="isOtherCountry"
                            ></p>
                        </div>
                    </div>
                    <div class="pt-4">
                        <button mat-stroked-button matStepperPrevious class="mr-3">
                            {{ commonLocaleData?.app_back }}
                        </button>
                        <button mat-stroked-button color="primary" (click)="onSubmit()">
                            {{ commonLocaleData?.app_submit }}
                        </button>
                    </div>
                </form>
            </mat-step>
        </mat-stepper>
    </ng-container>
</div>
