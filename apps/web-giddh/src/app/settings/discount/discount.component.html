<ng-container
    appTranslate
    [file]="'settings/discount'"
    (localeData)="localeData = $event"
    (commonLocaleData)="commonLocaleData = $event"
    (translationComplete)="translationComplete($event)"
>
    <div class="box clearfix">
        <div class="row">
            <h1 class="section-head pt-0 col-sm-12">{{ localeData?.tab_heading }}</h1>
        </div>

        <form #discountForm="ngForm" novalidate (submit)="submit()" class="discount-form-setting-tab">
            <div class="row align-items-center mt-2">
                <div class="col-xl-2 col-md-6 col-xs-12">
                    <div class="discount-type">
                        <dropdown-field
                            [options]="discountTypeList"
                            [name]="'type'"
                            [placeholder]="localeData?.discount_type_placeholder"
                            (selectedOption)="createRequest.type = $event.value"
                        ></dropdown-field>
                    </div>
                </div>
                <div class="col-xl-2 col-md-6 col-xs-12" *ngIf="createRequest.type">
                    <input-field
                        [label]="commonLocaleData?.app_name"
                        [type]="'text'"
                        [(ngModel)]="createRequest.name"
                        [name]="'name'"
                        [placeholder]="commonLocaleData?.app_name"
                    ></input-field>
                </div>

                <div class="col-xl-2 col-md-6 col-xs-12" *ngIf="createRequest.type">
                    <input-field
                        [label]="commonLocaleData?.app_value"
                        [type]="'text'"
                        [(ngModel)]="createRequest.discountValue"
                        [name]="'value'"
                        [placeholder]="commonLocaleData?.app_value"
                    ></input-field>
                </div>

                <div class="col-xl-2 col-md-6 col-xs-12" *ngIf="createRequest.type">
                    <!-- <sh-select
                        [isFilterEnabled]="true"
                        [notFoundLink]="true"
                        name="account"
                        [(ngModel)]="createRequest.accountUniqueName"
                        [placeholder]="localeData?.linked_accounts_placeholder"
                        [showNotFoundLinkAsDefault]="true"
                        [options]="accounts"
                        [ItemHeight]="'max-content'"
                        (noResultsClicked)="toggleAccountAsidePane($event)"
                        class="select-linked-accounts"
                    >
                    </sh-select> -->
                    <dropdown-field
                        [label]="localeData?.linked_accounts_label"
                        [name]="'account'"
                        [placeholder]="localeData?.linked_accounts_placeholder"
                        [showNotFoundLinkAsDefault]="true"
                        [options]="accounts"
                        [ItemHeight]="'max-content'"
                        [cssClass]="select - linked - accounts"
                        (selectedOption)="(createRequest.accountUniqueName)"
                        (createOption)="toggleAccountAsidePane($event)"
                        [showCreateNew]="true"
                        [hasMoreValue]="true"
                    ></dropdown-field>
                </div>

                <div class="col-xl-2 col-md-6 col-xs-12 hide-lable-on-mobile" *ngIf="createRequest.type">
                    <button
                        mat-stroked-button
                        color="primary"
                        type="submit"
                        class="btn"
                        *ngIf="!createRequest.discountUniqueName"
                        [ladda]="isLoading$ | async"
                    >
                        {{ commonLocaleData?.app_add }}
                    </button>
                    <button
                        mat-stroked-button
                        color="primary"
                        type="submit"
                        class="btn"
                        *ngIf="createRequest.discountUniqueName"
                        [ladda]="isLoading$ | async"
                    >
                        {{ commonLocaleData?.app_update }}
                    </button>
                </div>
            </div>
        </form>

        <div>
            <div class="row">
                <div class="col-lg-12">
                    <!-- <table class="table table-bordered basic mr-b05 on-mobile-view">
                        <thead [hidden]="!discountList?.length">
                            <tr>
                                <th [style.width.px]="'50'">#</th>
                                <th>{{ commonLocaleData?.app_name }}</th>
                                <th>{{ commonLocaleData?.app_action }}</th>
                            </tr>
                        </thead>

                        <tbody *ngIf="!isLoading">
                            <tr *ngFor="let discount of discountList; let i = index">
                                <td data-title="#">{{ i + 1 }}</td>
                                <td [attr.data-title]="commonLocaleData?.app_name">{{ discount.name }}</td>
                                <td [attr.data-title]="commonLocaleData?.app_action" class="icon-btn">
                                    <span (click)="edit(discount)" class="btn btn-xs">
                                        <i class="icon-edit-pencil"></i>
                                    </span>
                                    <span (click)="showDeleteDiscountModal(discount?.uniqueName)" class="btn btn-xs">
                                        <i class="fa fa-trash"></i>
                                    </span>
                                </td>
                            </tr>
                        </tbody>
                        <tbody *ngIf="isLoading">
                            <tr>
                                <td colspan="3" class="text-center empty-table">
                                    <giddh-page-loader [cssClass]="'mt-0 mb-0'"></giddh-page-loader>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="no-data" *ngIf="!isLoading && !discountList?.length">
                        <no-data [secondaryMessage]="' '" [secondaryMessageClass]="'p-0'"></no-data>
                    </div> -->

                    <!-- mat-table -->
                    <table mat-table [dataSource]="dataSource" class="table basic mr-b05 on-mobile-view w-100">
                        <ng-container matColumnDef="number">
                            <th mat-header-cell *matHeaderCellDef>#</th>
                            <td mat-cell *matCellDef="let element">{{ element.number }}</td>
                        </ng-container>
                        <ng-container matColumnDef="name">
                            <th mat-header-cell *matHeaderCellDef>{{ commonLocaleData?.app_name }}</th>
                            <td mat-cell *matCellDef="let element">{{ element.name }}</td>
                        </ng-container>
                        <ng-container matColumnDef="action">
                            <th class="text-right" mat-header-cell *matHeaderCellDef>{{ commonLocaleData?.app_action }}</th>
                            <td mat-cell *matCellDef="let element" class="icon-btn text-right">
                                <button mat-stroked-button (click)="edit(element)" class="p-0 mr-3 action-btn">
                                    <i class="icon-edit-pencil"></i>
                                </button>
                                <button mat-stroked-button (click)="showDeleteDiscountModal(discount?.uniqueName)" class="p-0 action-btn">
                                    <i class="fa fa-trash"></i>
                                </button>
                            </td>
                        </ng-container>
                        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- open account aside -->
    <ng-template #createNew>
        <aside-menu-account
            *ngIf="accountAsideMenuState === 'in'"
            [class]="accountAsideMenuState"
            [@slideInOut]="accountAsideMenuState"
            (closeAsideEvent)="toggleAccountAsidePane($event)"
            [activeGroupUniqueName]="'discount'"
            [commonLocaleData]="commonLocaleData"
        ></aside-menu-account>
    </ng-template>

    <!--delete discount confirmation model -->
    <ng-template #discountConfirmationModel>
        <div class="modal-md">
            <div class="modal-content">
                <confirm-modal
                    [body]="localeData?.delete_discount"
                    (successCallBack)="delete()"
                    (cancelCallBack)="hideDeleteDiscountModal()"
                ></confirm-modal>
            </div>
        </div>
    </ng-template>
</ng-container>
