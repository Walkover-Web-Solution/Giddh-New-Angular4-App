<div class="clearfix" *ngIf="!parentCompanyName && (branches$ | async)?.length > 0">
    <div class="d-flex date-advance-search row">
        <form class="form-inline input-group-date-range-picker pr col-xs-6 col-sm-8 mb-15">
            <div class="mr-1 d-flex branch-header-content">
                <div class="input-group">
                    <div class="form-group">
                        <span class="icon-calender" (click)="dp.toggle()"></span> <input type="text" readonly
                            placeholder="Select Date" class="form-control" #dp="bsDaterangepicker"
                            [bsValue]="dateRangePickerValue" (bsValueChange)="setFilterDate($event)" bsDaterangepicker>
                    </div>
                </div>
                <div class="content-view  mrL2">
                    <div class="branch-views">
                        <span (click)="changeBranchViewType('table');" class="mrR1">
                            <input id="radio-table" name="signatureType" class="radio-custom" name="radio-view"
                                type="radio" [checked]="(branchViewType === 'table') ? true : false" checked>
                            <label for="radio-table" class="radio-custom-label">Table View</label>
                        </span>
                        <span (click)="changeBranchViewType('card');">
                            <input id="radio-card" name="signatureType" class="radio-custom" name="radio-view"
                                type="radio" [checked]="(branchViewType === 'card') ? true : false">
                            <label for="radio-card" class="radio-custom-label">Card View</label>
                        </span>
                    </div>
                </div>
            </div>
        </form>
        <div class="col-sm-4 col-xs-6">
            <button class="btn btn-sky-blue pull-right mr-0" (click)="openAddBranchModal()"> + New Branch</button>
        </div>
    </div>
</div>
<div *ngIf="(branches$ | async)?.length > 0 && branchViewType === 'table' && !isMobileScreen " class="table-responsive">
    <table class="table basic giddh-table on-mobile-view">
        <thead>
            <tr>
                <th>Branch Name</th>
                <th *ngIf="formFields['taxName']">{{formFields['taxName'].label}}</th>
                <th>Contact No.</th>
                <th class="text-right">Total Sales</th>
                <th class="text-right">Total Expenses</th>
                <th class="text-right">Total Taxes</th>
                <th class="text-right">Action</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let branch of branches$ | async">
                <td data-title="Branch Name">{{branch.name}}</td>
                <td data-title="{{formFields['taxName'].label}}" *ngIf="formFields['taxName']">{{branch?.addresses[0]?.taxNumber}}</td>
                <td data-title="Contact No.">{{branch.contactNo}}</td>
                <td data-title="Total Sales" class="text-right"><span
                        *ngIf="branch && branch.companyTotals && branch.companyTotals.sales && branch.companyTotals.sales.amount">{{branch.companyTotals.sales.amount | giddhCurrency}}</span><span
                        *ngIf="!(branch && branch.companyTotals && branch.companyTotals.sales && branch.companyTotals.sales.amount)">0</span>
                </td>
                <td class="text-right" data-title="Total Expenses"><span
                        *ngIf="branch && branch.companyTotals && branch.companyTotals.expenses && branch.companyTotals.expenses.amount">{{branch.companyTotals.expenses.amount | giddhCurrency}}</span><span
                        *ngIf="!(branch && branch.companyTotals && branch.companyTotals.expenses && branch.companyTotals.expenses.amount)">0</span>
                </td>
                <td class="text-right" data-title="Total Taxes"><span
                        *ngIf="branch && branch.companyTotals && branch.companyTotals.taxes && branch.companyTotals.taxes.amount">{{branch.companyTotals.taxes.amount | giddhCurrency}}</span><span
                        *ngIf="!(branch && branch.companyTotals && branch.companyTotals.taxes && branch.companyTotals.taxes.amount)">0</span>
                </td>
                <td data-title="Action" class="text-right unlink">
                    <a (click)="removeBranch(branch.uniqueName, branch.name)">Delink</a></td>
            </tr>
        </tbody>
    </table>
</div>
<div *ngIf="(branches$ | async)?.length > 0">
    <div class="branch-card-view" *ngIf="branchViewType === 'card'">
        <div class="row">
            <div class="col-md-6 col-lg-4 col-sm-12" *ngFor="let branch of branches$ | async">
                <div class="branch-card">
                    <div class="card-basic-details">
                        <div class="clearfix">
                            <h2 class="pull-left">{{branch.name}}</h2>
                            <div class="pull-right">
                                <div class="btn-group" dropdown [autoClose]="true">
                                    <a id="button-basic" dropdownToggle type="button"
                                        class="icon-dots-three-vertical dropdown-toggle" aria-controls="dropdown-basic">

                                    </a>
                                    <ul id="dropdown-basic" *dropdownMenu class="dropdown-menu" role="menu"
                                        aria-labelledby="button-basic">
                                        <li role="menuitem"><a class="dropdown-item"
                                                (click)="removeBranch(branch.uniqueName, branch.name)">Delink</a></li>

                                    </ul>
                                </div>

                            </div>

                        </div>

                        <div class="clearfix">
                            <span class="mrR1 pull-left">Contact:</span>
                            <span class="pull-left">{{branch.contactNo}}</span>
                        </div>
                        <div class="clearfix" *ngIf="formFields['taxName']">
                            <span class="mrR1 pull-left">{{formFields['taxName'].label}}:</span>
                            <span class="pull-left">{{branch?.addresses[0]?.taxNumber}}</span>
                        </div>
                        <div class="clearfix">
                            <span class="mrR1 pull-left">Address:</span>
                            <span class="pull-left">{{branch?.addresses[0]?.address}}</span>
                        </div>
                    </div>
                    <div class="branchSalesDetails">
                        <div class="clearfix">
                            <span class="pull-left">
                                <label>Total Sales</label>
                            </span>
                            <span class="pull-right"
                                *ngIf="branch && branch.companyTotals && branch.companyTotals.sales && branch.companyTotals.sales.amount">{{branch.companyTotals.sales.amount | giddhCurrency}}</span>
                            <span class="pull-right"
                                *ngIf="!(branch && branch.companyTotals && branch.companyTotals.sales && branch.companyTotals.sales.amount)">0</span>
                        </div>
                        <div class="clearfix">
                            <span class="pull-left">
                                <label>Total Expenses</label>
                            </span>
                            <span class="pull-right"
                                *ngIf="branch && branch.companyTotals && branch.companyTotals.expenses && branch.companyTotals.expenses.amount">{{branch.companyTotals.expenses.amount | giddhCurrency}}</span>
                            <span class="pull-right"
                                *ngIf="!(branch && branch.companyTotals && branch.companyTotals.expenses && branch.companyTotals.expenses.amount)">0</span>
                        </div>
                        <div class="clearfix">
                            <span class="pull-left">
                                <label>Total Taxes</label>
                            </span>
                            <span class="pull-right"
                                *ngIf="branch && branch.companyTotals && branch.companyTotals.taxes && branch.companyTotals.taxes.amount">{{branch.companyTotals.taxes.amount | giddhCurrency}}</span>
                            <span class="pull-right"
                                *ngIf="!(branch && branch.companyTotals && branch.companyTotals.taxes && branch.companyTotals.taxes.amount)">0</span>
                        </div>
                        <!--            <div class="clearfix">-->
                        <!--              <span class="pull-left">-->
                        <!--                <label>Total Stock</label>-->
                        <!--              </span>-->
                        <!--              <span class="pull-right">&nbsp;</span>-->
                        <!--            </div>-->
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<div *ngIf="(branches$ | async)?.length < 1">
    <div class="col-xs-12  text-center">
        <div class="illustration_box">
            <img src="assets/images/new/branch-Illus.png" />
            <div class="" *ngIf="!parentCompanyName">
                <h3 class="lead mr-t2 mr-b2 fs18">Add branch under <strong class="primary-clr txtCpc">{{ currentBranch }} <span
                            *ngIf="currentBranchNameAlias">( {{currentBranchNameAlias}} )</span></strong> headquarter.
                </h3>
                <button class="btn btn-default mr-l1 btn-lg" (click)="openAddBranchModal()">Add Branch</button>
            </div>
            <div class="" *ngIf="parentCompanyName">
                <h3 class="lead mr-t2 fs18">This is a branch of <strong class="primary-clr txtCpc">{{ parentCompanyName
					}}</strong> headquarter.</h3>
            </div>
        </div>
    </div>
</div>

<!-- add branch modal -->
<div bsModal #branchModal="bs-modal" [config]="{backdrop: 'static', keyboard: true}" tabindex="-1" class="modal fade"
    role="dialog">
    <div class="modal-dialog modal-md">
        <div class="modal-content">
            <div class="modal-header clearfix">
                <h3>Create New Branch</h3>
                <span aria-hidden="true" class="close" (click)="hideAddBranchModal()" data-dismiss="modal">×</span>
            </div>
            <div class="modal-body">
                <div>
                    <label class="selectCompanies">Select companies who are your branch</label>
                    <div class="btn-group btn-block" dropdown>
                        <button dropdownToggle (click)="getAllBranches()" type="button"
                            class="form-control text-left btn-block dropdown-toggle">
                            <span *ngIf="!selectedCompaniesUniquename.length"> Select Branch </span><span
                                *ngIf="selectedCompaniesUniquename.length">{{selectedCompaniesUniquename.length}}
                                selected</span><span class="select_drop pull-right mr-t1"><i
                                    class="fa fa-caret-down"></i></span>
                        </button>
                        <ul *dropdownMenu class="dropdown-menu width100" role="menu">
                            <li>
                                <input type="checkbox" (click)="selectAllCompanies($event)"
                                    [checked]="isAllSelected$ | async" /> Select
                                all
                            </li>
                            <li *ngFor="let cmp of companies$ | async">
                                <input type="checkbox"
                                    [checked]="selectedCompaniesUniquename.indexOf(cmp.uniqueName) !== -1"
                                    (click)="checkUncheckMe(cmp, $event)" /> {{cmp.name}} <span *ngIf="cmp.nameAlias">
                                    ({{cmp.nameAlias}})</span>
                            </li>
                        </ul>


                    </div>
                </div>
                <div style="margin-top: 5px;">
                    <ul class="list-inline custom-multi-select">
                        <li *ngFor="let cmp of selectedCompaniesName">
                            <a style="color: gray">
                                {{cmp.name}} <span *ngIf="cmp.nameAlias"> ({{cmp.nameAlias}})</span><span class="pdL"
                                    (click)="checkUncheckMe(cmp,$event)">×</span>
                            </a>
                        </li>

                    </ul>

                </div>
                <div>
                    <br>
                    <span>Or</span>
                    <button class="btn-link" (click)="openCreateCompanyModal()">Create New Branch</button>
                </div>


                <div class="buttonYesCancel">
                    <button (click)="hideAddBranchModal()" class="btn btn-sm btn-danger">Cancel</button>
                    <button (click)="createBranches()" class="btn btn-sm btn-success">Yes</button>
                </div>

            </div>

            <!-- modal footer -->
        </div>
    </div>
</div>

<!--add company modal  -->


<div bsModal #addCompanyModal="bs-modal" [config]="{backdrop: 'static', keyboard: 'true'}" tabindex="-1"
    class="modal fade openPoup" role="dialog" (onHidden)="onHide()">
    <div class="modal-dialog modal-xl wd-900">
        <div class="modal-content">
            <ng-template element-view-container-ref #companyadd=elementviewcontainerref>
            </ng-template>
        </div>
    </div>
</div>


<!-- add branch modal -->
<div bsModal #confirmationModal="bs-modal" [config]="{backdrop: 'static', keyboard: 'true'}" tabindex="-1"
    class="modal fade" role="dialog">
    <div class="modal-dialog modal-md">
        <div class="modal-content">
            <div class="modal-header clearfix">
                <h3>Confirmation</h3>
                <span aria-hidden="true" class="close" (click)="onUserConfirmation(false)" data-dismiss="modal">×</span>
            </div>
            <div class="modal-body" [innerHTML]="confirmationMessage">
            </div>
            <div class="modal-footer clearfix">
                <button (click)="onUserConfirmation(true)" class="btn btn-sm btn-success">Yes</button>
                <button (click)="onUserConfirmation(false)" class="btn btn-sm btn-danger">No</button>
            </div>
            <!-- modal footer -->
        </div>
    </div>
</div>
