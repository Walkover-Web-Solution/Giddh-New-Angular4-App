<ng-container appTranslate [file]="'settings/integration'" (localeData)="localeData = $event"
    (commonLocaleData)="commonLocaleData = $event" (translationComplete)="translationComplete($event)">
    <div class="clearfix">
        <tabset [ngClass]="{'tab-integration': true, 'hide-payment-tab' : !isIndianCompany}" #integrationTab
            id="tab-integration">
            <!-- <tab (selectTab)="loadSmsData($event); tabChanged('sms');">
                <ng-template tabHeading>
                    <span class="icon-chat2"></span> {{localeData?.sms?.tab_heading}}
                </ng-template>

                <div class="box clearfix">
                    <h3 class="font-20 bold mb-2">{{localeData?.sms?.form_heading}}</h3>
                    <form #msgform="ngForm" (ngSubmit)="onSubmitMsgform(msgform)" class="smsForm">
                        <section ngModelGroup="smsFormObj" #smsFormObjCtrl="ngModelGroup">
                            <div class="row">
                                <div class="form-group col-md-5 col-lg-3">

                                    <label>{{localeData?.sms?.auth_key_label}}</label>
                                    <br>
                                    <input type="text" [placeholder]="localeData?.sms?.auth_key_placeholder"
                                        class="form-control" [ngModel]="smsFormObj.authKey" name="authKey" required />

                                </div>
                                <div class="form-group col-md-5 col-lg-3">
                                    <label>{{localeData?.sms?.sender_id_label}}</label>
                                    <br>
                                    <input type="text" [placeholder]="localeData?.sms?.sender_id_placeholder"
                                        class="form-control" [ngModel]="smsFormObj.senderId" name="senderId" required />
                                </div>
                                <div class="form-group col-md-2 col-lg-3">
                                    <div class="empty-label">
                                        <label>&nbsp;</label>
                                        <br>
                                        <button type="submit" class="btn btn-success mr-r1"
                                            [disabled]="smsFormObjCtrl.invalid">{{commonLocaleData?.app_save}}</button>
                                    </div>
                                </div>
                            </div>
                        </section>
                    </form>
                </div>
            </tab> -->

            <tab (selectTab)="loadEmailData($event); tabChanged('email');">
                <ng-template tabHeading>
                    <span class="icon-mail"></span> {{localeData?.email?.tab_heading}}
                </ng-template>

                <div class="box clearfix mb-2">
                    <h3 class="section-head">{{localeData?.email?.gmail_integration}}</h3>
                    <div class="d-flex gmail-integration-message">

                        <ng-container *ngIf="!(isGmailIntegrated$ | async)">
                            <a *ngIf="!isElectron " class="btn btn-primary"
                                [href]="gmailAuthCodeUrl$ | async">{{localeData?.email?.connect_gmail}}</a>

                            <a *ngIf="isElectron " class="btn btn-primary" href="javascript:void(0);"
                                (click)="gmailIntegration('google')">{{localeData?.email?.connect_gmail}}</a>
                        </ng-container>

                        <h4 *ngIf="(isGmailIntegrated$ | async)" class="text-success align-self-center">
                            {{localeData?.email?.gmail_connected}}</h4>
                        <button *ngIf="(isGmailIntegrated$ | async)" class="btn btn-danger mr-l2"
                            (click)="removegmailintegration.toggle()">{{localeData?.email?.remove_account}}
                        </button>
                    </div>
                </div>

                <!--remove account integration confirmation modal-->
                <div bsModal #removegmailintegration="bs-modal" class="modal fade" role="dialog">
                    <div class="modal-dialog modal-xl">
                        <div class="modal-content">
                            <confirm-modal [title]="localeData?.email?.remove_account_title"
                                [body]="localeData?.email?.remove_account_message"
                                (cancelCallBack)="removegmailintegration.toggle()"
                                (successCallBack)="removeGmailAccount();removegmailintegration.toggle()">
                            </confirm-modal>
                        </div>
                    </div>
                </div>


                <div class="box clearfix">
                    <h3 class="font-20 bold mb-2">{{localeData?.email?.form_heading}}</h3>
                    <form #emailform="ngForm" (ngSubmit)="onSubmitEmailform(emailform)">
                        <div class="row">
                            <div class="form-group col-md-5 col-lg-3">

                                <label>{{localeData?.email?.auth_key_label}}</label>
                                <br>
                                <input type="text" [placeholder]="localeData?.email?.auth_key_placeholder"
                                    class="form-control" [ngModel]="emailFormObj.authKey" name="authKey" required />

                            </div>
                            <div class="form-group col-md-5 col-lg-3">
                                <label>{{localeData?.email?.email_subject_label}}</label>
                                <br>
                                <input type="text" [placeholder]="localeData?.email?.email_subject_placeholder"
                                    class="form-control" [ngModel]="emailFormObj.subject" name="subject" required />
                            </div>
                            <div class="form-group col-md-2 col-lg-3 empty-label">

                                <label>&nbsp;</label>
                                <br>
                                <button type="submit" class="btn btn-success mr-r1"
                                    [disabled]="emailform.invalid">{{commonLocaleData?.app_save}}</button>

                            </div>
                        </div>

                    </form>
                </div>

            </tab>

            <tab (selectTab)="loadCollectionData($event); tabChanged('collection');">
                <ng-template tabHeading>
                    <span class="icon-card"></span> {{localeData?.collection?.tab_heading}}
                </ng-template>

                <div class="box clearfix mb-2">
                    <h3 class="font-20 bold mb-2">{{localeData?.collection?.razorpay_form_heading}}</h3>
                    <form #razorPayform="ngForm" novalidate class="">
                        <div class="row">
                            <div class="form-group col-lg-4 col-md-6 col-xs-12">
                                <label>{{localeData?.collection?.key_id_label}}
                                    <span class="required">*</span>
                                </label>
                                <input class="form-control" type="text"
                                    [placeholder]="localeData?.collection?.key_id_placeholder"
                                    name="razorPayObj.userName" [(ngModel)]="razorPayObj.userName" required
                                    autocomplete="off">

                            </div>
                            <div class="form-group col-lg-4 col-md-6 col-xs-12">
                                <label>{{localeData?.collection?.secret_key_label}}
                                    <span class="required">*</span>
                                </label>
                                <input class="form-control" type="password"
                                    [placeholder]="localeData?.collection?.secret_key_placeholder"
                                    name="razorPayObj.password" [(ngModel)]="razorPayObj.password" required
                                    autocomplete="off">
                            </div>
                        </div>
                        <div>
                            <div class="row">
                                <div class="form-group col-lg-4 col-md-6 col-xs-12">
                                    <div>
                                        <label>{{localeData?.collection?.link_account_label}}</label>
                                        <div class="input-group">
                                            <sh-select class="linked-account"
                                                [placeholder]="localeData?.collection?.link_account_placeholder"
                                                name="razorPayObj.account" [(ngModel)]="razorPayObj.account.uniqueName"
                                                [options]="accounts$ | async" (selected)="selectAccount($event)"
                                                [forceClearReactive]="forceClearLinkAccount$ | async"
                                                [enableDynamicSearch]="true" [isPaginationEnabled]="true"
                                                (scrollEnd)="handleScrollEnd()"
                                                (dynamicSearchedQuery)="onAccountSearchQueryChanged($event)"
                                                [fixedValue]="razorPayObj?.account?.name"
                                                [defaultValue]="razorPayObj?.account?.name">
                                            </sh-select>
                                            <div class="input-group-addon cp"
                                                *ngIf="razorPayObj?.account?.uniqueName && razorPayObj?.account?.name">
                                                <span (click)="unlinkAccountFromRazorPay()" class="icon-trash"></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group col-lg-4 col-md-6 col-xs-12 mr-t1 empty-label" id="inlnImg">
                                    <label>&nbsp;</label>
                                    <br>
                                    <input type="checkbox" [(ngModel)]="razorPayObj.autoCapturePayment"
                                        name="autoCapturePayment" />
                                    {{localeData?.collection?.automatic_capture_on_payment}}
                                </div>
                            </div>
                        </div>


                        <div class="row">
                            <div class="col-sm-12 form-group ">
                                <button *ngIf="!updateRazor" class="btn btn-success" [disabled]="razorPayform.invalid"
                                    (click)="saveRazorPayDetails()">{{commonLocaleData?.app_save}}
                                </button>
                                <button *ngIf="updateRazor" class="btn btn-success" [disabled]="razorPayform.invalid"
                                    (click)="updateRazorPayDetails()">{{commonLocaleData?.app_update}}
                                </button>
                                <button *ngIf="updateRazor" class="btn btn-danger"
                                    (click)="deleteRazorPayDetails()">{{commonLocaleData?.app_delete}}
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </tab>

            <tab (selectTab)="loadEcommerceData($event); tabChanged('ecommerce');">
                <ng-template tabHeading>
                    <span class="icon-ecomm"></span> {{localeData?.ecommerce?.tab_heading}}
                </ng-template>
                <div class="mr-t2 box clearfix">
                    <h3 class="section-head mb-2">{{localeData?.ecommerce?.shopify_form_heading}}</h3>
                    <span
                        *ngIf="isEcommerceShopifyUserVerified">{{localeData?.ecommerce?.shopify_connected_message}}</span>
                    <a href="https://shopify.giddh.com/signup.php" target="_blank"
                        *ngIf="!isEcommerceShopifyUserVerified">
                        <span>{{localeData?.ecommerce?.connect_shopify}}</span></a>
                </div>

            </tab>
            <tab (selectTab)="loadPaymentData($event); tabChanged('payment');" [hidden]="!isIndianCompany">
                <div *ngIf="isIndianCompany">
                    <ng-template tabHeading>
                        <span class="icon-payment"></span> {{localeData?.payment?.tab_heading}}
                    </ng-template>
                    <div class="mb-2 bank-logo">
                        <img src="assets/images/ICICI-logo.png"/>
                    </div>
                    <!-- <div *ngFor="let regAcc of registeredAccount; let parentIndex=index">

                        <div class="box clearfix">
                            <div class="d-flex justify-content-between">
                                <h2 class="font-20 bold mb-2">{{localeData?.payment?.icici_bank_name}}</h2>
                                <div class="ico-btn">
                                    <button class="btn btn-xs" *ngIf="isBankUpdateInEdit !== parentIndex"
                                        (click)="editRegisterForm(parentIndex, regAcc)" type="button"><i
                                            class="icon-edit-pencil"></i></button>
                                    <button class="btn btn-xs" *ngIf="isBankUpdateInEdit === parentIndex"
                                        (click)="editRegisterForm(null)" type="button"><i
                                            class="icon-edit-pencil"></i></button>
                                    <button class="btn btn-xs mr-0" type="button" (click)="deRegisterForm(regAcc)"><i
                                            class="icon-trash"></i></button>
                                </div>
                            </div>
                            <div *ngIf="isBankUpdateInEdit === parentIndex ">
                                <form [formGroup]="addBankForm"
                                    (ngSubmit)="updateIciciDetails(addBankForm.value, parentIndex)">
                                    <div class="row">
                                        <div class="form-group col-xl-2 col-md-6 payment-col">
                                            <div class="">
                                                <label>{{localeData?.payment?.corporate_id_label}} <span
                                                        class="required">*</span></label>
                                                <br>
                                                <input type="text"
                                                    [placeholder]="localeData?.payment?.corporate_id_placeholder"
                                                    class="form-control" disabled formControlName="corpId" name="corpId"
                                                    autocomplete="off" />
                                            </div>
                                        </div>
                                        <div class="form-group col-xl-2 col-md-6 payment-col">
                                            <label>{{localeData?.payment?.user_id_label}} <span
                                                    class="required">*</span></label>
                                            <br>
                                            <input type="text" [placeholder]="localeData?.payment?.user_id_placeholder"
                                                class="form-control" disabled formControlName="userId" name="userId"
                                                required autocomplete="off" />
                                        </div>
                                        <div class="form-group col-xl-2 col-md-6 payment-col">
                                            <label>{{localeData?.payment?.account_number_label}} <span
                                                    class="required">*</span></label>
                                            <br>
                                            <input type="text"
                                                [placeholder]="localeData?.payment?.account_number_placeholder"
                                                class="form-control" disabled formControlName="accountNo"
                                                name="accountNo" autocomplete="off" />
                                        </div>
                                        <div class="form-group col-xl-2 col-md-6 payment-col">
                                            <label>{{localeData?.payment?.alias_id_label}}</label>
                                            <br>
                                            <input type="text" [placeholder]="localeData?.payment?.alias_id_placeholder"
                                                class="form-control" name="aliasId" disabled
                                                formControlName="aliasId" />
                                        </div>
                                        <div class="form-group col-xl-2 col-md-6 payment-col">
                                            <label>{{localeData?.payment?.accounts}} <span
                                                    class="required">*</span></label>
                                            <br>
                                            <sh-select #paymentFormAccountName [options]="bankAccounts$ | async"
                                                name="accountUniqueName" formControlName="accountUniqueName"
                                                [placeholder]="commonLocaleData?.app_select_account" [ItemHeight]="33"
                                                autocomplete="off" [isRequired]="true">
                                            </sh-select>
                                        </div>
                                    </div>
                                    <ng-container formArrayName="userAmountRanges">
                                        <ng-container
                                            *ngFor="let item of addBankForm.get('userAmountRanges')['controls'];let index = index;let f = first; let l = last"
                                            [formGroupName]="index">
                                            <div class="row">
                                                <div class="form-group col-xl-2 col-md-6 payment-col"
                                                    *ngIf="item.get('maxBankLimit').value ==='max'">
                                                    <ng-container *ngIf="index===0"> <label
                                                            class="d-flex relative info-icon">{{localeData?.payment?.amount_upto}}
                                                            <span class="required">*</span>
                                                            <div class="tooltip-box"><i class="icon-info cursor-pointer"
                                                                    [tooltip]="localeData?.payment?.client_amount_note"></i>
                                                            </div>
                                                        </label>
                                                    </ng-container>
                                                    <div class="custom-select max select-caret position-relative">

                                                        <sh-select [options]="amountUpToList"
                                                            formControlName="maxBankLimit"
                                                            (selected)="selectedMaxOrCustomField( index, false, null , $event);checkFormValidations(addBankForm.value)"
                                                            name="maxBankLimit" [isRequired]="true">

                                                        </sh-select>
                                                    </div>
                                                    <p class="error-msg text-right"></p>
                                                </div>
                                                <div class="form-group col-xl-2 col-md-3 payment-col1"
                                                    *ngIf="item.get('maxBankLimit').value!=='max'">
                                                    <ng-container *ngIf="index===0"> <label
                                                            class="d-flex relative info-icon">{{localeData?.payment?.amount_upto}}
                                                            <span class="required">*</span>
                                                            <div class="tooltip-box"><i class="icon-info cursor-pointer"
                                                                    [tooltip]="localeData?.payment?.client_amount_note"></i>
                                                            </div>
                                                        </label>
                                                    </ng-container>
                                                    <div class="d-flex">
                                                        <div
                                                            class="mr-r05 custom-select cust select-caret position-relative">

                                                            <sh-select [options]="amountUpToList"
                                                                formControlName="maxBankLimit"
                                                                (selected)="selectedMaxOrCustomField(  index, false, null , $event);checkFormValidations(addBankForm.value)"
                                                                name="maxBankLimit" [isRequired]="true">

                                                            </sh-select>
                                                        </div>
                                                        <div class="mr-l05">
                                                            <input type="text" class="form-control"
                                                                [ngClass]="{'error-box': checkIsAmountRepeat(addBankForm.get('userAmountRanges').value,item.get('amount').value,index, true)}"
                                                                #amountElement decimalDigitsDirective
                                                                (blur)="preventZero(item.get('amount').value, index, null, false)"
                                                                maxlength="10" formControlName="amount" name="amount"
                                                                [placeholder]="commonLocaleData?.app_amount">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="form-group col-xl-2 col-md-6 payment-col1">
                                                    <ng-container *ngIf="index===0">
                                                        <label class="d-flex relative info-icon">{{localeData?.payment?.select_otp}} <span
                                                                class="required">*</span>
                                                            <div class="tooltip-box"><i class="icon-info cursor-pointer"
                                                                    [tooltip]="localeData?.payment?.select_otp_tooltip"></i>
                                                            </div>
                                                        </label>
                                                    </ng-container>
                                                    <div class="custom-select select-caret position-relative">
                                                        <sh-select [options]="typeOTPList" formControlName="otpType"
                                                            (selected)="selectedOtpType($event,index, false)" required
                                                            [isRequired]="true" name="otpType">
                                                        </sh-select>
                                                    </div>
                                                </div>
                                                <div class="form-group col-xl-2 col-md-6 payment-col">
                                                    <ng-container *ngIf="index===0">
                                                        <label class="d-flex relative info-icon">{{localeData?.payment?.approver_name}} <span
                                                                class="required">*</span>
                                                            <div class="tooltip-box"><i class="icon-info cursor-pointer"
                                                                    [tooltip]="localeData?.payment?.approver_name_tooltip"></i>
                                                            </div>
                                                        </label>

                                                    </ng-container>
                                                    <div class="custom-select select-caret position-relative"
                                                        *ngIf="item.get('otpType').value !=='BANK'">
                                                        <sh-select [options]="approvalNameList" class="text-left"
                                                            formControlName="approvalUniqueName"
                                                            name="approvalUniqueName" [placeholder]="localeData?.payment?.select_bank"
                                                            [customSorting]="customApproverNameListSorting"
                                                            [multiple]="false" [isRequired]="true">
                                                            <ng-template #optionTemplate let-option="option">
                                                                <a href="javascript:void(0)"
                                                                    *ngIf="option?.additional[0]?.mobileVerified"
                                                                    class="list-item relative">
                                                                    <div class="item">
                                                                        <p>{{option?.label}}</p>
                                                                        <p>{{option?.additional[0]?.mobileNumber}}</p>
                                                                        <img src="assets/images/blue-check.svg"
                                                                            class="check-search" alt="">
                                                                    </div>
                                                                </a>

                                                                <fieldset disabled href="javascript:void(0)"
                                                                    *ngIf="!option?.additional[0]?.mobileVerified"
                                                                    class="list-item relative text-light disabled disabled-list-item">
                                                                    <div class="item">
                                                                        <p>{{option?.label}}</p>
                                                                        <p>{{localeData?.payment?.unverifed}}</p>
                                                                        <img src="assets/images/close-round.svg"
                                                                            class="check-search" alt="">
                                                                    </div>
                                                                </fieldset>
                                                            </ng-template>
                                                        </sh-select>
                                                    </div>
                                                    <div class="custom-select select-caret position-relative"
                                                        *ngIf="item.get('otpType').value ==='BANK'">
                                                        <input type="text" class="form-control" disabled
                                                            [placeholder]="localeData?.payment?.registered"
                                                            formControlName="approvalUniqueName"
                                                            name="approvalUniqueName">
                                                    </div>
                                                </div>
                                                <div class="form-group plus-cross-btn col-sm-1 pl-0 pr-0">
                                                    <label *ngIf="index===0" class="d-flex hidden-1359">&nbsp;</label>
                                                    <div class="mt-1 xs-pd-l15">
                                                        <i (click)="removeUserAmountRangesForm(index);checkFormValidations(addBankForm.value)"
                                                            class="icon-trash cursor-pointer"></i>
                                                    </div>
                                                </div>
                                            </div>
                                        </ng-container>
                                    </ng-container>
                                    <div>
                                        <a href="javascript:void(0)"
                                            (click)="addUserAmountRangesForm();checkFormValidations(addBankForm.value)"
                                            class="btn btn-link pl-0">{{localeData?.payment?.add_new_row}}</a>
                                    </div>
                                    <div class="form-group">
                                        <div class="empty-label">
                                            <button type="submit" [disabled]="!addBankForm.valid || isUpdateInvalid"
                                                class="btn btn-success mr-r1">{{commonLocaleData?.app_update}}</button>
                                        </div>
                                    </div>
                                </form>
                            </div>

                            <form #paymentFormUpdate="ngForm" *ngIf="isBankUpdateInEdit !== parentIndex ">
                                <div class="row">
                                    <div class="form-group col-sm-4 col-xl-2 col-md-6 payment-col">
                                        <label>{{localeData?.payment?.corporate_id_label}} <span
                                                class="required">*</span></label>
                                        <br>
                                        <input type="text" [placeholder]="localeData?.payment?.corporate_id_placeholder"
                                            required name="corpId" class="form-control" [(ngModel)]="regAcc.corpId"
                                            disabled />

                                    </div>
                                    <div class="form-group col-sm-4 col-xl-2 col-md-6 payment-col">
                                        <label>{{localeData?.payment?.user_id_label}} <span
                                                class="required">*</span></label>
                                        <br>

                                        <input type="text" [placeholder]="localeData?.payment?.user_id_placeholder"
                                            name="userId" required class="form-control" [(ngModel)]="regAcc.userId"
                                            disabled />

                                    </div>
                                    <div class="form-group col-sm-4 col-xl-2 col-md-6 payment-col">
                                        <label>{{localeData?.payment?.account_number_label}} <span
                                                class="required">*</span></label>
                                        <br>

                                        <input type="text"
                                            [placeholder]="localeData?.payment?.account_number_placeholder"
                                            name="accountNo" required class="form-control"
                                            [(ngModel)]="regAcc.accountNo" disabled />
                                    </div>
                                    <div class="form-group col-sm-4 col-xl-2 col-md-6 payment-col">
                                        <label>{{localeData?.payment?.alias_id_label}}</label>
                                        <br>
                                        <input type="text" [placeholder]="localeData?.payment?.alias_id_placeholder"
                                            name="aliasId" class="form-control" [(ngModel)]="regAcc.aliasId" disabled />
                                    </div>
                                    <div class="form-group col-sm-4 col-xl-2 col-md-6 payment-col"
                                        *ngIf="bankAccounts$ && regAcc?.account?.uniqueName">

                                        <label>{{localeData?.payment?.accounts}} <span class="required">*</span></label>
                                        <br>
                                        <sh-select *ngIf="bankAccounts$ && regAcc?.account?.uniqueName"
                                            [disabled]="isBankUpdateInEdit !== parentIndex" required
                                            [options]="bankAccounts$ | async" name="accountUniqueName"
                                            [defaultValue]="regAcc?.account?.name"
                                            [(ngModel)]="regAcc.account.uniqueName"
                                            [placeholder]="commonLocaleData?.app_select_account" [ItemHeight]="33"
                                            autocomplete="off" [isRequired]="true"></sh-select>
                                    </div>
                                </div>
                                <ng-container
                                    *ngFor="let item of regAcc.userAmountRanges; let index = index; let firstIndex = first; let lastIndex = last">
                                    <div class="row">
                                        <div class="form-group col-sm-4 col-xl-2 col-md-6 payment-col"
                                            *ngIf="item.maxBankLimit ==='max'">
                                            <ng-container *ngIf="index===0"> <label
                                                    class="d-flex relative info-icon">{{localeData?.payment?.amount_upto}}
                                                    <span class="required">*</span>
                                                    <div class="tooltip-box"><i class="icon-info cursor-pointer"
                                                            [tooltip]="localeData?.payment?.client_amount_note"></i>
                                                    </div>
                                                </label>
                                            </ng-container>
                                            <div class="custom-select select-caret position-relative">
                                                <sh-select [options]="amountUpToList" autocomplete="off" required
                                                    [(ngModel)]="item.maxBankLimit"
                                                    name="maxBankLimit{{parentIndex}}{{index}}"
                                                    [disabled]="isBankUpdateInEdit !== parentIndex"
                                                    (selected)="selectedMaxOrCustom(index, true, parentIndex);"
                                                    (ngModelChange)="maxLimitOrCustomChanged($event, index , true, parentIndex)"
                                                    [isRequired]="true">
                                                </sh-select>
                                            </div>
                                            <p class="error-msg text-right"></p>
                                        </div>
                                        <div class="form-group col-sm-4 col-xl-2 col-md-6 payment-col"
                                            *ngIf="item.maxBankLimit !== 'max'">
                                            <ng-container *ngIf="index===0"> <label
                                                    class="d-flex relative info-icon">{{localeData?.payment?.amount_upto}}
                                                    <span class="required">*</span>
                                                    <div class="tooltip-box"><i class="icon-info cursor-pointer"
                                                            [tooltip]="localeData?.payment?.client_amount_note"></i>
                                                    </div>
                                                </label>
                                            </ng-container>
                                            <div class="d-flex">

                                                <div
                                                    class="mr-r05 custom-select select-caret position-relative width-100">
                                                    <sh-select [options]="amountUpToList" autocomplete="off"
                                                        [required]="item.maxBankLimit !== 'max'"
                                                        [disabled]="isBankUpdateInEdit !== parentIndex"
                                                        [fixedValue]="'Custom'" defaultValue="{{item.maxBankLimit}}"
                                                        [(ngModel)]="item.maxBankLimit"
                                                        (selected)="selectedMaxOrCustom(index, true, parentIndex);"
                                                        (ngModelChange)="maxLimitOrCustomChanged($event, index , true, parentIndex)"
                                                        name="maxBankLimit{{parentIndex}}{{index}}" [isRequired]="true">
                                                    </sh-select>
                                                </div>
                                                <div class="mr-l05  width-100">
                                                    <input type="text" class="form-control" #amountUpdateElement
                                                        [required]="item.maxBankLimit !== 'max'" decimalDigitsDirective
                                                        [disabled]="isBankUpdateInEdit !== parentIndex"
                                                        [(ngModel)]="item.amount"
                                                        (blur)="changeAmount(item, index, amountUpdateElement, true, parentIndex );preventZero(item.amount,index, parentIndex, true )"
                                                        maxlength="10" name="amount{{parentIndex}}{{index}}"
                                                        [placeholder]="commonLocaleData?.app_amount">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group col-sm-4 col-xl-2 col-md-6 payment-col">
                                            <ng-container *ngIf="index===0">
                                                <label class="d-flex relative info-icon">{{localeData?.payment?.select_otp}} <span
                                                        class="required">*</span>
                                                    <div class="tooltip-box"><i class="icon-info cursor-pointer"
                                                        [tooltip]="localeData?.payment?.select_otp_tooltip"></i>
                                                    </div>
                                                </label>
                                            </ng-container>
                                            <div class="custom-select select-caret position-relative">
                                                <sh-select [options]="typeOTPList" [(ngModel)]="item.otpType"
                                                    (ngModelChange)="selectedOtpType($event, index, true, parentIndex)"
                                                    [disabled]="isBankUpdateInEdit !== parentIndex" required
                                                    name="otpType{{parentIndex}}{{index}}" [isRequired]="true">
                                                </sh-select>
                                            </div>
                                        </div>
                                        <div class="form-group col-sm-4 col-xl-2 col-md-6 payment-col">
                                            <ng-container *ngIf="index===0">
                                                <label class="d-flex relative info-icon">{{localeData?.payment?.approver_name}} <span
                                                        class="required">*</span>
                                                    <div class="tooltip-box"><i class="icon-info cursor-pointer"
                                                            [tooltip]="localeData?.payment?.approver_name_tooltip"></i>
                                                    </div>
                                                </label>

                                            </ng-container>
                                            <div class="custom-select select-caret position-relative"
                                                *ngIf="item.otpType!=='BANK'">
                                                <input type="text" class="form-control" [placeholder]="localeData?.payment?.registered"
                                                    disabled name="approvalUniqueName{{index}}"
                                                    [value]="item.approvalDetails.name">
                                            </div>
                                            <div class="custom-select select-caret position-relative"
                                                *ngIf="item.otpType==='BANK'">
                                                <input type="text" class="form-control"
                                                    [disabled]="item.otpType==='BANK' || isBankUpdateInEdit !== parentIndex"
                                                    [placeholder]="localeData?.payment?.registered" name="approvalUniqueName{{index}}">
                                            </div>
                                        </div>
                                        <div class="form-group plus-cross-btn col-sm-1 pl-0 pr-0"
                                            *ngIf="isBankUpdateInEdit === parentIndex">
                                            <ng-container *ngIf="index===0"> <label
                                                    class="d-flex hidden-1359">&nbsp;</label></ng-container>
                                            <div class="mt-1 xs-pd-l15">
                                                <i (click)="deleteAmountRangeRow(item, parentIndex+1)"
                                                    class="icon-trash cursor-pointer"></i>
                                            </div>
                                        </div>
                                    </div>
                                </ng-container>

                                <div *ngIf="isBankUpdateInEdit === parentIndex">
                                    <a href="javascript:void(0)" (click)="addNewAmountRangeRow(parentIndex+1)"
                                        class="btn btn-link pl-0 pt-0">{{localeData?.payment?.add_new_row}}</a>
                                </div>
                                <div>
                                    <div class="form-group update-btn-wrapper">
                                        <label>&nbsp;</label>
                                        <br>
                                        <button type="button" class="btn btn-success mr-r1"
                                            [disabled]="!paymentFormUpdate.form.valid"
                                            (click)="updateIciciDetails(regAcc, parentIndex)">{{commonLocaleData?.app_update}}</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <br *ngIf="parentIndex !== (registeredAccount?.length - 1) || openNewRegistration" />
                    </div> -->
                    <!-- Create or add bank account end -->
                    <!-- <div *ngIf="openNewRegistration" class="box clearfix mb-2">
                        <form [formGroup]="addBankForm" (ngSubmit)="onSubmitPaymentform(addBankForm.value)"
                            *ngIf="!(isPaymentAdditionSuccess$ | async)">
                            <div class="row">
                                <div class="form-group col-sm-4 col-xl-2 col-md-6 payment-col amount-upto">
                                    <div>
                                        <label>{{localeData?.payment?.corporate_id_label}} <span
                                                class="required">*</span></label>
                                        <br>
                                        <input type="text" [placeholder]="localeData?.payment?.corporate_id_placeholder"
                                            class="form-control" formControlName="corpId" name="corpId"
                                            autocomplete="off" />
                                    </div>
                                </div>
                                <div class="form-group col-sm-4 col-xl-2 col-md-6 payment-col">
                                    <label>{{localeData?.payment?.user_id_label}} <span
                                            class="required">*</span></label>
                                    <br>
                                    <input type="text" [placeholder]="localeData?.payment?.user_id_placeholder"
                                        class="form-control" formControlName="userId" name="userId"
                                        autocomplete="off" />
                                </div>
                                <div class="form-group col-sm-6 col-xl-2 col-md-6 payment-col">
                                    <label>{{localeData?.payment?.account_number_label}} <span
                                            class="required">*</span></label>
                                    <br>
                                    <input type="text" [placeholder]="localeData?.payment?.account_number_placeholder"
                                        class="form-control" formControlName="accountNo" name="accountNo"
                                        autocomplete="off" />
                                </div>
                                <div class="form-group col-sm-4 col-xl-2 col-md-6 payment-col">
                                    <label>{{localeData?.payment?.alias_id_label}}</label>
                                    <br>
                                    <input type="text" [placeholder]="localeData?.payment?.alias_id_placeholder"
                                        class="form-control" name="aliasId" formControlName="aliasId" />
                                </div>
                                <div class="form-group col-sm-6 col-xl-2 col-md-6 payment-col">
                                    <label>{{localeData?.payment?.accounts}} <span class="required">*</span></label>
                                    <br>
                                    <sh-select #paymentFormAccountName [options]="bankAccounts$ | async"
                                        name="accountUniqueName" formControlName="accountUniqueName"
                                        [forceClearReactive]="forceClear$ | async"
                                        [placeholder]="commonLocaleData?.app_select_account" [ItemHeight]="33"
                                        autocomplete="off" [isRequired]="true">
                                    </sh-select>
                                </div>
                            </div>
                            <ng-container formArrayName="userAmountRanges">
                                <ng-container
                                    *ngFor="let item of addBankForm.get('userAmountRanges')['controls'];let index = index;let f = first; let l = last"
                                    [formGroupName]="index">
                                    <div class="row">
                                        <div class="form-group col-sm-6 col-xl-2 col-md-6 payment-col amount-upto"
                                            *ngIf="item.get('maxBankLimit').value ==='max'">
                                            <ng-container *ngIf="index===0"> <label
                                                    class="d-flex relative info-icon">{{localeData?.payment?.amount_upto}}
                                                    <span class="required">*</span>
                                                    <div class="tooltip-box"><i class="icon-info cursor-pointer"
                                                            [tooltip]="localeData?.payment?.client_amount_note"></i>
                                                    </div>
                                                </label>
                                            </ng-container>
                                            <div class="custom-select max select-caret position-relative">

                                                <sh-select [options]="amountUpToList" formControlName="maxBankLimit"
                                                    (selected)="selectedMaxOrCustomField( index, false, null , $event)"
                                                    name="maxBankLimit" [isRequired]="true">

                                                </sh-select>
                                            </div>
                                            <p class="error-msg text-right"></p>
                                        </div>
                                        <div class="form-group col-sm-6  col-xl-2 col-md-6 payment-col amount-upto"
                                            *ngIf="item.get('maxBankLimit').value!=='max'">
                                            <ng-container *ngIf="index===0"> <label
                                                    class="d-flex relative info-icon">{{localeData?.payment?.amount_upto}}
                                                    <span class="required">*</span>
                                                    <div class="tooltip-box"><i class="icon-info cursor-pointer"
                                                            [tooltip]="localeData?.payment?.client_amount_note"></i>
                                                    </div>
                                                </label>
                                            </ng-container>
                                            <div class="d-flex">
                                                <div class="mr-r05 custom-select cust select-caret position-relative">

                                                    <sh-select [options]="amountUpToList" formControlName="maxBankLimit"
                                                        (selected)="selectedMaxOrCustomField(  index, false, null , $event)"
                                                        name="maxBankLimit" [isRequired]="true">

                                                    </sh-select>
                                                </div>
                                                <div class="mr-l05">
                                                    <input type="text" class="form-control"
                                                        [ngClass]="{'error-box': checkIsAmountRepeat(addBankForm.get('userAmountRanges').value,item.get('amount').value,index, false)}"
                                                        #amountElement decimalDigitsDirective
                                                        (blur)="preventZero(item.get('amount').value, index, null, false)"
                                                        maxlength="10" [mask]="inputMaskFormat" formControlName="amount"
                                                        name="amount" [placeholder]="commonLocaleData?.app_amount">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group col-sm-6 col-xl-2 col-md-6 payment-col1">
                                            <ng-container *ngIf="index===0">
                                                <label class="d-flex relative info-icon">{{localeData?.payment?.select_otp}} <span
                                                        class="required">*</span>
                                                    <div class="tooltip-box"><i class="icon-info cursor-pointer"
                                                        [tooltip]="localeData?.payment?.select_otp_tooltip"></i>
                                                    </div>
                                                </label>
                                            </ng-container>
                                            <div class="custom-select select-caret position-relative">
                                                <sh-select [options]="typeOTPList" formControlName="otpType"
                                                    (selected)="selectedOtpType($event,index, false)" required
                                                    name="otpType" [isRequired]="true">
                                                </sh-select>
                                            </div>
                                        </div>
                                        <div class="form-group col-sm-6 col-xl-2 col-md-6 payment-col">
                                            <ng-container *ngIf="index===0">
                                                <label class="d-flex relative info-icon">{{localeData?.payment?.approver_name}} <span
                                                        class="required">*</span>
                                                    <div class="tooltip-box"><i class="icon-info cursor-pointer"
                                                            [tooltip]="localeData?.payment?.approver_name_tooltip"></i>
                                                    </div>
                                                </label>

                                            </ng-container>
                                            <div class="custom-select select-caret position-relative"
                                                *ngIf="item.get('otpType').value !=='BANK'">
                                                <sh-select [options]="approvalNameList" class="text-left"
                                                    formControlName="approvalUniqueName" name="approvalUniqueName"
                                                    [placeholder]="localeData?.payment?.select_bank"
                                                    [customSorting]="customApproverNameListSorting" [multiple]="false"
                                                    [isRequired]="true">
                                                    <ng-template #optionTemplate let-option="option">
                                                        <a href="javascript:void(0)"
                                                            *ngIf="option?.additional[0]?.mobileVerified"
                                                            class="list-item relative">
                                                            <div class="item">
                                                                <p>{{option?.label}}</p>
                                                                <p>{{option?.additional[0]?.mobileNumber}}</p>
                                                                <img src="assets/images/blue-check.svg"
                                                                    class="check-search" alt="">
                                                            </div>
                                                        </a>

                                                        <fieldset disabled href="javascript:void(0)"
                                                            *ngIf="!option?.additional[0]?.mobileVerified"
                                                            class="list-item relative text-light disabled disabled-list-item">
                                                            <div class="item">
                                                                <p>{{option?.label}}</p>
                                                                <p>{{localeData?.payment?.unverifed}}</p>
                                                                <img src="assets/images/close-round.svg"
                                                                    class="check-search" alt="">
                                                            </div>
                                                        </fieldset>
                                                    </ng-template>
                                                </sh-select>
                                            </div>
                                            <div class="custom-select select-caret position-relative"
                                                *ngIf="item.get('otpType').value ==='BANK'">
                                                <input type="text" class="form-control" disabled
                                                    [placeholder]="localeData?.payment?.registered" formControlName="approvalUniqueName"
                                                    name="approvalUniqueName">
                                            </div>
                                        </div>
                                        <div class="form-group plus-cross-btn col-sm-1 col-md-1 pl-0 pr-0">
                                            <label *ngIf="index===0" class="d-flex hidden-1359">&nbsp;</label>
                                            <div class="mt-1 xs-pd-l15">
                                                <i (click)="removeUserAmountRangesForm(index)"
                                                    class="icon-trash cursor-pointer"></i>
                                            </div>
                                        </div>
                                    </div>
                                </ng-container>
                            </ng-container>
                            <div>
                                <a href="javascript:void(0)" (click)="addUserAmountRangesForm()"
                                    class="btn btn-link pl-0 pt-0">{{localeData?.payment?.add_new_row}}</a>
                            </div>
                            <div class="form-group">
                                <div class="empty-label">
                                    <br>
                                    <button type="submit" [disabled]="addBankForm.invalid || isCreateInvalid"
                                        class="btn btn-success mr-r1">{{commonLocaleData?.app_submit}}</button>
                                </div>
                            </div>
                        </form>
                        <div *ngIf="(isPaymentAdditionSuccess$ | async)">
                            <div class="clearfix d-inline-block">
                                <div [innerHTML]="localeData?.payment?.connection_request_message"></div>
                            </div>
                            <div class="clearfix">
                                <div class="payment-text">{{localeData?.payment?.note}}
                                </div>
                            </div>
                        </div>
                    </div> -->
                    <div class="row">
                        <div class="form-group mr-l2">
                            <button type="button"
                                class="btn btn-sky-blue mr-r2"
                                (click)="openCreateNewAccountModal()">{{localeData?.payment?.connect_new_account}}</button> <span class="button-separator">|</span> <br>
                                <a href="javascript:;" class="font-12">{{localeData?.payment?.learn_connect}}</a>
                        </div>
                        <div class="form-group mr-l1">
                            <p class="mb-4 mr-l05 font-12"><a class="btn icici-button" href="https://cadigital.icicibank.com/SmartFormWeb/apps/services/www/SmartFormWeb/desktopbrowser/default/index.html?source=BC-application-Giddh#/" target="_blank"><span class="icon-icici-logo"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span> {{localeData?.payment?.open_new_current_account}}</a></p>
                        </div>    
                    </div>

                    <div class="connected-accounts">
                        <b class="font-14">{{localeData?.payment?.connected_accounts}}</b><br>
                        <giddh-page-loader [cssClass]="'mt-0 mb-0'" *ngIf="isLoading"></giddh-page-loader>
                        <ng-container *ngIf="!isLoading && connectedBankAccounts?.length > 0">
                            <div class="account-wrapper" *ngFor="let bankAccount of connectedBankAccounts; trackBy: trackByAccountUniqueName;">
                                <div class="account-info-background width-100 font-14 row">
                                    <div class="col-md-4">
                                        <span class="field-label">{{localeData?.payment?.account_number_label}}</span><br>
                                        <span class="account-number mt-2 font-16 inline"><b>{{bankAccount?.iciciDetailsResource?.accountNumber}}</b></span>
                                    </div>
                                    <div class="col-md-4">
                                        <span class="field-label">{{localeData?.payment?.linked_account}}</span><br>
                                        <span class="width-100 view-only-field inline">{{bankAccount?.account?.name}}</span>
                                    </div>
                                    <div class="col-md-4">
                                        <span class="field-label">{{localeData?.payment?.payment_updates}}</span><br>
                                        <span class="payment-updates view-only-field inline" *ngIf="bankAccount?.iciciDetailsResource?.paymentAlerts?.length > 0">
                                            <ng-container *ngFor="let alert of bankAccount?.iciciDetailsResource?.paymentAlerts; let i = index; trackBy: trackByAlertUniqueName;">{{alert?.name}}{{ (i < bankAccount?.iciciDetailsResource?.paymentAlerts?.length - 1) ? ", " : "" }}</ng-container>
                                        </span>
                                        <span class="mr-l15 action-div">
                                            <a href="javascript:;" class="icon-edit-pencil" (click)="openEditAccountModal(bankAccount)"></a>
                                        </span>
                                    </div>
                                </div>    
                                <div class="font-14">
                                    <ng-container *ngIf="bankAccount?.iciciDetailsResource?.payor?.length > 0">
                                        <div class="mt-2" *ngFor="let payor of bankAccount?.iciciDetailsResource?.payor;">
                                            <div class="width-100">
                                                <div class="col-md-4 v-align-top inline">
                                                    <span class="field-label">{{localeData?.payment?.login_id_label}}</span><br>
                                                    <span class="width-100 disabled-field inline">{{payor?.loginId}}</span>
                                                </div>
                                                <div class="col-md-4 v-align-top inline">
                                                    <span class="limit-upto field-label">{{localeData?.payment?.limit_upto}}</span><br>
                                                    <span class="width-100 disabled-field inline limit-upto">{{(payor?.duration === unlimitedLimit) ? localeData?.payment?.amount_limit?.unlimited : activeCompany?.baseCurrencySymbol + " " + payor?.maxAmount | giddhCurrency }} <span class="pull-right payor-duration" *ngIf="payor?.duration !== unlimitedLimit">/ {{payor?.duration}}</span></span><br>
                                                    <span class="limit-upto font-12 field-label">{{localeData?.payment?.used}} {{payor?.usedAmount | giddhCurrency}}</span>
                                                </div>
                                                <div class="col-md-4 v-align-top inline mt-2">
                                                    <br>
                                                    <span class="account-approval-status pending-approval" *ngIf="payor?.registrationStatus !== 'SUCCESS'"><i class="icon-alert-2"></i> {{localeData?.payment?.pending_self_approval}}</span>
                                                    <span class="account-approval-status approved" *ngIf="payor?.registrationStatus === 'SUCCESS'"><i class="icon-success"></i> {{localeData?.payment?.connected}}</span>
                                                    <span class="mr-l15 user-action-div">
                                                        <a href="javascript:;" class="icon-edit-pencil" (click)="openEditAccountUserModal(bankAccount, payor)"></a>
                                                        <a href="javascript:;" class="fa fa-trash mr-l2" (click)="showDeleteBankAccountLoginConfirmationModal(bankAccount, payor)"></a>
                                                    </span>
                                                </div>
                                            </div>
                                            <div class="inline" *ngIf="payor?.registrationStatus !== 'SUCCESS'">
                                                <div class="col-md-12">
                                                    <p class="font-12" [innerHTML]="localeData?.payment?.approval_request_sent"></p>
                                                    <p class="font-10">{{localeData?.payment?.approval_request_accepted}}</p>
                                                </div>
                                            </div>
                                        </div>
                                    </ng-container>
                                    <button type="button" class="btn btn-light-blue bold font-14 mt-2 mr-l15" (click)="openCreateNewAccountUserModal(bankAccount)">{{localeData?.payment?.add_more_users}}</button>
                                    <a class="btn icici-button font-12 mt-2 pull-right mr-0" href="javascript:;"><span class="icon-icici-logo"><span class="path1"></span><span class="path2"></span><span class="path3"></span></span> {{localeData?.payment?.get_instant_overdraft}}</a>
                                </div>
                            </div>
                        </ng-container>    
                    </div>
                </div>
            </tab>
        </tabset>
    </div>
    <div bsModal #createNewAccountModal="bs-modal" [config]="{ backdrop: 'static' }" class="modal" role="dialog">
        <div class="modal-dialog account-modal" *ngIf="createNewAccountModal?.isShown">
            <div class="modal-content">
                <form autocomplete="off" novalidate name="createNewAccountForm" [formGroup]="createNewAccountForm"
                class="new-account-form" (ngSubmit)="saveNewAccount()">
                    <div class="modal-header">
                        <h3 class="modal-title">{{localeData?.payment?.connect_icici_account}}</h3>
                        <span data-dismiss="modal" [attr.aria-label]="commonLocaleData?.app_close" class="close hover-orange" (click)="closeCreateNewAccountModal()">×</span>
                    </div>
                    <div class="modal-body">
                        <div class="clearfix">
                            <label>{{localeData?.payment?.icici_login_id}}<span class="red-text">*</span>:</label>
                            <input class="form-control" required formControlName="loginId"
                                name="loginId" type="text" [placeholder]="localeData?.payment?.login_id_placeholder">
                        </div>
                        <div class="clearfix mr-t1">
                            <label>{{localeData?.payment?.account_number_label}}<span class="red-text">*</span>:</label>
                            <input class="form-control" required formControlName="accountNumber"
                                name="accountNumber" type="text" decimalDigitsDirective [placeholder]="localeData?.payment?.account_number_placeholder" maxlength="11">
                        </div>
                        <div class="clearfix mr-t1">
                            <label>{{localeData?.payment?.link_account_label}}<span class="red-text">*</span>:</label>
                            <sh-select formControlName="accountUniqueName" name="accountUniqueName" [placeholder]="localeData?.payment?.link_account_placeholder" [options]="bankAccounts$ | async" required></sh-select>
                        </div>
                        <div class="clearfix mr-t1">
                            <label>{{localeData?.payment?.user}}<span class="red-text">*</span>:</label>
                            <sh-select formControlName="userUniqueName" name="userUniqueName" [placeholder]="localeData?.payment?.select_user" [options]="usersList" required></sh-select>
                        </div>
                        <div class="clearfix mr-t1">
                            <label>{{localeData?.payment?.payment_updates}}:</label>
                            <sh-select formControlName="paymentAlerts" name="paymentAlerts" [placeholder]="localeData?.payment?.select_receipients" [options]="paymentAlersUsersList" [multiple]="true" (selected)="selectPaymentAlertUsers($event)" [forceClearReactive]="forceClearPaymentUpdates$ | async" [hasSelectAllOption]="true">
                                <ng-template #optionTemplate let-option="option">
                                    <ng-container>
                                        <a href="javascript:void(0)" class="list-item d-flex">
                                            <span><input type="checkbox" [checked]="((selectAllRecords !== option.value && paymentAlerts?.includes(option.value)) || selectAllRecords === option.value && paymentAlerts?.length === paymentAlersUsersList?.length)" [value]="option.value"></span>&nbsp;
                                            <span>
                                                <div class="item">{{ option.label }}</div>
                                            </span>
                                        </a>
                                    </ng-container>
                                </ng-template>
                            </sh-select>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-success mr-1" [disabled]="createNewAccountForm?.invalid">{{localeData?.payment?.connect}}</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div bsModal #editAccountModal="bs-modal" [config]="{ backdrop: 'static' }" class="modal" role="dialog">
        <div class="modal-dialog account-modal" *ngIf="editAccountModal?.isShown">
            <div class="modal-content">
                <form autocomplete="off" novalidate name="editAccountForm" [formGroup]="editAccountForm"
                class="new-account-form" (ngSubmit)="updateAccount()">
                    <div class="modal-header">
                        <h3 class="modal-title">{{localeData?.payment?.edit_account}}</h3>
                        <span data-dismiss="modal" [attr.aria-label]="commonLocaleData?.app_close" class="close hover-orange" (click)="closeEditAccountModal()">×</span>
                    </div>
                    <div class="modal-body">
                        <div class="clearfix">
                            <label>{{localeData?.payment?.account_number_label}}</label><br>
                            {{activeBankAccount?.iciciDetailsResource?.accountNumber}}
                        </div>
                        <div class="clearfix mr-t1">
                            <label>{{localeData?.payment?.link_account_label}}<span class="red-text">*</span>:</label>
                            <sh-select formControlName="accountUniqueName" name="accountUniqueName" [placeholder]="localeData?.payment?.link_account_placeholder" [options]="bankAccounts$ | async" required></sh-select>
                        </div>
                        <div class="clearfix mr-t1">
                            <label>{{localeData?.payment?.payment_updates}}</label>
                            <sh-select formControlName="paymentAlerts" name="paymentAlerts" [placeholder]="localeData?.payment?.select_receipients" [options]="paymentAlersUsersList" [multiple]="true" (selected)="selectPaymentAlertUsers($event)" [forceClearReactive]="forceClearPaymentUpdates$ | async" [hasSelectAllOption]="true">
                                <ng-template #optionTemplate let-option="option">
                                    <ng-container>
                                        <a href="javascript:void(0)" class="list-item d-flex">
                                            <span><input type="checkbox" [checked]="((selectAllRecords !== option.value && paymentAlerts?.includes(option.value)) || selectAllRecords === option.value && paymentAlerts?.length === paymentAlersUsersList?.length)" [value]="option.value"></span>&nbsp;
                                            <span>
                                                <div class="item">{{ option.label }}</div>
                                            </span>
                                        </a>
                                    </ng-container>
                                </ng-template>
                            </sh-select>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-success mr-1" [disabled]="editAccountForm?.invalid">{{commonLocaleData?.app_update}}</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div bsModal #createNewAccountUserModal="bs-modal" [config]="{ backdrop: 'static' }" class="modal" role="dialog">
        <div class="modal-dialog user-modal" *ngIf="createNewAccountUserModal?.isShown">
            <div class="modal-content">
                <form autocomplete="off" novalidate name="createNewAccountUserForm" [formGroup]="createNewAccountUserForm"
                class="new-account-form" (ngSubmit)="saveNewAccountUser()">
                    <div class="modal-header">
                        <h3 class="modal-title">{{localeData?.payment?.add_user}}</h3>
                        <span data-dismiss="modal" [attr.aria-label]="commonLocaleData?.app_close" class="close hover-orange" (click)="closeCreateNewAccountUserModal()">×</span>
                    </div>
                    <div class="modal-body">
                        <div class="clearfix">
                            <div class="inline col-md-6 pl-0">
                                <label>{{localeData?.payment?.account_number_label}}</label><br>
                                <span class="bold">{{activeBankAccount?.iciciDetailsResource?.accountNumber}}</span>
                            </div>
                            <div class="inline col-md-6 pl-0 pr-0">
                                <label>{{localeData?.payment?.linked_account}}</label><br>
                                <span class="bold">{{activeBankAccount?.account?.name}}</span>
                            </div>
                        </div>
                        <div class="clearfix mr-t1">
                            <label>{{localeData?.payment?.login_id_label}}<span class="red-text">*</span></label>
                            <input class="form-control" required formControlName="loginId"
                                name="loginId" type="text" [placeholder]="localeData?.payment?.login_id_placeholder">
                        </div>
                        <div class="clearfix mr-t1">
                            <label>{{localeData?.payment?.user}}<span class="red-text">*</span></label>
                            <sh-select formControlName="userUniqueName" name="userUniqueName" [placeholder]="localeData?.payment?.select_user" [options]="usersList" required></sh-select>
                        </div>
                        <div class="clearfix mr-t1">
                            <label>{{localeData?.payment?.limit_upto}}</label>
                            <div class="clearfix">
                                <div class="inline col-md-6 pl-0 pr-0">
                                    <input class="form-control" formControlName="maxAmount" name="maxAmount" type="text" [placeholder]="localeData?.payment?.enter_amount">
                                </div>
                                <div class="inline col-md-6 pr-0">
                                    <sh-select formControlName="duration" name="duration" [placeholder]="localeData?.payment?.duration" [options]="amountLimitDurations"></sh-select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-success mr-1" [disabled]="createNewAccountUserForm?.invalid">{{commonLocaleData?.app_save}}</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div bsModal #editAccountUserModal="bs-modal" [config]="{ backdrop: 'static' }" class="modal" role="dialog">
        <div class="modal-dialog user-modal" *ngIf="editAccountUserModal?.isShown">
            <div class="modal-content">
                <form autocomplete="off" novalidate name="editAccountUserForm" [formGroup]="editAccountUserForm"
                class="new-account-form" (ngSubmit)="updateAccountUser()">
                    <div class="modal-header">
                        <h3 class="modal-title">{{localeData?.payment?.edit_user}}</h3>
                        <span data-dismiss="modal" [attr.aria-label]="commonLocaleData?.app_close" class="close hover-orange" (click)="closeEditAccountUserModal()">×</span>
                    </div>
                    <div class="modal-body">
                        <div class="clearfix">
                            <div class="inline col-md-6 pl-0">
                                <label>{{localeData?.payment?.account_number_label}}</label><br>
                                <span class="bold">{{activeBankAccount?.iciciDetailsResource?.accountNumber}}</span>
                            </div>
                            <div class="inline col-md-6 pl-0 pr-0">
                                <label>{{localeData?.payment?.linked_account}}</label><br>
                                <span class="bold">{{activeBankAccount?.account?.name}}</span>
                            </div>
                        </div>
                        <div class="clearfix mr-t1">
                            <label>{{localeData?.payment?.user}}</label><br>
                            {{activePayorAccount?.user?.name}}
                        </div>
                        <div class="clearfix mr-t1">
                            <label>{{localeData?.payment?.limit_upto}}</label>
                            <div class="clearfix">
                                <div class="inline col-md-6 pl-0 pr-0">
                                    <input class="form-control" formControlName="maxAmount" name="maxAmount" type="text" [placeholder]="localeData?.payment?.enter_amount">
                                </div>
                                <div class="inline col-md-6 pr-0">
                                    <sh-select formControlName="duration" name="duration" [placeholder]="localeData?.payment?.duration" [options]="amountLimitDurations"></sh-select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-success mr-1" [disabled]="editAccountUserForm?.invalid">{{commonLocaleData?.app_update}}</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div bsModal #confirmationModal="bs-modal" [config]="{backdrop: 'static', keyboard: false}" class="modal fade"
        role="dialog">
        <div class="modal-dialog modal-md" *ngIf="confirmationModal?.isShown">
            <div class="modal-content">
                <div class="modal-header clearfix">
                    <h3>{{commonLocaleData?.app_confirmation}}</h3>
                    <span aria-hidden="true" class="close" (click)="confirmationModal?.hide()"
                        data-dismiss="modal">×</span>
                </div>
                <div class="modal-body">
                    {{localeData?.payment?.delete_login | replace: '[LOGIN_ID]': activeBankAccount?.loginId}}
                </div>
                <div class="modal-footer clearfix">
                    <button (click)="deleteBankAccountLogin(true)"
                        class="btn btn-sm btn-success">{{commonLocaleData?.app_yes}}</button>
                    <button (click)="confirmationModal?.hide()"
                        class="btn btn-sm btn-danger">{{commonLocaleData?.app_no}}</button>
                </div>
            </div>
        </div>
    </div>
</ng-container>
