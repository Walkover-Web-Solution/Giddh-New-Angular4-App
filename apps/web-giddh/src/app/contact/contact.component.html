<ng-container appTranslate [file]="'contact'" (localeData)="localeData = $event"
    (commonLocaleData)="commonLocaleData = $event" (translationComplete)="translationComplete($event)">
    <div class="relative">
        <hamburger-menu *ngIf="activeTab !== 'vendor'"></hamburger-menu>
        <hamburger-menu [pageHeading]="localeData?.page_heading" *ngIf="activeTab === 'vendor'"></hamburger-menu>
        <tabset #staticTabs class="custom-tabs" [ngClass]="{'hide-header': activeTab === 'vendor'}">
            <!-- region Customer/Vendor -->
            <tab heading="{{localeData?.customer}}" [id]="(activeTab !== 'aging-report') ? 'giddh-page-heading': ''"
                (selectTab)="tabSelected(activeTab === 'vendor' ? 'vendor' : 'customer')"
                [active]="activeTab !== 'aging-report'">
                <div class="container-fluid">

                    <div class="top-bar customer-top-bar clearfix"
                        [ngClass]="{'vendor-top-bar': activeTab === 'vendor'}">
                        <div class="customer-form-inline">
                            <div class="wrap-search-entity">
                                <div class="dis mr-r15 pull-left">

                                    <div *ngIf="activeTab !== 'aging'" class="btn-group"
                                        #filterDropDownList="bs-dropdown" dropdown [autoClose]="false"
                                        (clickOutside)="hideListItems()" [tooltip]="localeData?.filter_toggle"
                                        [placement]="'right'">
                                        <i dropdownToggle class="icon-options pd cp font-20"></i>

                                        <ul *dropdownMenu class="dropdown-menu dropdown-menu-left" role="menu"
                                            [style.width.px]="'200'">
                                            <li role="menuitem">
                                                <a class="dropdown-item">
                                                    <input type="checkbox" name="selectAll"
                                                        [(ngModel)]="showFieldFilter.selectAll"
                                                        (ngModelChange)="selectAllColumns($event)">
                                                    {{commonLocaleData?.app_select_all}}
                                                </a>
                                            </li>

                                            <li role="menuitem">
                                                <a class="dropdown-item">
                                                    <input type="checkbox" name="field_filter.parentGroup"
                                                        (ngModelChange)="columnFilter($event, 'parentGroup')"
                                                        [(ngModel)]="showFieldFilter.parentGroup" />
                                                    {{commonLocaleData?.app_parent_group}}
                                                </a>
                                            </li>

                                            <li role="menuitem">
                                                <a class="dropdown-item">
                                                    <input type="checkbox" name="field_filter.openingBalance"
                                                        (ngModelChange)="columnFilter($event, 'openingBalance')"
                                                        [(ngModel)]="showFieldFilter.openingBalance" />
                                                    {{localeData?.opening}}
                                                </a>
                                            </li>

                                            <li role="menuitem">
                                                <a class="dropdown-item">
                                                    <input type="checkbox" name="field_filter.mobile"
                                                        (ngModelChange)="columnFilter($event, 'mobile')"
                                                        [(ngModel)]="showFieldFilter.mobile" />
                                                    {{commonLocaleData?.app_mobile_no}}</a>
                                            </li>

                                            <li role="menuitem">
                                                <a class="dropdown-item">
                                                    <input type="checkbox" name="field_filter.email"
                                                        (ngModelChange)="columnFilter($event, 'email')"
                                                        [(ngModel)]="showFieldFilter.email" />
                                                    {{commonLocaleData?.app_email_id}}</a>
                                            </li>

                                            <li role="menuitem">
                                                <a class="dropdown-item">
                                                    <input type="checkbox" name="field_filter.state"
                                                        (ngModelChange)="columnFilter($event, 'state')"
                                                        [(ngModel)]="showFieldFilter.state" />
                                                    {{commonLocaleData?.app_state}}</a>
                                            </li>
                                            <li *ngIf="shouldShowTaxFilter" role="menuitem">
                                                <a class="dropdown-item">
                                                    <input type="checkbox" name="field_filter.gstin"
                                                        (ngModelChange)="columnFilter($event, 'gstin')"
                                                        [(ngModel)]="showFieldFilter.gstin" />
                                                    {{commonLocaleData?.app_tax_number}}</a>
                                            </li>
                                            <li role="menuitem">
                                                <a class="dropdown-item">
                                                    <input type="checkbox" name="field_filter.comment"
                                                        (ngModelChange)="columnFilter($event, 'comment')"
                                                        [(ngModel)]="showFieldFilter.comment" /> {{localeData?.comment}}
                                                </a>
                                            </li>
                                            <ng-container *ngFor="let item of (companyCustomFields$ | async)">
                                                <li role="menuitem">
                                                    <a class="dropdown-item">
                                                        <input type="checkbox" name="{{item.uniqueName}}"
                                                            (ngModelChange)="columnFilter($event, item.uniqueName)"
                                                            [(ngModel)]="showFieldFilter[item.uniqueName]" /> {{item.key
                                                        | titlecase}}
                                                    </a>
                                                </li>
                                            </ng-container>
                                        </ul>
                                    </div>
                                </div>
                                <div class="form-group mr-r15 pull-left linked-entities"
                                    *ngIf="currentCompanyBranches?.length > 2 && currentOrganizationType === 'COMPANY'">
                                    <div>
                                        <sh-select [options]="currentCompanyBranches"
                                            [(ngModel)]="currentBranch.uniqueName" [showClear]="false" [ItemHeight]="33"
                                            width="100%" (selected)="handleBranchChange($event)"
                                            [isFilterEnabled]="true" [placeholder]="commonLocaleData?.app_select_entity"
                                            [fixedValue]="currentBranch?.alias">
                                            <ng-template #optionTemplate let-option="option">
                                                <ng-container>
                                                    <a href="javascript:void(0)" class="list-item d-flex">
                                                        <span class="entity-icon">
                                                            <i class="icon-branch-icon pull-right"
                                                                *ngIf="!option.isCompany"
                                                                tooltip="{{commonLocaleData?.app_branch}}"></i>
                                                            <i class="icon-company-profile pull-right"
                                                                *ngIf="option.isCompany"
                                                                tooltip="{{commonLocaleData?.app_company}}"></i>
                                                        </span>
                                                        <span class="entity-details">
                                                            <div class="item giddh-limit single-line-clamp">{{
                                                                option?.label || '-' }}</div>
                                                            <div class="item-unique giddh-limit single-line-clamp">
                                                                {{ option?.name || '-' }}
                                                            </div>
                                                        </span>
                                                    </a>
                                                </ng-container>
                                            </ng-template>
                                        </sh-select>
                                    </div>
                                </div>
                                <!-- On company class will show only if we are on company mode and branches length will greater or equal to 2 -->
                                <div class="pull-left header-left"
                                    [ngClass]="{'on-company': currentCompanyBranches?.length >= 2 }">
                                    <div class="form-group max-width-250 search-field" *ngIf="activeTab !== 'aging'">
                                        <input type="text" [placeholder]="localeData?.name_email_mobile"
                                            class="form-control" [(ngModel)]="searchStr"
                                            (ngModelChange)="searchStr$.next($event)" />
                                        <span class="input-addon">
                                            <i class="icon-search"></i>
                                        </span>

                                    </div>
                                </div>
                            </div>
                            <!-- Invoice filter section ends -->
                            <button class="btn btn-group btn-filter desktop-button-filter "
                                *ngIf="selectedAccountsList.length>0" (click)="clearSelectedContacts();">
                                <span class="icon-cross"></span> {{commonLocaleData?.app_clear_selected}}
                            </button>
                            <div class="pd-t1-md">
                                <div class="btn-group pull-right on-desktop-view">
                                    <button *ngIf="activeTab == 'customer'" class="btn btn-sky-blue mr-0"
                                        (click)="openAddAndManage('customer')">
                                        {{localeData?.new_customer}}
                                    </button>
                                    <button *ngIf="activeTab == 'vendor'" class="btn btn-sky-blue mr-0"
                                        (click)="openAddAndManage('vendor')">
                                        {{localeData?.new_vendor}}
                                    </button>
                                </div>
                                <div class="customer-footer-box pull-right ">

                                    <div class="clearfix customer-inner-box">
                                        <span class="pull-left mr-r1 total-contacts">
                                            <h5>
                                                <span *ngIf="!selectedCheckedContacts.length"
                                                    class="number-total">{{activeTab === 'customer' ? totalCustomers :
                                                    totalVendors}}</span>
                                                <span *ngIf="selectedCheckedContacts.length>0"
                                                    class="number-total">{{selectedCheckedContacts.length}}</span>
                                                {{localeData?.contacts}}
                                            </h5>
                                        </span>
                                        <div class="btn-group more-button" dropdown>
                                            <button id="button-basic" dropdownToggle type="button"
                                                class="btn btn-default dropdown-toggle" aria-controls="dropdown-basic">
                                                {{commonLocaleData?.app_more}}
                                                <span class="caret"></span>
                                            </button>
                                            <ul id="dropdown-basic" *dropdownMenu class="dropdown-menu" role="menu"
                                                aria-labelledby="button-basic">
                                                <li role="menuitem" (click)="openEmailDialog();">
                                                    {{commonLocaleData?.app_email}}</li>
                                                <li role="menuitem" (click)="openSmsDialog();">
                                                    {{commonLocaleData?.app_sms}}</li>
                                                <li role="menuitem" (click)="downloadCSV();">
                                                    {{commonLocaleData?.app_download_csv}}</li>
                                                <li role="menuitem"
                                                    *ngIf="selectedAccountsList.length>0 && activeTab === 'vendor'"
                                                    (click)="openBulkPaymentModal(template)">
                                                    {{localeData?.bulk_payment}}</li>
                                            </ul>
                                        </div>
                                    </div>
                                    <button class="btn btn-group btn-filter mobile-button-filter"
                                        *ngIf="selectedAccountsList.length>0" (click)="clearSelectedContacts();">
                                        <span class="icon-cross"></span>

                                        <span>{{commonLocaleData?.app_clear}}</span>

                                    </button>

                                </div>

                                <div class="btn-group  pull-right on-mobile-view">
                                    <button *ngIf="activeTab == 'customer'" class="btn btn-sky-blue mr-r05"
                                        (click)="openAddAndManage('customer')">
                                        {{localeData?.new_customer}}
                                    </button>
                                    <button *ngIf="activeTab == 'vendor'" class="btn btn-sky-blue "
                                        (click)="openAddAndManage('vendor')">
                                        {{localeData?.new_vendor}}
                                    </button>
                                </div>
                            </div>

                        </div>
                    </div>


                    <div class="text-center top-aging-table-top separate-top-aging pd-1" *ngIf="isMobileScreen">
                        <p (click)="showGiddhDatepicker($event)">
                            <strong>{{commonLocaleData?.app_due_as_on}} </strong>
                            <span *ngIf="selectedDateRangeUi">
                                {{selectedDateRangeUi}}
                            </span>
                        </p>
                    </div>

                    <div class="contact-main customer-page on-mobile-view">

                        <div class="pd-b2 mr-b1">

                            <div>

                                <div *ngIf="!isMobileScreen && !isGetAccountsInProcess">
                                    <!-- <perfect-scrollbar fxFlex="auto" [scrollIndicators]="true"> -->
                                    <ng-container *ngTemplateOutlet='mainTable'></ng-container>
                                    <!-- </perfect-scrollbar> -->
                                </div>
                                <giddh-page-loader *ngIf="!isMobileScreen && isGetAccountsInProcess">
                                </giddh-page-loader>

                                <div *ngIf="isMobileScreen">
                                    <ng-container *ngTemplateOutlet='mainTable'></ng-container>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="clearfix pagination-main">
                    <div class="mt-5 mb-100px">
                        <div>
                            <div class="customer-right-wrap clearfix">
                                <div class="text-right">
                                    <h4 class="mr-b1 pd-r2">{{commonLocaleData?.app_result_total}}</h4>
                                </div>

                                <div class="bg-white clearfix">
                                    <div class="customer-right  clearfix width-100">
                                        <table class="text-right">
                                            <tr>
                                                <td *ngIf="showFieldFilter.openingBalance">
                                                    <p>{{localeData?.opening}}</p>
                                                    <h3><span
                                                            *ngIf="activeTab === 'customer' && openingBalance?.type === 'CREDIT' && formatAmountInCurrency(openingBalance?.amount) > 0">-</span><span
                                                            *ngIf="activeTab === 'vendor' && openingBalance?.type === 'DEBIT' && formatAmountInCurrency(openingBalance?.amount) > 0">-</span>
                                                        {{openingBalance?.amount | giddhCurrency}}/-</h3>
                                                </td>
                                                <td>
                                                    <p *ngIf="activeTab === 'vendor'">{{commonLocaleData?.app_purchase}}
                                                    </p>
                                                    <p *ngIf="activeTab === 'customer'">{{commonLocaleData?.app_sales}}
                                                    </p>
                                                    <h3>{{totalSales |giddhCurrency }}/-</h3>
                                                </td>
                                                <td>
                                                    <p *ngIf="activeTab === 'vendor'">{{commonLocaleData?.app_payment}}
                                                    </p>
                                                    <p *ngIf="activeTab === 'customer'">
                                                        {{commonLocaleData?.app_receipt}}</p>
                                                    <h3>{{totalReceipts | giddhCurrency}}/-</h3>
                                                </td>
                                                <td>
                                                    <p>{{localeData?.closing}}</p>
                                                    <h3>{{closingBalance | giddhCurrency}}/-</h3>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </tab>
            <!-- endregion -->

            <!-- region Aging Report -->
            <tab heading="{{localeData?.aging_report}}" [id]="(activeTab === 'aging-report') ? 'giddh-page-heading': ''"
                (selectTab)="tabSelected('aging-report')" [active]="activeTab === 'aging-report'">
                <!--    <div *ngIf="activeTab === 'aging'">-->
                <aging-report [localeData]="localeData" [commonLocaleData]="commonLocaleData"
                    (creteNewCustomerEvent)="openAddAndManage('customer')"></aging-report>
                <!--    </div>-->
            </tab>
            <!-- endregion -->
        </tabset>
    </div>

    <!-- region Modal for Mail/SMS for vendore-->
    <div *ngIf="activeTab === 'vendor'" class="modal fade border-radius-0" tabindex="-1" bsModal #mailModal="bs-modal"
        role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-md">
            <div class="modal-content">
                <div class="border-radius-0">
                    <div class="modal-header theme-bg pd-l2 pd-r2 clearfix">
                        <h3 class="modal-title bg" id="modal-title-mail-vendor">{{messageBody.header.set}}</h3>
                        <span aria-hidden="true" class="close" data-dismiss="modal"
                            [attr.aria-label]="commonLocaleData?.app_close" (click)="mailModal.hide()">×</span>
                    </div>
                    <div class="modal-body pd-l2 pd-r2 clearfix">
                        <h1 class="mr-b1" *ngIf="messageBody.type == 'Email'">{{localeData?.enter_subject}}:</h1>
                        <input *ngIf="messageBody.type == 'Email'" class="form-control mr-b1" #subject
                            [(ngModel)]="messageBody.subject" type="text"
                            [placeholder]="localeData?.enter_subject_placeholder" />
                        <h1 class="mr-b1">{{localeData?.type_message_body}}:</h1>
                        <textarea #messageBox [(ngModel)]="messageBody.msg" class="form-control resize-none" rows="4"
                            [placeholder]="localeData?.type_message_body_placeholder"></textarea>
                        <small class="mr-t05 mr-b05 grey">{{localeData?.tip}}</small>

                        <div class="row mr-t2">
                            <ul class="list-inline pills">
                                <li *ngFor="let val of dataVariables" (click)="addValueToMsg(val)">{{val.name}}</li>
                            </ul>
                        </div>
                        <div class="mr-t4">
                            <button class="btn btn-sm btn-success pull-right mr-l1"
                                (click)="send('sundrycreditors')">{{messageBody.btn.set}}</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--endregion-->

    <!--region Modal for Mail/SMS for customer-->
    <div *ngIf="activeTab === 'customer'" class="modal fade border-radius-0" tabindex="-1" bsModal #mailModal="bs-modal"
        role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-md">
            <div class="modal-content">
                <div class="border-radius-0">
                    <div class="modal-header theme-bg pd-l2 pd-r2 clearfix">
                        <h3 class="modal-title bg" id="modal-title-mail-customer">{{messageBody.header.set}}</h3>
                        <span aria-hidden="true" class="close" data-dismiss="modal"
                            [attr.aria-label]="commonLocaleData?.app_close" (click)="mailModal.hide()">×</span>
                        <!-- <i class="icon-cross text-right close-modal" aria-hidden="true" ></i> -->
                    </div>

                    <div class="modal-body pd-l2 pd-r2 clearfix">

                        <h1 class="mr-b1" *ngIf="messageBody.type == 'Email'">{{localeData?.enter_subject}}:</h1>
                        <input *ngIf="messageBody.type == 'Email'" class="form-control mr-b1" #subject
                            [(ngModel)]="messageBody.subject" type="text"
                            [placeholder]="localeData?.enter_subject_placeholder" />

                        <h1 class="mr-b1">{{localeData?.type_message_body}}:</h1>
                        <textarea #messageBox [(ngModel)]="messageBody.msg" class="form-control resize-none" rows="4"
                            [placeholder]="localeData?.type_message_body_placeholder"></textarea>
                        <small class="mr-t05 mr-b05 grey">{{localeData?.tip}}</small>

                        <div class="row mr-t2">
                            <ul class="list-inline pills">
                                <li *ngFor="let val of dataVariables" (click)="addValueToMsg(val)">{{val.name}}</li>
                            </ul>
                        </div>

                        <div class="mr-t4">
                            <button class="btn btn-sm btn-success pull-right mr-l1"
                                (click)="send('sundrydebtors')">{{messageBody.btn.set}}</button>
                        </div>

                    </div>

                </div>

            </div>

        </div>
    </div>
    <!--endregion-->

    <div class="aside-overlay" *ngIf="accountAsideMenuState === 'in'"></div>
    <div class="abc " *ngIf="accountAsideMenuState === 'in'">
        <aside-menu-account [activeGroupUniqueName]="selectedGroupForCreateAcc"
            [activeAccountDetails]="activeAccountDetails" [isUpdateAccount]="isUpdateAccount"
            class="account-aside-menu-state  transinherit" [@slideInOut]="accountAsideMenuState"
            [commonLocaleData]="commonLocaleData" (closeAsideEvent)="toggleAccountAsidePane($event)"
            (getUpdateList)="getUpdatedList($event)">
        </aside-menu-account>
    </div>

    <div class="aside-overlay" *ngIf="paymentAsideMenuState === 'in'"></div>
    <div class="abc vendorPayNow" *ngIf="paymentAsideMenuState === 'in'">
        <payment-aside class="account-aside-menu-state transinherit" [selectedAccForPayment]="selectedAccForPayment"
            [localeData]="localeData" [commonLocaleData]="commonLocaleData">
        </payment-aside>
    </div>

    <ng-template #mainTable>
        <div class="mobile-card-wrapper table-responsive vendor-page">
            <table class="table on-mobile-view aging-table mr-b260 giddh-table" *ngIf="activeTab !== 'aging'">
                <thead>
                    <tr class="aging-table-top">
                        <td></td>
                        <td *ngIf="showFieldFilter.parentGroup"></td>
                        <td [attr.colspan]="tableColsPan" class="text-center top-aging-table-top">
                            <p class="due-as-on" container="body">
                                <strong>{{commonLocaleData?.app_due_as_on}} </strong>
                                <span class="italic underline">
                                    <input type="text" (click)="showGiddhDatepicker($event)" name="selectedDateRange"
                                        [value]="(selectedDateRangeUi) ? selectedDateRangeUi : ''"
                                        class="form-control giddh-datepicker date-range-picker" />
                                </span>
                            </p>
                        </td>
                        <td *ngIf="activeTab === 'vendor' && isICICIIntegrated"></td>
                        <td class="text-lowercase" *ngIf="showFieldFilter.email"></td>
                        <td *ngIf="showFieldFilter.mobile"></td>
                        <td *ngIf="showFieldFilter.gstin && shouldShowTaxFilter"></td>
                        <td *ngIf="showFieldFilter.state"></td>
                        <td *ngIf="showFieldFilter.comment"></td>
                        <ng-container *ngFor="let item of (companyCustomFields$ | async)">
                            <td *ngIf="item.key && showFieldFilter[item.uniqueName]"></td>
                        </ng-container>
                    </tr>

                    <tr>
                        <th>
                            <span class="inline table-checkbox">
                                <label></label>
                                <input type="checkbox" *ngIf="selectedCheckedContacts.length"
                                    [(ngModel)]="allSelectionModel"
                                    (ngModelChange)="toggleAllSelection(allSelectionModel)" />
                            </span>
                            <div class="d-flex align-items-center">
                                <span>{{commonLocaleData?.app_name}}</span>
                                <ng-container *ngTemplateOutlet="sortingTemplate;context: { $implicit: 'name'}">
                                </ng-container>
                            </div>
                        </th>

                        <th *ngIf="showFieldFilter.parentGroup">
                            <div class="d-flex align-items-center">{{commonLocaleData?.app_parent_group}}
                                <ng-container *ngTemplateOutlet="sortingTemplate;context: { $implicit: 'group'}">
                                </ng-container>
                            </div>
                        </th>

                        <th class="text-right" *ngIf="showFieldFilter.openingBalance">
                            <div class="d-flex justify-content-end align-items-center">{{localeData?.opening}}
                                <ng-container
                                    *ngTemplateOutlet="sortingTemplate;context: { $implicit: 'openingBalance'}">
                                </ng-container>
                            </div>
                        </th>

                        <th class="text-right">
                            <div class="d-flex justify-content-end align-items-center">
                                {{ activeTab === 'customer' ? commonLocaleData?.app_sales :
                                commonLocaleData?.app_purchase }}
                                <ng-container
                                    *ngTemplateOutlet="sortingTemplate;context: { $implicit: (activeTab === 'customer') ? 'debitTotal' : 'creditTotal'}">
                                </ng-container>
                            </div>
                        </th>

                        <th class="text-right">
                            <div class="d-flex justify-content-end align-items-center">
                                {{ activeTab === 'customer' ? commonLocaleData?.app_receipt :
                                commonLocaleData?.app_payment }}
                                <ng-container
                                    *ngTemplateOutlet="sortingTemplate;context: { $implicit: activeTab === 'customer' ? 'creditTotal' : 'debitTotal'}">
                                </ng-container>
                            </div>
                        </th>

                        <th class="text-right">
                            <div class="d-flex justify-content-end align-items-center">{{localeData?.closing}}
                                <ng-container *ngTemplateOutlet="sortingTemplate;context: { $implicit: 'amountDue'}">
                                </ng-container>
                            </div>
                        </th>

                        <th *ngIf="showFieldFilter.email">
                            <div class="d-flex">
                                <div class="flex-fill">
                                    {{commonLocaleData?.app_email}}
                                </div>
                                <div class="icon-pointer cursor-pointer icon-class-search">
                                    <!--                        <i class="icon-search"></i>-->
                                </div>
                            </div>

                        </th>

                        <th *ngIf="showFieldFilter.mobile">{{commonLocaleData?.app_mobile_no}}</th>

                        <th *ngIf="showFieldFilter.gstin && shouldShowTaxFilter">
                            <div class="d-flex align-items-center">{{commonLocaleData?.app_tax_number}}
                                <ng-container *ngTemplateOutlet="sortingTemplate;context: { $implicit: 'gstin'}">
                                </ng-container>
                            </div>
                        </th>

                        <th *ngIf="showFieldFilter.state">
                            <div class="d-flex align-items-center ">{{commonLocaleData?.app_state}}
                                <ng-container *ngTemplateOutlet="sortingTemplate;context: { $implicit: 'state'}">
                                </ng-container>
                            </div>
                        </th>

                        <th *ngIf="showFieldFilter.comment" class="comment-field">{{localeData?.comment}}</th>
                        <ng-container *ngFor="let item of (companyCustomFields$ | async)">
                            <th width="10%" *ngIf="item?.uniqueName && showFieldFilter[item?.uniqueName]">{{item.key |
                                titlecase}}</th>
                        </ng-container>
                        <th *ngIf="activeTab === 'vendor' && isICICIIntegrated" width="10%">
                            {{commonLocaleData?.app_action}}</th>
                    </tr>

                </thead>

                <tbody>
                    <ng-container *ngIf="activeTab === 'customer'">

                        <tr *ngFor="let account of sundryDebtorsAccounts;let idx = index">
                            <td class="position-relative word-wrap customer-name cursor-pointer"
                                (clickOutside)="dropdown.hide()" (dblclick)="dropdown.show()"
                                data-title="{{localeData?.customer}}">
                                <div class="customer-name-filed">
                                    <span class="inline table-checkbox">
                                        <label></label>
                                        <input type="checkbox" (click)="selectAccount($event, account)"
                                            [(ngModel)]="account.isSelected"
                                            [ngClass]="{'checkbox-visible': (selectedCheckedContacts.length || isMobileScreen), 'pos-abs': !selectedCheckedContacts.length}" />
                                    </span>
                                    <span class="account-name-customer"> {{account.name}} </span>
                                    <div dropdown #dropdown="bs-dropdown" container="body" [autoClose]="false"
                                        class="icon-ellipse">
                                        <a id="edit-model-basic" dropdownToggle
                                            class="dropdown-toggle icon-dots-three-vertical pull-right"
                                            aria-controls="dropdown-basic" (click)="dropdown.show()"></a>

                                        <div id="dropdown-basic" *dropdownMenu
                                            class="dropdown-menu dropdown-menu-right wd00" role="menu"
                                            aria-labelledby="edit-model-basic">
                                            <div class="tb-pl-modal-header p-modal-tooltip p-0">

                                                <div class="account-detail-modal-header-div selection-none">

                                                    <div class="account-detail-modal-div">

                                                        <div class="account-detail-custom-header selection-none-header">

                                                            <div class="d-flex p-0 border-right-0">

                                                                <div
                                                                    class="account-detail-padding flex-fill border-right-0">
                                                                    <h3 class="account-detail-custom-title word-break">
                                                                        <span
                                                                            (click)="performActions(0, account)">{{account?.name}}</span>
                                                                    </h3>
                                                                </div>

                                                                <div class="account-detail-padding"
                                                                    (click)="updateCustomerAcc('customer', account);">
                                                                    <img src="./assets/images/path.svg">
                                                                </div>

                                                            </div>

                                                            <div class="custom-detail account-detail-padding">
                                                                <h4>{{account?.mobileNo}}</h4>
                                                                <h4>{{account?.email}}</h4>
                                                                <h4>{{account?.gstIn}}</h4>
                                                            </div>

                                                        </div>

                                                        <div class="height-82px">

                                                            <ul class="list-unstyled">

                                                                <li class="li-link" *ngIf="!isMobileScreen">
                                                                    <a href="javascript: void 0"
                                                                        (click)="performActions(1, account)">{{commonLocaleData?.app_goto_ledger}}
                                                                    </a>
                                                                </li>

                                                                <li class="li-link">
                                                                    <a href="javascript: void 0"
                                                                        (click)="performActions(2, account)">{{commonLocaleData?.app_generate_invoice}}
                                                                    </a>
                                                                </li>

                                                                <li class="li-link">
                                                                    <a href="javascript: void 0"
                                                                        (click)="performActions(3, account, $event )">{{commonLocaleData?.app_send_sms}}
                                                                    </a>
                                                                </li>

                                                                <li class="li-link">
                                                                    <a href="javascript: void 0"
                                                                        (click)="performActions(4, account, $event)">{{commonLocaleData?.app_send_email}}
                                                                    </a>
                                                                </li>

                                                            </ul>

                                                        </div>

                                                    </div>

                                                </div>

                                            </div>
                                        </div>


                                        <!--Modal for Mail/SMS-->
                                        <div class="modal fade border-radius-0" tabindex="-1" bsModal
                                            #mailModal="bs-modal" role="dialog" aria-hidden="true"
                                            (click)="$event.stopPropagation()">
                                            <div class="modal-dialog modal-md" style="margin:auto;margin-top: 200px">

                                                <div class="modal-content" style="padding: 8px 8px 8px 8px;">

                                                    <div class="border-radius-0" style="padding: 8px 8px 8px 8px;">

                                                        <div class="modal-header theme-bg pd-l2 pd-r2 clearfix"
                                                            style="padding: 8px 8px 8px 8px;">
                                                            <h3 class="modal-title bg" id="modal-title">
                                                                {{messageBody.header.set}}</h3>
                                                            <span aria-hidden="true" class="close" data-dismiss="modal"
                                                                [attr.aria-label]="commonLocaleData?.app_close"
                                                                (click)="mailModal.hide()">×</span>
                                                        </div>

                                                        <div class="modal-body pd-l2 pd-r2 clearfix"
                                                            style="padding: 0px !important;">
                                                            <h1 class="mr-b1" *ngIf="messageBody.type == 'Email'"
                                                                style="margin-top:15px;">{{localeData?.enter_subject}}:
                                                            </h1>
                                                            <input *ngIf="messageBody.type == 'Email'"
                                                                class="form-control mr-b1" #subject
                                                                [(ngModel)]="messageBody.subject" type="text"
                                                                [placeholder]="localeData?.enter_subject_placeholder" />
                                                            <h1 class="mr-b1" style="margin-top:15px;">
                                                                {{localeData?.type_message_body}}:</h1>
                                                            <textarea #messageBox [(ngModel)]="messageBody.msg"
                                                                class="form-control" rows="4" style="resize:none;"
                                                                [placeholder]="localeData?.type_message_body_placeholder"></textarea>
                                                            <small class="mr-t05 mr-b05 grey"
                                                                style="margin-top:15px;display: block">{{localeData?.tip}}</small>

                                                            <div class="row mr-t2"
                                                                style="border: unset;margin-top: 20px;">
                                                                <ul class="list-inline pills">
                                                                    <li *ngFor="let val of dataVariables"
                                                                        (click)="addValueToMsg(val)"
                                                                        style="padding: 5px 10px !important;">
                                                                        {{val.name}}</li>
                                                                </ul>
                                                            </div>
                                                            <div class="mr-t4">
                                                                <button class="btn btn-sm btn-success pull-right mr-l1"
                                                                    (click)="send('sundrydebtors')">{{messageBody.btn.set}}</button>
                                                            </div>
                                                        </div>
                                                    </div>

                                                </div>

                                            </div>
                                        </div>
                                        <!-- </ul> -->

                                    </div>
                                </div>

                            </td>
                            <td class="word-wrap" [attr.data-title]="commonLocaleData?.app_parent_group"
                                *ngIf="showFieldFilter.parentGroup">
                                {{account.groupUniqueName}}</td>
                            <td [ngClass]="{'word-wrap text-right': true, 'negative-balance': account.openingBalance?.type === 'CREDIT' && formatAmountInCurrency(account.openingBalance?.amount) > 0}"
                                [attr.data-title]="localeData?.opening" *ngIf="showFieldFilter.openingBalance">
                                <span
                                    *ngIf="account.openingBalance?.type === 'CREDIT' && formatAmountInCurrency(account.openingBalance?.amount) > 0">-</span>{{account.openingBalance?.amount
                                |giddhCurrency}}
                            </td>
                            <td class="word-wrap text-right" [attr.data-title]="commonLocaleData?.app_receipts">
                                {{account.debitTotal |giddhCurrency}}</td>
                            <td class="word-wrap text-right" [attr.data-title]="commonLocaleData?.app_sales">
                                {{account.creditTotal |giddhCurrency}}</td>
                            <td [ngClass]="{'word-wrap text-right': true, 'negative-balance': account.closingBalance?.type === 'CREDIT' && formatAmountInCurrency(account.closingBalance?.amount) > 0}"
                                [attr.data-title]="localeData?.closing">
                                <span
                                    *ngIf="account.closingBalance?.type === 'CREDIT' && formatAmountInCurrency(account.closingBalance?.amount) > 0">-</span>{{account.closingBalance?.amount
                                |giddhCurrency}}
                            </td>
                            <td class="text-lowercase word-wrap" *ngIf="showFieldFilter.email"
                                [attr.data-title]="commonLocaleData?.app_email">
                                {{account.email || '-' }}</td>
                            <td class="word-wrap" *ngIf="showFieldFilter.mobile "
                                [attr.data-title]="commonLocaleData?.app_mobile_no">
                                {{account.mobileNo || '-'}}
                            </td>
                            <td class="word-wrap" *ngIf="showFieldFilter.gstin && shouldShowTaxFilter"
                                [attr.data-title]="commonLocaleData?.app_gstin">
                                {{account.gstIn || '-' }}</td>
                            <td class="word-wrap" *ngIf="showFieldFilter.state"
                                [attr.data-title]="commonLocaleData?.app_state">
                                {{account?.state?.name || '-'}}</td>
                            <td *ngIf='showFieldFilter.comment' (click)='updateCommentIdx = idx'
                                [attr.data-title]="localeData?.comment" class="commentField">
                                <ng-container *ngIf='updateCommentIdx != idx'>
                                    {{account.comment}}
                                    <span [class.text-gray]="!account.comment" *ngIf="!account.comment">{{
                                        localeData?.add_comment }}</span>
                                </ng-container>
                                <ng-container *ngIf='updateCommentIdx === idx'>
                                    <textarea class='form-control' maxlength='100' autofocus="true"
                                        [placeholder]="localeData?.enter_comment_here" [(ngModel)]='account.comment'
                                        (blur)='updateComment(account)'></textarea>
                                </ng-container>

                            </td>
                            <ng-container *ngFor="let item of account?.customFields">
                                <td *ngIf="item.key && showFieldFilter[item.uniqueName]" class="word-wrap"
                                    [attr.data-title]="item.key">
                                    {{item.value || '-' }}</td>
                            </ng-container>
                        </tr>
                        <tr>
                            <td [attr.colspan]="colspanLength" *ngIf="!(sundryDebtorsAccounts).length "
                                class="text-center empty-table ">
                                <h1>{{commonLocaleData?.app_no_record_found}}</h1>
                            </td>
                        </tr>

                    </ng-container>

                    <ng-container *ngIf="activeTab==='vendor' ">

                        <tr *ngFor="let account of sundryCreditorsAccounts; let idx=index ">
                            <td class="position-relative word-wrap customer-name vendor-customer-name cursor-pointer"
                                [attr.data-title]="localeData?.vendor" (clickOutside)="dropdown.hide()"
                                (dblclick)="dropdown.show()">
                                <div class="vendor-name-field">
                                    <span class="inline table-checkbox ">
                                        <label></label>
                                        <input type="checkbox" (click)="selectAccount($event, account) "
                                            [(ngModel)]="account.isSelected "
                                            [ngClass]="{ 'checkbox-visible': (selectedCheckedContacts.length || isMobileScreen), 'pos-abs': !selectedCheckedContacts.length} " />
                                    </span>
                                    <span>{{account.name}}</span>
                                    <div dropdown #dropdown="bs-dropdown" container="body" [autoClose]="false"
                                        class="icon-ellipse">
                                        <a id="edit-model-basic2" dropdownToggle
                                            class="dropdown-toggle icon-dots-three-vertical pull-right"
                                            aria-controls="dropdown-basic2" (click)="dropdown.show()">

                                        </a>

                                        <div id="dropdown-basic2" *dropdownMenu
                                            class="dropdown-menu dropdown-menu-right wd00" role="menu"
                                            aria-labelledby="edit-model-basic2">
                                            <div class="tb-pl-modal-header p-modal-tooltip p-0">

                                                <div class="account-detail-modal-header-div selection-none">

                                                    <div class="account-detail-modal-div">

                                                        <div class="account-detail-custom-header selection-none-header">

                                                            <div class="d-flex p-0 border-right-0">

                                                                <div
                                                                    class="account-detail-padding flex-fill border-right-0">
                                                                    <h3 class="account-detail-custom-title word-break">
                                                                        <span
                                                                            (click)="performActions(0, account)">{{account?.name}}</span>
                                                                    </h3>
                                                                </div>

                                                                <div class="account-detail-padding"
                                                                    (click)="updateCustomerAcc('vendor', account);">
                                                                    <img src="./assets/images/path.svg">
                                                                </div>

                                                            </div>

                                                            <div class="custom-detail account-detail-padding">
                                                                <h4>{{account?.mobileNo}}</h4>
                                                                <h4>{{account?.email}}</h4>
                                                                <h4>{{account?.gstIn}}</h4>
                                                            </div>

                                                        </div>

                                                        <div class="height-82px">

                                                            <ul class="list-unstyled">

                                                                <li class="li-link" *ngIf="!isMobileScreen">
                                                                    <a href="javascript: void 0"
                                                                        (click)="performActions(1, account)">{{commonLocaleData?.app_goto_ledger}}
                                                                    </a>
                                                                </li>

                                                                <li class="li-link" *ngIf="!isMobileScreen">
                                                                    <a href="javascript: void 0"
                                                                        (click)="performActions(2, account)">{{commonLocaleData?.app_record_bill}}
                                                                    </a>
                                                                </li>

                                                                <li class="li-link">
                                                                    <a href="javascript: void 0"
                                                                        (click)="performActions(3, account, $event )">{{commonLocaleData?.app_send_sms}}
                                                                    </a>
                                                                </li>

                                                                <li class="li-link">
                                                                    <a href="javascript: void 0"
                                                                        (click)="performActions(4, account, $event)">{{commonLocaleData?.app_send_email}}
                                                                    </a>
                                                                </li>

                                                            </ul>

                                                        </div>

                                                    </div>

                                                </div>

                                            </div>
                                        </div>


                                        <!--Modal for Mail/SMS-->
                                        <div class="modal fade border-radius-0" tabindex="-1" bsModal
                                            #mailModal="bs-modal" role="dialog" aria-hidden="true"
                                            (click)="$event.stopPropagation()">
                                            <div class="modal-dialog modal-md" style="margin:auto;margin-top: 200px">

                                                <div class="modal-content" style="padding: 8px 8px 8px 8px;">

                                                    <div class="border-radius-0" style="padding: 8px 8px 8px 8px;">

                                                        <div class="modal-header theme-bg pd-l2 pd-r2 clearfix"
                                                            style="padding: 8px 8px 8px 8px;">
                                                            <h3 class="modal-title bg" id="modal-title">
                                                                {{messageBody.header.set}}</h3>
                                                            <span aria-hidden="true" class="close" data-dismiss="modal"
                                                                [attr.aria-label]="commonLocaleData?.app_close"
                                                                (click)="mailModal.hide()">×</span>
                                                        </div>

                                                        <div class="modal-body pd-l2 pd-r2 clearfix"
                                                            style="padding: 0px !important;">
                                                            <h1 class="mr-b1" *ngIf="messageBody.type == 'Email'"
                                                                style="margin-top:15px;">{{localeData?.enter_subject}}:
                                                            </h1>
                                                            <input *ngIf="messageBody.type == 'Email'"
                                                                class="form-control mr-b1" #subject
                                                                [(ngModel)]="messageBody.subject" type="text"
                                                                [placeholder]="localeData?.enter_subject_placeholder" />
                                                            <h1 class="mr-b1" style="margin-top:15px;">
                                                                {{localeData?.type_message_body}}:</h1>
                                                            <textarea #messageBox [(ngModel)]="messageBody.msg"
                                                                class="form-control" rows="4" style="resize:none;"
                                                                [placeholder]="localeData?.type_message_body_placeholder"></textarea>
                                                            <small class="mr-t05 mr-b05 grey"
                                                                style="margin-top:15px;display: block">{{localeData?.tip}}</small>

                                                            <div class="row mr-t2"
                                                                style="border: unset;margin-top: 20px;">
                                                                <ul class="list-inline pills">
                                                                    <li *ngFor="let val of dataVariables"
                                                                        (click)="addValueToMsg(val)"
                                                                        style="padding: 5px 10px !important;">
                                                                        {{val.name}}</li>
                                                                </ul>
                                                            </div>
                                                            <div class="mr-t4">
                                                                <button class="btn btn-sm btn-success pull-right mr-l1"
                                                                    (click)="send('sundrycreditors')">{{messageBody.btn.set}}</button>
                                                            </div>
                                                        </div>
                                                    </div>

                                                </div>

                                            </div>
                                        </div>
                                        <!-- </ul> -->

                                    </div>
                                </div>
                            </td>
                            <td class="word-wrap" [attr.data-title]="commonLocaleData?.app_parent_group"
                                *ngIf="showFieldFilter.parentGroup">
                                <div class="table-email">{{account.groupUniqueName}}</div>
                            </td>
                            <td [ngClass]="{'word-wrap text-right': true, 'negative-balance': account.openingBalance?.type === 'DEBIT' && formatAmountInCurrency(account.openingBalance?.amount) > 0}"
                                [attr.data-title]="localeData?.opening" *ngIf="showFieldFilter.openingBalance">
                                <span
                                    *ngIf="account.openingBalance?.type === 'DEBIT' && formatAmountInCurrency(account.openingBalance?.amount) > 0">-</span>{{account.openingBalance?.amount
                                | giddhCurrency}}
                            </td>
                            <td class="word-wrap text-right" [attr.data-title]="commonLocaleData?.app_purchase">
                                {{account.creditTotal |giddhCurrency}}</td>
                            <td class="word-wrap text-right" [attr.data-title]="commonLocaleData?.app_payment">
                                {{account.debitTotal |giddhCurrency}}</td>
                            <td [ngClass]="{'word-wrap text-right': true, 'negative-balance': account.closingBalance?.type === 'DEBIT' && formatAmountInCurrency(account.closingBalance?.amount) > 0}"
                                [attr.data-title]="localeData?.closing">
                                <span
                                    *ngIf="account.closingBalance?.type === 'DEBIT' && formatAmountInCurrency(account.closingBalance?.amount) > 0">-</span>{{account.closingBalance?.amount
                                | giddhCurrency}}
                            </td>
                            <td class="word-wrap text-lowercase" *ngIf="showFieldFilter.email "
                                [attr.data-title]="commonLocaleData?.app_email">
                                <div class="table-email ">{{account.email || '-' }}</div>
                            </td>
                            <td class="word-wrap" *ngIf="showFieldFilter.mobile "
                                [attr.data-title]="commonLocaleData?.app_mobile_no">
                                {{account.mobileNo || '-' }}
                            </td>
                            <td class="word-wrap" *ngIf="showFieldFilter.gstin  && shouldShowTaxFilter"
                                [attr.data-title]="commonLocaleData?.app_gstin">
                                {{account.gstIn || '-' }}</td>
                            <td class="word-wrap" *ngIf="showFieldFilter.state "
                                [attr.data-title]="commonLocaleData?.app_state">{{account?.state?.name || '-' }}
                            </td>
                            <td *ngIf='showFieldFilter.comment' (click)='updateCommentIdx = idx'
                                [attr.data-title]="localeData?.comment">
                                <ng-container *ngIf='updateCommentIdx != idx'>
                                    {{account.comment || '-'}}
                                </ng-container>
                                <ng-container *ngIf='updateCommentIdx === idx'>
                                    <textarea class='form-control' maxlength='100' [(ngModel)]='account.comment'
                                        (blur)='updateComment(account)'></textarea>
                                </ng-container>
                            </td>
                            <ng-container *ngFor="let item of account?.customFields">
                                <td *ngIf="item?.uniqueName && showFieldFilter[item?.uniqueName]" class="word-wrap"
                                    [attr.data-title]="item.key">
                                    {{item.value || '-' }}</td>
                            </ng-container>
                            <td data-title="Action" *ngIf="isICICIIntegrated">
                                <button *ngIf="account?.bankPaymentDetails && account?.country?.code==='IN'"
                                    class="btn btn-small btn-success" (click)="openBulkPaymentModal(template, account)">
                                    {{commonLocaleData?.app_pay_now}} </button>
                                <button *ngIf="!account.bankPaymentDetails " class="btn btn-small btn-light "
                                    (click)="updateCustomerAcc('vendor', account)">{{commonLocaleData?.app_add_bank_details}}
                                </button>
                            </td>
                        </tr>
                        <tr *ngIf="!(sundryCreditorsAccounts).length ">
                            <td [attr.colspan]="colspanLength" class="text-center empty-table">
                                <h1>{{commonLocaleData?.app_no_record_found}}</h1>
                            </td>
                        </tr>

                    </ng-container>
                </tbody>
            </table>
        </div>

        <div colspan="100%" class="xs-pl-0 pagination-wrapper">
            <div
                *ngIf="activeTab === 'customer' && sundryDebtorsAccountsBackup.results && sundryDebtorsAccountsBackup.results.length && totalCustomers>=paginationLimit">
                <div class="text-center">
                    <pagination [totalItems]="sundryDebtorsAccountsBackup.totalItems"
                        [(ngModel)]="sundryDebtorsAccountsBackup.page" [maxSize]="5" class="pagination-sm"
                        [boundaryLinks]="true" [itemsPerPage]="sundryDebtorsAccountsBackup.count" [rotate]="false"
                        (pageChanged)="pageChanged($event)" [firstText]="commonLocaleData?.app_first"
                        [previousText]="commonLocaleData?.app_previous" [nextText]="commonLocaleData?.app_next"
                        [lastText]="commonLocaleData?.app_last">
                    </pagination>
                </div>
            </div>

            <div
                *ngIf="activeTab === 'vendor' && sundryCreditorsAccountsBackup.results && sundryCreditorsAccountsBackup.results.length && totalVendors>=paginationLimit">
                <div class="text-center">
                    <pagination [totalItems]="sundryCreditorsAccountsBackup.totalItems"
                        [(ngModel)]="sundryCreditorsAccountsBackup.page" [maxSize]="5" class="pagination-sm"
                        [boundaryLinks]="true" [itemsPerPage]="sundryCreditorsAccountsBackup.count" [rotate]="false"
                        (pageChanged)="pageChanged($event)" [firstText]="commonLocaleData?.app_first"
                        [previousText]="commonLocaleData?.app_previous" [nextText]="commonLocaleData?.app_next"
                        [lastText]="commonLocaleData?.app_last">
                    </pagination>
                </div>
            </div>
        </div>

    </ng-template>

    <!-- region sorting template -->
    <ng-template #sortingTemplate let-col>
        <div class="icon-pointer cp">
            <div class="icon-sort-asc text-light-2 d-block font-xxs" (click)="sort(col, 'asc')" *ngIf="key !== col"
                [ngClass]="{'active-text-color': key === col && order === 'asc'}"></div>

            <div class="icon-sort-asc text-light-2 d-block font-xxs" (click)="sort(col, 'desc')"
                *ngIf="key === col && order === 'asc'"
                [ngClass]="{'active-text-color': key === col && order === 'asc'}">
            </div>

            <div class="icon-sort-dsc text-light-2 d-block font-xxs" *ngIf="key === col && order === 'desc'"
                (click)="sort(col, 'asc')" [ngClass]="{'active-text-color': key === col && order === 'desc'}"></div>
        </div>
    </ng-template>
    <!-- endregion bank integration from by bank name:  ui/bank/integration/form?bankName=ICICI&= -->


    <ng-template #template>
        <payment-aside *ngIf="isBulkPaymentShow" [selectedAccountsForBulkPayment]="selectedAccountsList"
            [selectedAccForPayment]="selectedAccForPayment" [localeData]="localeData"
            [commonLocaleData]="commonLocaleData" (closeModelEvent)="closeBulkPaymentModel($event)"></payment-aside>
    </ng-template>
    <!-- endregion -->

    <ng-template #datepickerTemplate>
        <div class="datepicker-modal">
            <div class="modal-body">
                <app-datepicker-wrapper [inputStartDate]="selectedDateRange?.startDate"
                    [inputEndDate]="selectedDateRange?.endDate" [alwaysShowCalendars]="true"
                    [ranges]="datePickerOptions" [selectedRangeLabel]="selectedRangeLabel" [showCustomRangeLabel]="true"
                    [showClearButton]="false" [showCancel]="true" [linkedCalendars]="true" [showDropdowns]="true"
                    (rangeClicked)="selectedDate($event)"
                    (datesUpdated)="selectedDate($event)" [keepCalendarOpeningWithRange]="false"
                    [showRangeLabelOnInput]="false" [dateFieldPosition]="dateFieldPosition"></app-datepicker-wrapper>
            </div>
        </div>
    </ng-template>
</ng-container>