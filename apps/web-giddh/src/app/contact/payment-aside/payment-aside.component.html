<div class="modal-header">
    <h4 class="modal-title pull-left">Payment</h4>
    <button type="button" class="close pull-right" aria-label="Close" (click)="closePaymentModel()">
        <span aria-hidden="true">&times;</span>
    </button>
</div>
<div class="modal-body">
    <div class="clearfix">
        <form #adjustAdvancePaymentForm="ngForm" autocomplete="off">
            <div class="row d-flex align-items-center payment-top-form">
                <div class="col-md-8">
                    <div class="d-flex">
                        <div class="form-group mr-15">
                            <label>Select Bank<span class="red-text">*</span></label>
                            <sh-select *ngIf="selectIntegratedBankList.length > 1" [options]="selectIntegratedBankList" [(ngModel)]="selectedBankName" class="text-left" name="urn" required [placeholder]="'Select Bank'" (selected)="selectBank($event);" [multiple]="false">
                                <ng-template #optionTemplate let-option="option">
                                    <a href="javascript:void(0)" class="list-item">
                                        <div class="item">{{option.label}}</div>
                                        <div class="item_unq">
                                            <p class="font-12 text-gray mb-0">(Cr: {{option.urn}})
                                            </p>
                                        </div>
                                    </a>
                                </ng-template>
                            </sh-select>
                            <sh-select *ngIf="selectIntegratedBankList.length === 1" [options]="selectIntegratedBankList" [(ngModel)]="selectedBankUrn" class="text-left" name="urn" required [placeholder]="'Select Bank'" (ngModelChange)="selectBank($event);" [multiple]="false">
                                <ng-template #optionTemplate let-option="option">
                                    <a href="javascript:void(0)" class="list-item">
                                        <div class="item">{{option.label}}</div>
                                        <div class="item_unq">
                                            <p class="font-12 text-gray mb-0">(Cr: {{option.urn}})
                                            </p>
                                        </div>
                                    </a>
                                </ng-template>
                            </sh-select>
                            <!-- it will shows if only one bank -->
                            <!-- <input *ngIf="selectIntegratedBankList.length === 1" class="form-control" [(ngModel)]="selectedBankName" name="urn" readonly [value]="selectIntegratedBankList[0].bankName"> -->
                            <p class="mb-1"><small class="text-gray">Bal {{totalAvailableBalance}} dr.</small></p>
                        </div>
                        <div class="form-group mr-15">
                            <label>Total Amount<span class="red-text">*</span></label>
                            <input type="text" class="form-control" disabled [(ngModel)]="totalSelectedAccountAmount" name="amount">
                        </div>
                        <div class="form-group mr-15" *ngIf="isPayclicked">
                            <label class="relative d-flex">Enter OTP<span class="red-text">*</span>
                                <small class="resend-btn" *ngIf="!timerOn"><a href="javascript:void();"
                                        (click)="reSendOTP()">Resend</a></small>
                                <!-- make timer dynamic -->
                                <small class="resend-btn timer-count" *ngIf="timerOn"><a
                                        href="javascript:void();">{{timerCountDown$ | async}}</a></small>
                            </label>
                            <input type="text" class="form-control" placeholder="Enter OTP" name="OTP" [(ngModel)]="OTP" type="number" maxlength="4">
                        </div>
                        <div class="form-group mr-15">
                            <label class="d-flex"> &nbsp; </label>
                            <button type="button" *ngIf="!isPayclicked" class="btn btn-success" [disabled]="!adjustAdvancePaymentForm.form.valid" (click)="payClicked(adjustAdvancePaymentForm)">Pay</button>
                            <button *ngIf="isPayclicked" class="btn btn-success" [disabled]="!adjustAdvancePaymentForm.form.valid" (click)="confirmOTP()">Confirm</button>
                            <button type="button" *ngIf="isPayclicked" class="btn btn-primary" (click)="clickedCancelOtp();">Cancel OTP</button>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <p class="otp-success-msg text-right"> <span>
                            <img src="../../../assets/images/checked-success.svg">
                        </span> A OTP has been sent to Shubhendra Agrawal</p>
                </div>

            </div>
            <div class="selected-bank-details">
                <!-- loop should in below div -->
                <ng-container *ngFor="let item of selectedAccForBulkPayment;let entryIdx = index; let first = first; let last = last">
                    <div class="mb-2">
                        <div class="account-holder-name">
                            <p>{{item.name}}</p>
                            <p class="text-gray due-amount">
                                Total Due:{{item.closingBalance.amount}}
                                <span class="red-text cursor-pointer" (click)="removeSelectedAccount(item); removeTransactionsDetailsForm(entryIdx)"><i
                                        class="icon-trash mr-05"></i>Remove</span>
                            </p>
                        </div>
                        <div class="bank-deatils-wrapper">
                            <div class="readonly-bank-deatils">
                                <div class="label-value-data">
                                    <label>Bank Name</label>
                                    <label>{{item.accountBankDetails.bankName}}</label>
                                    <!-- <input class="form-control" [value]="item?.accountBankDetails?.bankName" name="bankName{{entryIdx}}" [(ngModel)]="item.accountBankDetails.bankName" type="text" disabled /> -->
                                </div>
                                <div class="label-value-data d-flex">
                                    <div class="mr-1">
                                        <!-- <label>Account Number</label> -->
                                        <label *ngIf="countryCode ==='IN' ">Account #:</label>
                                        <label *ngIf="countryCode !=='IN' ">IBAN</label>
                                        <label>{{item.accountBankDetails.bankAccountNo}}</label>
                                        <!-- <input class="form-control" [value]="item?.accountBankDetails?.bankAccountNo" name="bankAccountNo{{entryIdx}}" [(ngModel)]="item.accountBankDetails.bankAccountNo" type="text" disabled> -->
                                    </div>
                                    <div *ngIf="countryCode !=='IN' ">
                                        <label>SWIFT Code/BIC</label>
                                        <input class="form-control" [value]="item?.accountBankDetails?.swiftCode" name="swiftCode{{entryIdx}}" [(ngModel)]="item.accountBankDetails.swiftCode" type="text" disabled>
                                    </div>
                                    <div *ngIf="countryCode ==='IN' ">
                                        <label>IFSC Code:</label>
                                        <label>{{item?.accountBankDetails?.ifsc}}</label>
                                        <!-- <input class="form-control" [value]="item?.accountBankDetails?.ifsc" name="ifsc{{entryIdx}}" [(ngModel)]="item.accountBankDetails.ifsc" type="text" disabled> -->
                                    </div>

                                </div>
                            </div>
                            <div class="amount-remark-section">
                                <div class="d-flex">
                                    <div class="form-group pr-15">
                                        <label>Amount<span class="text-danger">*</span></label>
                                        <input class="form-control" name="closingBalanceAmount{{entryIdx}}" [disabled]="isPayclicked" required [(ngModel)]="item.closingBalance.amount" type="number">
                                    </div>
                                    <div class="form-group remark-block">
                                        <label>Remark<span class="text-danger">*</span></label>
                                        <textarea rows="1" name="remark{{entryIdx}}" id="{{entryIdx}}" [(ngModel)]="item.remarks" autocomplete="off" required type="text" class="form-control" placeholder="Remark"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </ng-container>


                <!-- <div class="creditors_detail">
            <p>{{accountDetails?.name}}</p>
            <div class="contactDetails">
                <p class="contactNo">
                    {{accountDetails?.mobileNo}}
                </p>
                <p>{{accountDetails?.uniqueName}}</p>
                <p>{{accountDetails?.addresses[0]?.gstNumber}}</p>
                <div class="row mrB1">
                    <div class="col-sm-6 col-xs-12" *ngIf="countryCode ==='AE'">
                        <label>Beneficiary Name</label>
                        <input class="form-control" [value]="accountDetails?.accountBankDetails[0]?.beneficiaryName" type="text" disabled />
                    </div>
                    <div class="col-sm-6 col-xs-12" [ngClass]="{'mrT1': countryCode ==='AE'}">
                        <label>Bank Name</label>
                        <input class="form-control" [value]="accountDetails?.accountBankDetails[0]?.bankName" type="text" disabled />
                    </div>
                    <div class="col-sm-6 col-xs-12" *ngIf="countryCode ==='AE'">
                        <div class="form-group">
                            <label>Branch Name</label>
                            <input class="form-control" [value]="accountDetails?.accountBankDetails[0]?.branchName" type="text" disabled>
                        </div>
                    </div>
                    <div class="col-sm-6 col-xs-12" [ngClass]="{'mrT1': countryCode ==='AE'}">
                        <div class="form-group">
                            <label *ngIf="countryCode ==='IN' ">Account Number</label>
                            <label *ngIf="countryCode !=='IN' ">IBAN</label>
                            <input class="form-control" [value]="accountDetails?.accountBankDetails[0]?.bankAccountNo" type="text" disabled>
                        </div>
                    </div>
                    <div class="col-sm-6 col-xs-12" *ngIf="countryCode ==='AE'">
                        <div class="form-group">
                            <label>SWIFT Code/BIC</label>
                            <input class="form-control" [value]="accountDetails?.accountBankDetails[0]?.swiftCode" type="text" disabled>
                        </div>
                    </div>
                    <div class="col-sm-6 col-xs-12" *ngIf="countryCode ==='IN'">
                        <div class="form-group">
                            <label>IFSC Code</label>
                            <input class="form-control" [value]="accountDetails?.accountBankDetails[0]?.ifsc" type="text" disabled>
                        </div>
                    </div>
                </div>
                <div class="row mrB1">
                    <div class="col-sm-6 col-xs-12">
                        <div class="form-group">
                            <label>Bank Name</label>
                            <input class="form-control" [value]="accountDetails?.accountBankDetails[0]?.bankName" type="text" disabled>
                        </div>
                    </div>
                </div>
            </div>
        </div> -->

                <!-- <div>
            <div>
                <div class="accountDetils">
                    <div class="selectMode">
                        <form #paymentForm="ngForm" autocomplete="off">
                            <div class="row mrB2">
                                <div class="col-sm-6 col-xs-12">
                                    <div class="form-group custom-select pos-rel">
                                        <label>Select Mode<span class="text-danger">*</span></label>
                                        <div dropdown>
                                            <select class="form-control" [disabled]="OTPsent" [(ngModel)]="mode" name="mode" id="mode">
                                                <option *ngFor="let account of registeredAccounts"
                                                    [ngValue]="account">
                                                    {{account.bank}}
                                                </option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-3 col-xs-12">
                                    <div class="form-group">
                                        <label>Amount<span class="text-danger">*</span></label>
                                        <input class="form-control" name="amount" [(ngModel)]="amount" type="number">
                                    </div>
                                </div>
                            </div>
                            <div class="row mrB2">
                                <div class="form-group">
                                    <div class="col-sm-9 col-xs-12">
                                        <label>Remark<span class="text-danger">*</span></label>
                                        <textarea rows="5" autocomplete="off" type="text" class="form-control" placeholder="Remark" [(ngModel)]="remarks" name="remarks"></textarea>
                                    </div>
                                </div>
                            </div>
                            <div class="row mrB1" *ngIf="OTPsent">
                                <div class="col-sm-6 col-xs-12">
                                    <div class="form-group">
                                        <label>Enter OTP</label>
                                        <input class="form-control" name="OTP" [(ngModel)]="OTP" type="number" maxlength="4">
                                    </div>
                                </div>

                                <div class="col-sm-6 col-xs-12">
                                    <div class="form-group">
                                        <label> </label>
                                        <div style="margin-top: 15px; cursor: pointer"><a (click)="reSendOTP()">Resend
                                                OTP</a></div>
                                    </div>
                                </div>

                            </div>
                            <div class="row">
                                <div class="col-sm-12">
                                    <button *ngIf="!OTPsent" class="btn btn-success" [disabled]="!mode || amount===0 || remarks === ''" (click)="sendOTP()">Send
                                        OTP</button>
                                    <button *ngIf="OTPsent" class="btn btn-success" [disabled]="!mode || amount===0 || remarks === ''" (click)="confirmOTP()">Confirm</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div> -->
            </div>
        </form>
    </div>

    <ng-template #template>
        <div class="modal-header">
            <h4 class="modal-title pull-left">Payment Status</h4>
            <button type="button" class="close pull-right" aria-label="Close" (click)="successModalRef.hide()">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">
            <div class="Payment-img">
                <img src="../../../assets/images/payment-succes.svg">
            </div>
            <h4>Payment proceed</h4>
            <p>Status of all payments will be mailed shortly.</p>
            <button class="btn btn-success" (click)="closePaymentModel()">Done</button>
        </div>
    </ng-template>

    <!-- <button id="close" (click)="closeAsidePane($event)"><i class="icon-cross"></i></button>
  -->

    <!-- (click)="successModalRef.hide()" -->
