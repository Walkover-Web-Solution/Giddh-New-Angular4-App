<section class="mr-t15 mr-b15">
    <div>
        <div
            class="btn-group"
            #filterDropdown="bs-dropdown"
            dropdown
            [autoClose]="false"
            (clickOutside)="filterDropdown.hide()"
        >
            <button type="button" mat-stroked-button color="primary" [matMenuTriggerFor]="filterByAccountMenu">
                {{ localeData?.filter_by_account }} <span class="caret"></span>
            </button>
            <mat-menu #filterByAccountMenu="matMenu" (click)="$event.stopPropagation();">
                <form
                    [formGroup]="searchQueryForm"
                    novalidate
                    name="searchQueryForm"
                    id="searchQueryForm"
                    class="form-inline flex-row flex-wrap pd-1"
                    (click)="$event.stopPropagation();"
                >
                    <!-- repeater -->
                    <div
                        class="position-relative query-list query-list d-flex"
                        [ngClass]="{ 'mr-t2': i !== 0 }"
                        formArrayName="searchQuery"
                        *ngFor="let item of searchQueryForm.get('searchQuery')['controls']; let i = index; let l = last"
                    >
                        <div [formGroupName]="i" class="d-flex">
                            <!-- <label>{{ localeData?.whose }}</label>
                            <span class="position-relative form-group">
                                <select class="form-control custom-select-field" formControlName="queryType" required>
                                    <option value="">{{ commonLocaleData?.app_select_type }}</option>
                                    <option *ngFor="let queryType of queryTypes" value="{{ queryType?.uniqueName }}">
                                        {{ queryType.name }}
                                    </option>
                                </select>
                                <i class="icon-caret-down"></i>
                            </span> -->
                            <dropdown-field
                            (click)="$event.stopPropagation();"
                                class="mr-3"
                                [required]="true"
                                [placeholder]="commonLocaleData?.app_select_type"
                                [label]="localeData?.whose"
                            >
                            </dropdown-field>
                            <!-- <label>{{ localeData?.is }}</label>
                            <span class="position-relative form-group">
                                <select class="form-control custom-select-field" formControlName="queryDiffer" required>
                                    <option value="">{{ localeData?.select_query }}</option>
                                    <option *ngFor="let queryDiffer of queryDiffers" value="{{ queryDiffer }}">
                                        {{ queryDiffer }}
                                    </option>
                                </select>
                                <i class="icon-caret-down"></i>
                            </span> -->
                            <dropdown-field
                            (click)="$event.stopPropagation();"
                                class="mr-3"
                                [required]="true"
                                [placeholder]="localeData?.select_query"
                                [label]="localeData?.is"
                            >
                            </dropdown-field>
                            <!-- <label
                                *ngIf="
                                    item?.value.queryDiffer === 'Less' ||
                                    item?.value.queryDiffer === 'Greater' ||
                                    !item?.value.queryDiffer
                                "
                                >{{ localeData?.than }}</label
                            >
                            <label *ngIf="item?.value.queryDiffer === 'Equals'" [style.margin-right.px]="15">{{
                                localeData?.to
                            }}</label>
                            <span class="form-group">
                                <input
                                    required
                                    [style.width.px]="70"
                                    class="form-control"
                                    formControlName="amount"
                                    type="text"
                                    [placeholder]="commonLocaleData?.app_amount"
                                    decimalDigitsDirective
                                    [DecimalPlaces]="2"
                                />
                            </span> -->
                            <input-field
                            (click)="$event.stopPropagation();"
                                *ngIf="
                                    item?.value.queryDiffer === 'Less' ||
                                    item?.value.queryDiffer === 'Greater' ||
                                    !item?.value.queryDiffer
                                "
                                [type]="'text'"
                                [required]="true"
                                [allowDecimalDigitsOnly]="true"
                                [customDecimalPlaces]="2"
                                [placeholder]="commonLocaleData?.app_amount"
                                [label]="localeData?.than"
                            >
                            </input-field>

                            <input-field
                            (click)="$event.stopPropagation();"
                                *ngIf="item?.value.queryDiffer === 'Equals'"
                                [type]="'text'"
                                [required]="true"
                                [allowDecimalDigitsOnly]="true"
                                [customDecimalPlaces]="2"
                                [placeholder]="commonLocaleData?.app_amount"
                                [label]="localeData?.to"
                            >
                            </input-field>

                            <!--By and To: Not required in paginated API -->
                            <span
                                class="position-relative form-group"
                                *ngIf="item?.value.queryType === 'openingBalance'"
                            >
                                <select class="form-control custom-select-field" formControlName="openingBalanceType">
                                    <option *ngFor="let type of balType" value="{{ type?.uniqueName }}">
                                        {{ type.name }}
                                    </option>
                                </select>
                                <i class="icon-caret-down"></i>
                            </span>
                            <span
                                class="position-relative form-group"
                                *ngIf="item?.value.queryType === 'closingBalance'"
                            >
                                <select class="form-control custom-select-field" formControlName="closingBalanceType">
                                    <option *ngFor="let type of balType" value="{{ type?.uniqueName }}">
                                        {{ type.name }}
                                    </option>
                                </select>
                                <i class="icon-caret-down"></i>
                            </span>
                            <label *ngIf="searchDataSet?.controls?.length > 1 && !l" class="condition_tag">{{
                                localeData?.and
                            }}</label>
                        </div>
                    </div>
                    <!--end of clearfix first row -->
                    <!-- end repeater -->
                    <div class="clearfix mr-t4">
                        <button
                            [disabled]="searchQueryForm.invalid"
                            mat-stroked-button 
                            color="primary"
                            class="pull-right"
                            (click)="filterData(); filterDropdown.hide()"
                        >
                            {{ commonLocaleData?.app_search }}
                        </button>
                        <button
                            [disabled]="searchDataSet?.controls?.length > 3 || searchQueryForm.invalid"
                            mat-stroked-button
                            (click)="addSearchRow()"
                        >
                            {{ localeData?.add_new_query }}
                        </button>
                        <button
                            *ngIf="searchDataSet?.controls?.length > 1"
                            mat-stroked-button
                            class="mr-r1"
                            (click)="removeSearchRow()"
                        >
                            {{ localeData?.delete_row }}
                        </button>
                    </div>
                    <!-- end of second row -->
                </form>
            </mat-menu>
        </div>
        <button *ngIf="isFiltered | async" (click)="resetQuery()" mat-stroked-button>
            <i class="icon-refresh"></i>
            {{ commonLocaleData?.app_reset }}
        </button>
        <div class="pull-right">
            <div class="btn-group" *ngIf="showSendButton">
                <button type="button" mat-stroked-button [matMenuTriggerFor]="sendAsMenu">
                    {{ localeData?.send_as }}
                    <span class="caret"></span>
                </button>
                <mat-menu #sendAsMenu="matMenu">
                    <button mat-menu-item (click)="openEmailDialog.emit()">{{ commonLocaleData?.app_email }}</button>
                </mat-menu>
                <!-- <ul
                   
                    class="dropdown-menu dropdown-menu-right"
                >
                    <li role="menuitem">
                        <a class="dropdown-item cp" (click)="openEmailDialog.emit()">{{
                            commonLocaleData?.app_email
                        }}</a>
                    </li> -->
                    <!-- <li role="menuitem" (click)="openSmsDialog.emit()">
                        <a class="dropdown-item cp">{{commonLocaleData?.app_sms}}</a>
                    </li> -->
                <!-- </ul> -->
            </div>
            <button type="button" mat-stroked-button color="primary" *ngIf="showDownloadCsv" (click)="createCSV()">
                {{ commonLocaleData?.app_download_csv }}
            </button>
        </div>
    </div>
    <!--end of query section grey bg-->
</section>
