<ng-container
    appTranslate
    [file]="'accounts'"
    (localeData)="localeData = $event"
    (commonLocaleData)="commonLocaleData = $event"
    (translationComplete)="translationComplete($event)"
>
    <form name="addAccountForm" class="create-acc-form" [formGroup]="addAccountForm">
        <div>
            <div class="upper-form">
                <div class="row">
                    <div class="col-sm-4">
                        <div class="ng-select-wrap select-list select-group disable-select-group">
                            <label>{{ commonLocaleData?.app_group }}<span class="red-text">*</span> </label>
                            <ng-select
                                [placeholder]="localeData?.select_group_label"
                                [disabled]="true"
                                [filterPlaceholder]="localeData?.select_group_label"
                                (selected)="selectGroup($event)"
                                formControlName="activeGroupUniqueName"
                                [options]="activeAccountGroup"
                                class="wd100"
                            >
                                <ng-template #optionTemplate let-option="option">
                                    <div class="account-list-item">{{ option?.label }}</div>
                                    <div class="account-list-item font-12">{{ option?.value }}</div>
                                </ng-template>
                            </ng-select>
                        </div>
                    </div>
                    <div class="col-sm-8">
                        <div class="form-group">
                            <label>{{ localeData?.account_name }} <sup class="text-danger">*</sup> </label>
                            <input
                                type="text"
                                class="form-control"
                                #autoFocusUpdate
                                formControlName="name"
                                name="accountName"
                                [placeholder]="localeData?.account_name"
                            />
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-4">
                        <div class="form-group" formGroupName="country">
                            <label>{{ commonLocaleData?.app_country }} <sup class="text-danger">*</sup> </label>
                            <sh-select
                                [options]="countrySource"
                                [isFilterEnabled]="true"
                                (viewInitEvent)="onViewReady($event)"
                                formControlName="countryCode"
                                [defaultValue]="accountCountryName"
                                (selected)="selectCountry($event)"
                                [useInBuiltFilterForIOptionTypeItems]="true"
                                [isRequired]="true"
                                [disabled]="true"
                            ></sh-select>
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <div class="form-group">
                            <label>{{ localeData?.currency }}</label>
                            <sh-select
                                [options]="currencySource$ | async"
                                defaultValue="{{ selectedCurrency }}"
                                formControlName="currency"
                                [isFilterEnabled]="true"
                                [disabled]="true"
                            ></sh-select>
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <div class="cr-dr-account">
                            <label>{{ localeData?.opening_balance }}</label>
                            <div
                                [ngClass]="{ 'input-group': addAccountForm.get('openingBalance')?.value > 0 }"
                                class="obj-gap"
                            >
                                <input
                                    type="number"
                                    min="0"
                                    class="form-control text-right"
                                    digitsOnlyDirective
                                    formControlName="openingBalance"
                                    [placeholder]="
                                        commonLocaleData?.app_numbers?.zero +
                                        '' +
                                        commonLocaleData?.app_numbers?.zero +
                                        '.' +
                                        commonLocaleData?.app_numbers?.zero +
                                        '' +
                                        commonLocaleData?.app_numbers?.zero
                                    "
                                    [readonly]="isCompanyMode"
                                />
                                <div
                                    class="input-group-addon"
                                    (click)="isCompanyMode ? null : openingBalanceTypeChnaged('DEBIT')"
                                    [ngClass]="{
                                        'active-toggle-btn':
                                            addAccountForm.get('openingBalanceType')?.value === 'DEBIT' &&
                                            addAccountForm.get('openingBalance')?.value > 0,
                                        'cp': addAccountForm.get('openingBalance')?.value > 0
                                    }"
                                    *ngIf="addAccountForm.get('openingBalance')?.value > 0"
                                >
                                    {{ commonLocaleData?.app_dr?.toUpperCase() }}
                                </div>
                                <div
                                    class="input-group-addon"
                                    (click)="isCompanyMode ? null : openingBalanceTypeChnaged('CREDIT')"
                                    [ngClass]="{
                                        'active-toggle-btn':
                                            addAccountForm.get('openingBalanceType')?.value === 'CREDIT' &&
                                            addAccountForm.get('openingBalance')?.value > 0,
                                        'cp': addAccountForm.get('openingBalance')?.value > 0
                                    }"
                                    *ngIf="addAccountForm.get('openingBalance')?.value > 0"
                                >
                                    {{ commonLocaleData?.app_cr?.toUpperCase() }}
                                </div>
                            </div>
                            <div class="d-flex justify-content-end">
                                <a href="javascript:;" (click)="openBulkAddDialog()" class="font-14" *ngIf="isCompanyMode">{{ localeData?.bulk_add }}</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row" *ngIf="addAccountForm.get('currency')?.value !== companyCurrency">
                    <div class="form-group col-xs-12 col-sm-4">
                        <label for="">{{ localeData?.foreign_opening_balance }}</label>
                        <div
                            [ngClass]="{ 'input-group': addAccountForm.get('foreignOpeningBalance')?.value > 0 }"
                            class="obj-gap"
                        >
                            <input
                                type="text"
                                min="0"
                                class="form-control text-right"
                                formControlName="foreignOpeningBalance"
                                [placeholder]="
                                    commonLocaleData?.app_numbers?.zero +
                                    '' +
                                    commonLocaleData?.app_numbers?.zero +
                                    '.' +
                                    commonLocaleData?.app_numbers?.zero +
                                    '' +
                                    commonLocaleData?.app_numbers?.zero
                                "
                                decimalDigitsDirective
                            />
                            <div
                                class="input-group-addon"
                                (click)="openingBalanceTypeChnaged('DEBIT')"
                                [ngClass]="{
                                    'active-toggle-btn': addAccountForm.get('openingBalanceType')?.value === 'DEBIT',
                                    'cp': addAccountForm.get('openingBalance')?.value > 0
                                }"
                                *ngIf="addAccountForm.get('foreignOpeningBalance')?.value > 0"
                            >
                                {{ commonLocaleData?.app_dr?.toUpperCase() }}
                            </div>
                            <div
                                class="input-group-addon"
                                (click)="openingBalanceTypeChnaged('CREDIT')"
                                [ngClass]="{
                                    'active-toggle-btn': addAccountForm.get('openingBalanceType')?.value === 'CREDIT',
                                    'cp': addAccountForm.get('openingBalance')?.value > 0
                                }"
                                *ngIf="addAccountForm.get('foreignOpeningBalance')?.value > 0"
                            >
                                {{ commonLocaleData?.app_cr?.toUpperCase() }}
                            </div>
                        </div>
                    </div>
                </div>
                <ng-container *ngIf="isHsnSacEnabledAcc">
                    <div class="row">
                        <div class="col-8 col-sm-8 form-group">
                            <div class="input-group d-flex">
                                <div class="d-flex">
                                    <span class="mr-r15">
                                        <input
                                            type="radio"
                                            class="radio-custom radio-theme"
                                            name="hsnOrSac"
                                            id="hsnCodeType"
                                            formControlName="hsnOrSac"
                                            value="hsn"
                                        />
                                        <label for="hsnCodeType" class="radio-custom-label">{{
                                            commonLocaleData?.app_hsn
                                        }}</label>
                                    </span>
                                    <span>
                                        <input
                                            type="radio"
                                            class="radio-custom radio-theme"
                                            name="hsnOrSac"
                                            id="sacCodeType"
                                            formControlName="hsnOrSac"
                                            value="sac"
                                        />
                                        <label for="sacCodeType" class="ml-1 radio-custom-label">{{
                                            commonLocaleData?.app_sac
                                        }}</label>
                                    </span>
                                </div>
                                <input
                                    type="text"
                                    class="form-control ml-4 bdr"
                                    maxlength="10"
                                    decimalDigitsDirective
                                    formControlName="hsnNumber"
                                    *ngIf="addAccountForm.get('hsnOrSac')?.value === 'hsn'"
                                />
                                <input
                                    type="text"
                                    class="form-control ml-4 bdr"
                                    maxlength="10"
                                    formControlName="sacNumber"
                                    decimalDigitsDirective
                                    *ngIf="addAccountForm.get('hsnOrSac')?.value === 'sac'"
                                />
                            </div>
                        </div>
                    </div>
                </ng-container>
            </div>
        </div>

        <tabset #staticTabs class="custom-tabs" id="asidePaneFormTabs">
            <ng-container>
                <tab
                    [heading]="localeData?.tabs?.address"
                    [active]="!isHsnSacEnabledAcc"
                    [disabled]="isHsnSacEnabledAcc"
                    [customClass]="isHsnSacEnabledAcc ? 'd-none' : ''"
                    class="gstin-address"
                    (selectTab)="tabChanged('address')"
                >
                    <ng-container>
                        <div class="gstin-form" formArrayName="addresses">
                            <ng-container
                                *ngFor="
                                    let gst of addAccountForm.get('addresses')['controls']
                                        | slice : 0 : gstDetailsLength;
                                    let i = index;
                                    let f = first;
                                    let l = last
                                "
                                [formGroupName]="i"
                            >
                                <div class="row">
                                    <div class="col-sm-12">
                                        <div class="add-address-default">
                                            <h3>{{ commonLocaleData?.app_address }} {{ i + 1 }}</h3>
                                            <div class="inputRadio">
                                                <span
                                                    [tooltip]="localeData?.address_tooltip"
                                                    class="pull-right is-default-address"
                                                    placement="left"
                                                >
                                                    <mat-slide-toggle
                                                        formControlName="isDefault"
                                                        name="defaultGst_{{ i }}"
                                                        color="primary"
                                                        (change)="
                                                            isDefaultAddressSelected(gst.get('isDefault')?.value, i)
                                                        "
                                                        aria-label="defaultGst"
                                                    >
                                                    </mat-slide-toggle>
                                                </span>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>{{ commonLocaleData?.app_street }}</label>
                                            <textarea
                                                name="gstAddr_{{ i }}"
                                                formControlName="address"
                                                rows="4"
                                                cols="5"
                                                class="form-control"
                                            ></textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-4">
                                        <div class="form-group" *ngIf="(statesSource$ | async)?.length">
                                            <label
                                                >{{ commonLocaleData?.app_state }}
                                                <sup class="text-danger" *ngIf="isStateRequired">*</sup>
                                            </label>
                                            <div>
                                                <sh-select
                                                    #states
                                                    [options]="statesSource$ | async"
                                                    [isFilterEnabled]="true"
                                                    [defaultValue]="
                                                        gst?.value.state.code
                                                            ? gst?.value.state.code + ' - ' + gst?.value.state.name
                                                            : ''
                                                    "
                                                    (selected)="selectedState(gst, $event)"
                                                    [forceClearReactive]="forceClear$ | async"
                                                    formControlName="stateCode"
                                                    class="wd100"
                                                    [useInBuiltFilterForIOptionTypeItems]="true"
                                                >
                                                </sh-select>
                                            </div>
                                        </div>
                                        <div class="form-group" *ngIf="countyList?.length">
                                            <label
                                                >{{ commonLocaleData?.app_region }}
                                                <sup class="text-danger" *ngIf="isStateRequired">*</sup>
                                            </label>
                                            <div>
                                                <sh-select
                                                    #states
                                                    [options]="countyList"
                                                    [isFilterEnabled]="true"
                                                    (selected)="selectedCounty(gst, $event)"
                                                    [forceClearReactive]="forceClear$ | async"
                                                    formControlName="countyCode"
                                                    class="w-100"
                                                    [useInBuiltFilterForIOptionTypeItems]="true"
                                                    [attr.required]="isStateRequired"
                                                    [isRequired]="isStateRequired"
                                                >
                                                </sh-select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-4" *ngIf="GSTIN_OR_TRN">
                                        <div class="form-group mr-b05">
                                            <label for="gstinNum" class="d-block">{{
                                                formFields["taxName"]?.label
                                            }}</label>
                                            <input
                                                type="text"
                                                class="form-control"
                                                autocomplete="false"
                                                #gstNumberField
                                                (blur)="
                                                    checkGstNumValidation(gstNumberField); getStateCode(gst, states)
                                                "
                                                name="gstNumber"
                                                formControlName="gstNumber"
                                                [placeholder]="taxNamePlaceholder"
                                            />
                                        </div>
                                    </div>
                                    <!-- static code added for the pincode -->
                                    <div class="col-sm-4">
                                        <div class="form-group mr-b05">
                                            <label for="pinCodeNum" class="d-block">{{
                                                zipCodeSupportedCountryList.includes(activeCompany.countryV2.alpha2CountryCode) ? commonLocaleData?.app_zip_code : commonLocaleData?.app_pin_code
                                            }}</label>
                                            <input
                                                type="number"
                                                class="form-control"
                                                autocomplete="false"
                                                name="pinCodeNum"
                                                formControlName="pincode"
                                                [placeholder]="zipCodeSupportedCountryList.includes(activeCompany.countryV2.alpha2CountryCode) ? commonLocaleData?.app_enter_zip_code : commonLocaleData?.app_enter_pin_code"
                                                decimalDigitsDirective
                                                [preventDecimal]="true"
                                            />
                                        </div>
                                    </div>
                                    <!-- end -->
                                    <ng-container *ngIf="companyCountry === 'IN' || companyCountry === 'ZW' || companyCountry === 'KE'">
                                        <div class="col-sm-4">
                                            <div class="form-group">
                                                <label
                                                    >{{ localeData?.party_type }}<span class="red-text">*</span></label
                                                >
                                                <div class="position-relative">
                                                    <sh-select
                                                        [options]="partyTypeSource"
                                                        formControlName="partyType"
                                                        [isFilterEnabled]="true"
                                                    ></sh-select>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- <div
                                            class="col-sm-4"
                                            *ngIf="gst.get('gstNumber').value && (isGstValid$ | async)"
                                        >
                                            <div class="form-group">
                                                <label class="d-block">&nbsp;</label>
                                                <label>
                                                    <input
                                                        type="checkbox"
                                                        name="isComposite"
                                                        formControlName="isComposite"
                                                    /><label
                                                        >&nbsp;
                                                        {{ localeData?.is_composite }}
                                                    </label></label
                                                >
                                            </div>
                                        </div> -->
                                    </ng-container>
                                    <div class="col-sm-12">
                                        <div class="form-group">
                                            <span class="text-right">
                                                <a
                                                    href="javascript:void(0);"
                                                    *ngIf="!f"
                                                    (click)="removeGstDetailsForm(i)"
                                                    class="grey-color btn btn-danger"
                                                >
                                                    <i class="icon-cross"> </i> {{ commonLocaleData?.app_remove }}
                                                </a>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div
                                    class="row"
                                    *ngIf="
                                        l &&
                                        addAccountForm.get('addresses')['controls']?.length > 3 &&
                                        !moreGstDetailsVisible
                                    "
                                >
                                    <a
                                        href="javascript:void(0);"
                                        class="text-left col-6 cursor-pointer"
                                        (click)="showMoreGst()"
                                        >{{ commonLocaleData?.app_show_all }} ({{
                                            addAccountForm.get("addresses")["controls"]?.length
                                        }})</a
                                    >
                                    <a
                                        href="javascript:void(0);"
                                        class="text-left col-6 cursor-pointer"
                                        (click)="showLessGst()"
                                        >{{ commonLocaleData?.app_show_less }}</a
                                    >
                                </div>
                                <div *ngIf="l">
                                    <a
                                        class="text-right btn btn-primary add-address-btn add-new-btn"
                                        href="javascript:void(0);"
                                        (click)="addGstDetailsForm(gst.get('gstNumber')?.value)"
                                    >
                                        <i class="icon-plus"></i> {{ localeData?.add_address }}
                                    </a>
                                </div>
                            </ng-container>
                        </div>
                    </ng-container>
                </tab>
            </ng-container>

            <tab
                [heading]="localeData?.tabs?.contact"
                class="contact-form-wrap"
                [active]="isHsnSacEnabledAcc"
                (selectTab)="tabChanged('contacts')"
            >
                <div class="contact-form">
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label>{{ localeData?.attention_to }}</label>
                                <input
                                    type="text"
                                    class="form-control"
                                    formControlName="attentionTo"
                                    name="attention"
                                />
                            </div>
                        </div>
                        <div class="col-sm-6 mobile-number-wrapper">
                            <div class="form-group">
                                <label>{{ commonLocaleData?.app_mobile_number }}</label>
                                <div class="d-flex">
                                    <input
                                        name="accountDetails.mobileNumber"
                                        type="tel"
                                        #initContactUpdate
                                        class="flag-input"
                                        id="init-contact-update"
                                        formControlName="mobileNo"
                                        [placeholder]="localeData?.mobile_no_placeholder"
                                    />
                                </div>
                                <span id="init-contact-update-valid-msg" class="d-none"></span>
                                <span id="init-contact-update-error-msg" class="d-none"></span>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label>{{ commonLocaleData?.app_email_id }}</label>
                                <input type="email" class="form-control" formControlName="email" name="emailId" />
                                <span
                                    class="error-msg"
                                    *ngIf="addAccountForm.get('email').dirty && addAccountForm.get('email').errors"
                                    >{{ localeData?.email_id_error }}</span
                                >
                            </div>
                        </div>
                    </div>
                </div>
            </tab>
            <tab
                [heading]="localeData?.tabs?.portal"
                class="contact-form-wrap"
                *ngIf="voucherApiVersion === 2 && isDebtorCreditor"
                (selectTab)="tabChanged('portal')"
            >
                <div formArrayName="portalDomain">
                    <div
                        class="row align-items-center"
                        *ngFor="let domain of addAccountForm?.get('portalDomain')['controls']; let i = index"
                        [formGroupName]="i"
                    >
                        <div class="col-xl-3 col-lg-5 col-md-5 col-sm-6 unit-equal">
                            <div class="form-group portal-height">
                                <label>{{ localeData?.portal_attention_to }} </label>
                                <input
                                    type="text"
                                    class="form-control"
                                    (input)="portalIndex = i"
                                    formControlName="name"
                                    name="name_{{ i }}"
                                />
                            </div>
                        </div>
                        <div class="col-xl-4 col-lg-3 col-md-3 col-sm-2 pr-0">
                            <div class="form-group portal-height">
                                <label>{{ commonLocaleData?.app_email_id }} <span class="red-text">*</span></label>
                                <input
                                    type="email"
                                    class="form-control"
                                    (input)="portalIndex = i"
                                    formControlName="email"
                                    name="email_{{ i }}"
                                />
                                <span
                                    class="error-msg"
                                    *ngIf="
                                        domain.get('email').dirty &&
                                        (domain.get('email').hasError('required') || domain.get('email').invalid) &&
                                        !domain.get('email').hasError('duplicate')
                                    "
                                    id="emailError_{{ i }}"
                                    >{{ localeData?.email_id_error }}
                                </span>
                                <span
                                    class="error-msg"
                                    *ngIf="domain.get('email').hasError('duplicate') && i === lastDuplicateEmailIndex"
                                    id="emailValidationError_{{ i }}"
                                    >{{ localeData?.duplicate_email }}
                                </span>
                            </div>
                        </div>
                        <div class="col-xl-4 col-lg-3 col-md-3 col-sm-3 pr-0 mobile-number-portal-wrapper">
                            <div class="form-group portal-height">
                                <label>{{ commonLocaleData?.app_mobile_number }} </label>
                                <div class="d-flex">
                                    <input
                                        name="contactNo_{{ i }}"
                                        type="tel"
                                        #initContactAdd2
                                        class="flag-input"
                                        id="init-contact-portal_{{ i }}"
                                        formControlName="contactNo"
                                        [placeholder]="localeData?.mobile_no_placeholder"
                                        (input)="portalIndex = i"
                                    />
                                </div>
                                <span id="init-contact-portal_{{ i }}-valid-msg" class="d-none"> </span>
                                <span id="init-contact-portal_{{ i }}-error-msg" class="d-none"> </span>
                            </div>
                        </div>
                        <div class="col-xl-1 col-lg-1 col-md-2 col-sm-12 pl-0 remove-user">
                            <div class="inc-dec">
                                <div class="plus-minus w-100">
                                    <button class="btn mr-0" (click)="removePortalUser(domain, i)" aria-label="delete icon">
                                        <i class="icon-trash delete"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <a class="mr-0 add-new" href="javascript:void(0);" (click)="addNewPortalUser()">
                                <i class="icon-plus"></i> {{ localeData?.portal_add_user }}
                            </a>
                        </div>
                    </div>
                </div>
            </tab>
            <!-- bank details visible when sundry credtiors selected , right now is hide -->
            <tab
                [heading]="localeData?.tabs?.bank_details"
                class="bank-details-form"
                *ngIf="showBankDetail"
                (selectTab)="tabChanged('bank')"
            >
                <div *ngIf="showBankDetail">
                    <div formArrayName="accountBankDetails">
                        <div
                            class="row"
                            *ngFor="
                                let bank of addAccountForm.get('accountBankDetails')['controls'];
                                let i = index;
                                let f = first;
                                let l = last
                            "
                            [formGroupName]="i"
                        >
                            <div
                                class="form-group col-sm-6"
                                [ngClass]="{
                                    'col-sm-5': selectedCountryCode !== 'AE',
                                    'col-sm-6': selectedCountryCode === 'AE'
                                }"
                                *ngIf="selectedCountryCode === 'AE'"
                            >
                                <label for="">{{ localeData?.beneficiary_name_label }}</label>
                                <input
                                    type="text"
                                    class="form-control"
                                    [placeholder]="localeData?.beneficiary_name_placeholder"
                                    name="beneficiaryName_{{ i }}"
                                    formControlName="beneficiaryName"
                                />
                            </div>
                            <div
                                class="form-group col-sm-6"
                                [ngClass]="{
                                    'col-sm-5': selectedCountryCode !== 'AE',
                                    'col-sm-6': selectedCountryCode === 'AE'
                                }"
                            >
                                <label>{{ localeData?.bank_name_label }}</label>
                                <input
                                    type="text"
                                    class="form-control"
                                    [placeholder]="localeData?.bank_name_placeholder"
                                    name="bankName_{{ i }}"
                                    formControlName="bankName"
                                />
                            </div>
                            <div class="form-group col-sm-4" *ngIf="selectedCountryCode === 'AE'">
                                <div>
                                    <label>{{ localeData?.branch_name_label }}</label>
                                    <input
                                        type="text"
                                        class="form-control"
                                        [placeholder]="localeData?.branch_name_placeholder"
                                        name="branchName_{{ i }}"
                                        formControlName="branchName"
                                    />
                                </div>
                            </div>
                            <div class="form-group col-sm-4">
                                <div>
                                    <label *ngIf="selectedCountryCode === 'IN'">{{
                                        commonLocaleData?.app_account_number
                                    }}</label>
                                    <label *ngIf="selectedCountryCode !== 'IN'">{{ commonLocaleData?.app_iban }}</label>
                                    <input
                                        type="text"
                                        class="form-control"
                                        #bankaccount
                                        [placeholder]="commonLocaleData?.app_account_number_placeholder"
                                        [maxlength]="bankIbanNumberMaxLength"
                                        [minlength]="bankIbanNumberMinLength"
                                        name="accountNum_{{ i }}"
                                        (blur)="showBankDetailsValidation(bankaccount, 'bankAccountNo')"
                                        (keyup)="bankDetailsValidator(bankaccount, 'bankAccountNo')"
                                        formControlName="bankAccountNo"
                                    />
                                </div>
                            </div>
                            <div class="form-group col-sm-4" *ngIf="selectedCountryCode === 'AE'">
                                <label>{{ commonLocaleData?.app_swift_code_label }}</label>
                                <input
                                    type="text"
                                    class="form-control"
                                    [placeholder]="commonLocaleData?.app_swift_code_placeholder"
                                    maxlength="11"
                                    minlength="8"
                                    #swiftcode
                                    name="swiftCode_{{ i }}"
                                    (blur)="showBankDetailsValidation(swiftcode, 'swiftCode')"
                                    (keyup)="bankDetailsValidator(swiftcode, 'swiftCode')"
                                    formControlName="swiftCode"
                                />
                            </div>
                            <div *ngIf="selectedCountryCode !== 'AE'" class="form-group col-sm-3">
                                <label>{{ commonLocaleData?.app_ifsc_code_label }}</label>
                                <input
                                    type="text"
                                    class="form-control"
                                    [placeholder]="commonLocaleData?.app_ifsc_code_placeholder"
                                    name="ifsc_{{ i }}"
                                    formControlName="ifsc"
                                />
                            </div>
                        </div>
                    </div>
                </div>
            </tab>

            <tab [heading]="localeData?.tabs?.others" class="other-form-wrap" (selectTab)="tabChanged('others')">
                <div class="other-form">
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label>{{ localeData?.account_uniquename }}</label>
                                <input
                                    type="text"
                                    class="form-control"
                                    textCaseChangeDirective
                                    UniqueNameDirective
                                    formControlName="uniqueName"
                                    name="accUnqname"
                                />
                            </div>
                        </div>

                        <div class="form-group col-sm-6">
                            <label>{{ localeData?.balance_for_trigger }}</label>
                            <div
                                class="input-group"
                                [ngClass]="{
                                    'input-group': addAccountForm.get('closingBalanceTriggerAmount')?.value > 0
                                }"
                            >
                                <input
                                    type="number"
                                    min="0"
                                    class="form-control text-right"
                                    formControlName="closingBalanceTriggerAmount"
                                    [placeholder]="
                                        commonLocaleData?.app_numbers?.zero +
                                        '' +
                                        commonLocaleData?.app_numbers?.zero +
                                        '.' +
                                        commonLocaleData?.app_numbers?.zero +
                                        '' +
                                        commonLocaleData?.app_numbers?.zero
                                    "
                                />
                                <div
                                    class="input-group-addon"
                                    (click)="closingBalanceTypeChanged('DEBIT')"
                                    [ngClass]="{
                                        'active-toggle-btn':
                                            addAccountForm.get('closingBalanceTriggerAmountType')?.value === 'DEBIT',
                                        'cp': addAccountForm.get('closingBalanceTriggerAmount')?.value > 0
                                    }"
                                    *ngIf="addAccountForm.get('closingBalanceTriggerAmount')?.value > 0"
                                >
                                    {{ commonLocaleData?.app_dr?.toUpperCase() }}
                                </div>
                                <div
                                    class="input-group-addon"
                                    (click)="closingBalanceTypeChanged('CREDIT')"
                                    [ngClass]="{
                                        'active-toggle-btn':
                                            addAccountForm.get('closingBalanceTriggerAmountType')?.value === 'CREDIT',
                                        'cp': addAccountForm.get('closingBalanceTriggerAmount')?.value > 0
                                    }"
                                    *ngIf="addAccountForm.get('closingBalanceTriggerAmount')?.value > 0"
                                >
                                    {{ commonLocaleData?.app_cr?.toUpperCase() }}
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-12">
                            <div class="form-group">
                                <label>{{ localeData?.description_label }}</label>
                                <textarea
                                    rows="3 "
                                    cols="4"
                                    name="description"
                                    formControlName="description"
                                    class="form-control"
                                ></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </tab>
            <tab [heading]="localeData?.tabs?.custom" (selectTab)="tabChanged('custom')">
                <giddh-page-loader [cssClass]="'mt-0 mb-0'" *ngIf="isCustomFieldLoading"></giddh-page-loader>
                <ng-container formArrayName="customFields">
                    <ng-container
                        *ngFor="
                            let item of companyCustomFields;
                            let companyCustomFieldIndex = index;
                            let first = first;
                            let last = last
                        "
                        [formGroupName]="companyCustomFieldIndex"
                    >
                        <ng-container
                            *ngFor="
                                let customFieldsItem of addAccountForm.get('customFields')['controls'];
                                let index = index
                            "
                        >
                            <div
                                class="row mr-b15"
                                *ngIf="item?.uniqueName === customFieldsItem.get('uniqueName')?.value"
                            >
                                <div class="col-lg-8">
                                    <div class="name-of-field">
                                        <label
                                            >{{ item.fieldName }}
                                            <span class="red-text" *ngIf="item.isMandatory">*</span>
                                        </label>
                                        <input
                                            *ngIf="
                                                item.fieldType?.type === availableFieldTypes.String ||
                                                item.fieldType?.type === availableFieldTypes.Barcode
                                            "
                                            type="text"
                                            name="values{{ index }}"
                                            formControlName="value"
                                            class="form-control custom-field"
                                            [maxLength]="item.dataRange?.max"
                                            [attr.pattern]="item.regex"
                                            [required]="item.isMandatory"
                                            [placeholder]="item.fieldInfo ? item.fieldInfo : ''"
                                        />
                                        <input
                                            *ngIf="item.fieldType?.type === availableFieldTypes.Number"
                                            type="number"
                                            name="values{{ index }}"
                                            formControlName="value"
                                            class="form-control custom-field"
                                            [min]="item.dataRange?.min"
                                            [max]="item.dataRange?.max"
                                            decimalDigitsDirective
                                            [attr.pattern]="item.regex"
                                            [required]="item.isMandatory"
                                            [placeholder]="item.fieldInfo ? item.fieldInfo : ''"
                                        />
                                        <div
                                            *ngIf="item.fieldType?.type === availableFieldTypes.Boolean"
                                            class="clearfix"
                                        >
                                            <span class="d-inline-block">
                                                <input
                                                    id="yes{{ index }}"
                                                    class="radio-custom cp ml-0"
                                                    type="radio"
                                                    [checked]="customFieldsItem.get('value')?.value === 'true'"
                                                    (change)="selectedBooleanCustomField('true', index)"
                                                    name="booleanType{{ index }}"
                                                />
                                                <label for="yes{{ index }}" class="radio-custom-label">{{
                                                    commonLocaleData?.app_true?.toUpperCase()
                                                }}</label>
                                            </span>

                                            <span class="d-inline-block">
                                                <input
                                                    id="no{{ index }}"
                                                    class="radio-custom cp ml-0"
                                                    type="radio"
                                                    [checked]="customFieldsItem.get('value')?.value === 'false'"
                                                    (change)="selectedBooleanCustomField('false', index)"
                                                    name="booleanType{{ index }}"
                                                />
                                                <label for="no{{ index }}" class="radio-custom-label">{{
                                                    commonLocaleData?.app_false?.toUpperCase()
                                                }}</label>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </ng-container>
                    </ng-container>
                </ng-container>
                <a
                    href="javascript:;"
                    class="btn-link"
                    [routerLink]="'/pages/custom-fields/list'"
                    *ngIf="!companyCustomFields?.length"
                    (click)="closeMaster()"
                    >{{ commonLocaleData?.app_create_custom_field }}</a
                >
            </tab>
        </tabset>
        <div class="row" *ngIf="!isOtherSelectedTab">
            <div class="col-sm-12 mr-t3">
                <div class="button-group">
                    <button
                        type="button"
                        *ngIf="showDeleteButton"
                        class="btn btn-danger"
                        (click)="deleteClicked.emit(true)"
                        aria-label="delete"
                    >
                        {{ commonLocaleData?.app_delete }}
                    </button>
                    <button
                        (click)="submit()"
                        class="btn btn-primary update-btn-zindex"
                        [ladda]="updateAccountInProcess$ | async"
                        [disabled]="addAccountForm.invalid || !(isGstValid$ | async) || isMobileNumberInvalid"
                        aria-label="update"
                    >
                        {{ commonLocaleData?.app_update }}
                    </button>
                </div>
            </div>
        </div>
    </form>
    <div class="form" *ngIf="isOtherSelectedTab">
        <div>
            <div *ngIf="activeAccount$ | async" class="form-group">
                <form
                    name="moveAccountForm"
                    class="clearfix move-to-group"
                    novalidate
                    (submit)="moveAccount()"
                    [formGroup]="moveAccountForm"
                >
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="form-group">
                                <label>{{ localeData?.move_to_group }}</label>
                                <div>
                                    <span>
                                        <sh-select
                                            formControlName="moveto"
                                            [placeholder]="localeData?.group_name_label"
                                            [options]="flatGroupsOptions"
                                            [customFilter]="customMoveGroupFilter"
                                            class="pull-left width-select"
                                            [enableDynamicSearch]="true"
                                            [isPaginationEnabled]="true"
                                            (scrollEnd)="handleGroupScrollEnd()"
                                            (dynamicSearchedQuery)="onGroupSearchQueryChanged($event)"
                                        >
                                            <!--template for move group typeahead-->
                                            <ng-template #optionTemplate let-model="option">
                                                <a href="javascript:void(0)" class="list-item">
                                                    <div class="item">{{ model?.label }}</div>
                                                    <div class="item-unique">
                                                        {{ model?.value }}
                                                    </div>
                                                </a>
                                            </ng-template>
                                        </sh-select>
                                    </span>
                                    <span class="pull-right">
                                        <button
                                            type="submit"
                                            class="btn btn-primary merge-btn mr-0"
                                            [disabled]="moveAccountForm.invalid"
                                            aria-label="move"
                                        >
                                            {{ localeData?.move }}
                                        </button>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="row">
                <div class="col-sm-12">
                    <div class="form-group">
                        <label
                            >{{ localeData?.select_account_merge }}
                            <span class="primary-color">{{ (activeAccount$ | async)?.name }}</span></label
                        >
                        <div class="clearfix" #accountSelect2>
                            <span>
                                <sh-select
                                    class="pull-left width-select"
                                    [options]="accounts"
                                    [isFilterEnabled]="true"
                                    (viewInitEvent)="loadAccountData()"
                                    [enableDynamicSearch]="true"
                                    [isPaginationEnabled]="true"
                                    (scrollEnd)="handleScrollEnd()"
                                    (dynamicSearchedQuery)="onAccountSearchQueryChanged($event)"
                                    [(ngModel)]="selectedaccountForMerge"
                                    [placeholder]="commonLocaleData?.app_select_accounts"
                                ></sh-select>
                            </span>
                            <span class="pull-right">
                                <button type="submit" class="btn btn-primary merge-btn mr-0" (click)="mergeAccounts()" aria-label="merge">
                                    {{ localeData?.merge }}
                                </button>
                            </span>
                        </div>
                        <small class="clearfix">{{ localeData?.merge_account_note }}</small>

                        <ul
                            class="accmerge mr-t1"
                            *ngIf="
                                (activeAccount$ | async)?.mergedAccounts.split(',')?.length > 0 &&
                                (activeAccount$ | async)?.mergedAccounts.split(',')[0] !== ''
                            "
                        >
                            <li *ngFor="let merged of (activeAccount$ | async)?.mergedAccounts.split(',')">
                                <a
                                    href="javascript:void(0);"
                                    [ngClass]="{ 'isActive': setAccountForMove === merged }"
                                    (click)="setAccountForMoveFunc(merged)"
                                >
                                    {{ merged }}
                                    <span (click)="showDeleteMergedAccountModal(merged)"></span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="form" *ngIf="isDebtorCreditor && isOtherSelectedTab">
            <div class="mr-b2 select-box">
                <div class="form-group">
                    <label>{{ localeData?.default_discounts }} <span class="primary-color"></span></label>
                    <div class="clearfix">
                        <span>
                            <sh-select
                                class="pull-left calc-width"
                                [options]="discountList"
                                [isFilterEnabled]="true"
                                [forceClearReactive]="forceClearDiscount$ | async"
                                [multiple]="true"
                                [(ngModel)]="selectedDiscounts"
                                (selected)="discountSelected()"
                                [placeholder]="localeData?.select_discounts"
                            ></sh-select>
                        </span>
                        <span class="pull-right">
                            <button
                                class="btn btn-primary merge-btn mr-0"
                                [disabled]="isDiscountSaveDisable$ | async"
                                (click)="applyDiscounts()"
                                aria-label="apply"
                            >
                                {{ commonLocaleData?.app_apply }}
                            </button>
                        </span>
                    </div>
                </div>
            </div>
            <div class="edit-tax-section">
                <div class="form-group">
                    <div class="tax-label">
                        <label>{{ localeData?.all_inherited_discounts }}</label>
                    </div>
                    <div *ngFor="let item of (activeAccount$ | async)?.inheritedDiscounts">
                        <ng-template #popTemplate>
                            <div class="popover-content">
                                <label>{{ localeData?.discounts_inherited_from }}:</label>
                                <ul>
                                    <li>{{ item?.name }}</li>
                                </ul>
                            </div>
                        </ng-template>
                        <span
                            class="tax-bullet"
                            *ngFor="let inAppDiscount of item.applicableDiscounts"
                            [popover]="popTemplate"
                            placement="right"
                            triggers="mouseenter:mouseleave"
                            >{{ inAppDiscount.name }}
                        </span>
                    </div>
                    <p *ngIf="!(activeAccount$ | async)?.inheritedDiscounts?.length">
                        {{ localeData?.no_inherited_discounts }}
                    </p>
                </div>
            </div>
        </div>

        <!-- taxes container -->
        <ng-container *ngIf="isTaxableAccount$ | async">
            <div class="row" *ngIf="selectedTab === 'others'">
                <div class="col-sm-12">
                    <form name="taxGroupForm" novalidate [formGroup]="taxGroupForm" (submit)="applyTax()">
                        <div class="tax-label">
                            <label>{{ commonLocaleData?.app_default_taxes }}</label>
                        </div>
                        <div class="form-group">
                            <div class="clearfix">
                                <span class="calc-width pull-left">
                                    <sh-select
                                        [options]="companyTaxDropDown$ | async"
                                        [placeholder]="localeData?.all_applicable_taxes_placeholder"
                                        (selected)="taxesSelected($event)"
                                        [multiple]="true"
                                        formControlName="taxes"
                                    >
                                    </sh-select>
                                </span>
                                <span class="pull-right">
                                    <button
                                        [disabled]="isTaxesSaveDisable$ | async"
                                        type="submit"
                                        class="btn btn-success save-btn mr-0"
                                        aria-label="save"
                                    >
                                        {{ commonLocaleData?.app_save }}
                                    </button>
                                </span>
                            </div>
                        </div>
                    </form>

                    <div class="edit-tax-section">
                        <div class="form-group">
                            <div class="tax-label">
                                <label>{{ localeData?.all_inherited_taxes }}</label>
                            </div>
                            <div *ngFor="let inTax of (activeAccountTaxHierarchy$ | async)?.inheritedTaxes">
                                <ng-template #popTemplate>
                                    <div>
                                        <div class="popover-content">
                                            <label>{{ localeData?.tax_inherited }}:</label>
                                            <ul>
                                                <li>{{ inTax?.name }}</li>
                                            </ul>
                                        </div>
                                    </div>
                                </ng-template>
                                <span
                                    class="tax-bullet"
                                    *ngFor="let inAppTax of inTax.applicableTaxes"
                                    [popover]="popTemplate"
                                    placement="right"
                                    triggers="mouseenter:mouseleave"
                                    >{{ inAppTax?.name }}
                                </span>
                            </div>
                            <p *ngIf="!(activeAccountTaxHierarchy$ | async)?.inheritedTaxes?.length">
                                {{ localeData?.no_inherited_taxes }}
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </ng-container>
        <div class="row" *ngIf="isOtherSelectedTab">
            <div class="col-sm-12 mr-t3">
                <div class="button-group">
                    <button
                        type="button"
                        *ngIf="showDeleteButton"
                        class="btn btn-danger"
                        (click)="deleteClicked.emit(true)"
                        aria-label="delete"
                    >
                        {{ commonLocaleData?.app_delete }}
                    </button>
                    <button
                        (click)="submit()"
                        class="btn btn-primary update-btn-zindex"
                        [ladda]="updateAccountInProcess$ | async"
                        [disabled]="addAccountForm.invalid || !(isGstValid$ | async)"
                        aria-label="update"
                    >
                        {{ commonLocaleData?.app_update }}
                    </button>
                </div>
            </div>
        </div>
        <!--deleteMergedAccount account modal  -->
        <div bsModal #deleteMergedAccountModal="bs-modal" class="modal fade" role="dialog">
            <div class="modal-dialog modal-xl">
                <div class="modal-content">
                    <confirm-modal
                        [title]="localeData?.delete_merged_account_title"
                        [body]="deleteMergedAccountModalBody"
                        (cancelCallBack)="hideDeleteMergedAccountModal()"
                        (successCallBack)="deleteMergedAccount()"
                    >
                    </confirm-modal>
                </div>
            </div>
        </div>
        <!--moveMergedAccount account modal  -->
        <div bsModal #moveMergedAccountModal="bs-modal" class="modal fade" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <confirm-modal
                        [title]="localeData?.move_merged_account_title"
                        [body]="moveMergedAccountModalBody"
                        (cancelCallBack)="hideMoveMergedAccountModal()"
                        (successCallBack)="moveMergeAccountTo()"
                    >
                    </confirm-modal>
                </div>
            </div>
        </div>
    </div>
</ng-container>
