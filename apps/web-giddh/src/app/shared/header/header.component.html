<div class="nav-left-bar" [ngClass]="{'open': sideMenu.isopen, 'unvisible': companyList.length===0 }" (clickOutside)="closeSidebarMobile($event)">
    <div class="menu-wrapper">
        <primary-sidebar [isOpen]="sideMenu?.isopen" [apiMenuItems]="apiMenuItems" (newCompany)="createNewCompany()"></primary-sidebar>
    </div>
    <div class="mobile-menu-icon" (click)="sideBarStateChange(sideMenu.isopen = !sideMenu.isopen)">
        <span class="icon-bar" [tooltip]="sideMenu.isopen ? 'Collapse' : 'Expand'" placement="right"></span>
    </div>
</div>

<header class="clearfix header-container desktop-header" *ngIf="false" [ngClass]="{'unvisible': companyList.length===0 , 'menu_open':sideMenu.isopen }">
    <nav class="navbar ">
        <div class="container-fluid pd-t1 pd-b1">
            <div class="navbar-header">
                <ul class="nav navbar-nav">
                </ul>

                <div class="giddh_logo">

                </div>

                <div class="pull-right">
                    <button *ngIf="shouldShowBackButton" (click)="navigateToPreviousRoute()" class="btn btn-primary mr-r15">Back</button>
                </div>
            </div>
        </div>
    </nav>
</header>

<!-- New header starts -->
<div class="fixed-padding" >
    <div class="primary-main-header" id="primary-new-header" [ngClass]="{'open': sideMenu.isopen, 'unvisible': companyList.length===0 }">
        <div *ngIf="isMobileScreen">
            <ul class="list-style-none">
                <li class="hamburger-menu cursor-pointer pull-left">
                    <button class="btn mr-0" placement="right" (click)="redirectToMobileHome()">
                        <i class="icon-home-new"></i>
                    </button>
                    <span class="setting-menu-icon" (click)="toggleSidebarPane(true, true)"> <i class="icon-bar"></i> </span>
                    <span class="mobile-back-btn" (click)="redirectToMobileHome()"><i class="icon-back-arrow"></i></span>
                </li>
            </ul>
        </div>

        <div class="d-flex justify-content-between align-items-center">
            <div class="logo-wrapper">
                <img src="assets/images/giddh-white-logo.svg" alt="giddh-logo">
            </div>
            <ul class="nav universal-date mr-r1" *ngIf="(selectedCompany | async)">
                <li class="border-none pd-r15 notification" [ngClass]="{'mr-0':isTodaysDateSelected}">
                    <i class="icon-bell-new"></i>
                </li>
                <li class="border-none pl-0 select-today">
                    <button class="btn btn-link" *ngIf="!isTodaysDateSelected" (click)="dateSelectedCallback()">Today</button>
                </li>
                <li class="not-today cursor-pointer" [ngClass]="{'if-today': isTodaysDateSelected}">
                    <span class="icon-calender-new calendar-addon" (click)="showGiddhDatepicker($event)"></span>
                    <div class="input-date" [ngClass]="{'today-date pl-2': isTodaysDateSelected}">
                        <input type="text" name="selectedDateRange" (click)="showGiddhDatepicker($event)"
                            [value]="(selectedDateRangeUi) ? selectedDateRangeUi : ''"
                            class="giddh-datepicker form-control date-range-picker" />
                    </div>
                </li>
                <li *ngIf="!isMobileScreen">
                    <a href="javascript:void(0);" id="add-manage"
                        (click)="showManageGroupsModal()"><i class="icon-master-new1"></i> Master</a>
                </li>
                <li *ngIf="!isMobileScreen" class="header-utility-icons" (click)="toggleSidebarPane(true, false)">
                    <a href="javascript:void(0);" ><i class="icon-settings-cog"></i></a>
                </li>
                <li class="header-utility-icons">
                    <a href="javascript:void(0);" (click)="toggleHelpSupportPane(true)"><i class="icon-question-new"></i></a>
                </li>
            </ul>
        </div>
    </div>
</div>
<!-- New header ends -->


<div class="plan-wrapper" *ngIf="subscribedPlan !== undefined && subscribedPlan.status !== 'expired' && remainingSubscriptionDays !== false && remainingSubscriptionDays <= 7" [ngClass]="{'menu_open':sideMenu.isopen}">
    <div class="white-row plan-issue">
        <p><span class="icon-traingle-info"></span> Your {{subscribedPlan.planDetails.duration}} {{subscribedPlan.planDetails.durationUnit}} {{subscribedPlan.planDetails.name}} will end on {{subscribedPlan.expiry}}. Apply to upgrade your subscription. <a class="click-here"
                (click)="goToSelectPlan()">Click here</a></p>
    </div>
</div>
<div class="plan-wrapper" *ngIf="subscribedPlan !== undefined && subscribedPlan.status === 'expired'" [ngClass]="{'menu_open':sideMenu.isopen}">
    <div class="white-row plan-issue">
        <p><span class="icon-traingle-info"></span> Your {{subscribedPlan.planDetails.duration}} {{subscribedPlan.planDetails.durationUnit}} {{subscribedPlan.planDetails.name}} ended on {{subscribedPlan.expiry}}. Apply to upgrade your subscription. <a class="click-here"
                (click)="goToSelectPlan()">Click here</a></p>
    </div>
</div>
<div class="plan-wrapper" *ngIf="subscribedPlan !== undefined && subscribedPlan.additionalCharges" [ngClass]="{'menu_open':sideMenu.isopen}">
    <div class="white-row plan-issue">
        <p> <span class="icon-traingle-info"></span> You have crossed the transactions limit of your assigned plan {{subscribedPlan.planDetails.name}} subscribed on {{subscribedPlan.startedAt}}. To continue your accounting with Giddh, Please renew your current
            plan or switch to another one. Contact us for more assistance. <a class="click-here" (click)="goToSelectPlan()">Click here</a>
        </p>
    </div>
</div>
<!--add and manage group account modal -->
<div bsModal #manageGroupsAccountsModal="bs-modal" [config]="{ keyboard: true }" class="modal fade full-screen-modal manage-account-popup add-manage-group-acc" role="dialog" (onShown)="onShown()">
    <div class="modal-dialog modal-xl modal-liq-90 mr-0 width-100 h-100">
        <div class="modal-content full-screen-modal">
            <ng-template element-view-container-ref #addmanage=elementviewcontainerref>
            </ng-template>
        </div>
    </div>
</div>
<!--add company modal  -->
<div bsModal #addCompanyModal="bs-modal" [config]="{backdrop: 'static', keyboard: false}" class="modal fade" role="dialog" (onHidden)="onHide()">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <ng-template element-view-container-ref #companyadd=elementviewcontainerref>
            </ng-template>
        </div>
    </div>
</div>
<!--add company new modal  -->
<div bsModal #addCompanyNewModal="bs-modal" [config]="{backdrop: 'static', keyboard: false}" class="modal fade" role="dialog" (onHidden)="onHide()">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <ng-template element-view-container-ref #companynewadd=elementviewcontainerref>
            </ng-template>
        </div>
    </div>
</div>
<!--CMD + G modal  -->
<ng-template #navigationModal>

    <div class="modal-body" #mdl>
        <command-k (newTeamCreationEmitter)="handleNewTeamCreationEmitter($event)" (groupEmitter)="makeGroupEntryInDB($event)" (selectedItemEmitter)="onItemSelected($event)" [parentEle]="mdl" [isOpen]="true"
            [setParentWidth]="true" (closeEmitter)="modelRef.hide()"></command-k>

        <div class="shortcuts">
            <strong>↑</strong> <strong>↓</strong>&nbsp; to navigate <strong class="mr-l1" aria-label="Return">↵</strong>&nbsp; to select <strong class="mr-l1" aria-label="Escape">esc</strong>&nbsp; to dismiss
        </div>

    </div>

</ng-template>
<ng-template #expiredPlanModel>
    <div class="modal-header">
        <h3 class="modal-title pull-left">Ready to upgrade subscription</h3>
        <button type="button" class="close pull-right" aria-label="Close" (click)="modelRefExpirePlan.hide()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body pd-2 font-14">
        <div class="clearfix mb-3">
            <p>Your {{subscribedPlan.planDetails.duration}} {{subscribedPlan.planDetails.durationUnit | lowercase }}s
                <strong>FREE</strong> {{subscribedPlan.planDetails.name}} ended on {{subscribedPlan.expiry}}. We hope you enjoyed using Giddh Accounting Software as much as we loved building it for you. To continue your subscription buy any plan or contact
                us for more assistance.</p>
        </div>
        <div class="clearfix">
            <ul class="list-inline upgrade-plan">
                <li>
                    <button class="btn btn-green" *ngIf="currentCompanyPlanAmount" (click)="goToSelectPlan();">Renew
                        Plan</button>
                </li>
                <li>
                    <button class="btn btn-green" (click)="goToSelectPlan();">Change Plan</button>
                </li>
                <li><span class="d-inline-block pr-1">Or</span> <a class="cursor-pointer" (click)="openScheduleCalendlyModel();modelRefExpirePlan.hide();">
                        Contact
                        Us</a></li>
            </ul>
        </div>
    </div>
</ng-template>
<!-- modal second -->
<ng-template #crossedTxLimitModel>
    <div class="modal-header">
        <h3 class="modal-title pull-left">Ready to upgrade subscription</h3>
        <button type="button" class="close pull-right" aria-label="Close" (click)="modelRefCrossLimit.hide()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body pd-2 font-14">
        <div class="clearfix mb-3">
            <p class="mb-2">You have crossed the transactions limit of your assigned plan
                <strong>{{subscribedPlan.planDetails.name}}</strong> subscribed on {{subscribedPlan.startedAt}}.</p>
            <p>To continue your accounting with Giddh, Please renew your current plan or switch to another one. Contact us for more assistance.</p>
        </div>
        <div class="clearfix">
            <ul class="list-inline">
                <li>
                    <button class="btn btn-sky-blue" (click)="goToSelectPlan();">Buy Plan</button>
                </li>
                <li><span class="d-inline-block pr-1">Or</span> <a class="cursor-pointer" (click)="openScheduleCalendlyModel();modelRefCrossLimit.hide();">
                        Contact
                        Us</a></li>
            </ul>
        </div>
    </div>
</ng-template>
<div class="overlay-cal" *ngIf="isCalendlyModelActivate">
    <div id="scheduleCall" class="tab-pane active vertical-center modal-body">
        <div class="calendly-box" #reder>
            <div class="calendly-inline-widget">
                <button id="close" class="close-2" (click)="hideScheduleCalendlyModel()"><i
                        class="icon-cross"></i></button>
                <object data="https://calendly.com/sales-accounting-software/talk-to-sale"></object>
            </div>
        </div>
    </div>
</div>

<!--help & support sidebar  -->
<div class="help-support-aside" *ngIf="asideHelpSupportMenuState === 'in'" (clickOutside)="closeHelpPaneOnOutsideClick()">
    <aside-help-support (closeAsideEvent)="toggleHelpSupportPane(false)"></aside-help-support>
</div>
<!-- setting aside pane -->
<div class="help-support-aside" *ngIf="asideSettingMenuState === 'in'" (clickOutside)="closeSettingPaneOnOutsideClick()">
    <perfect-scrollbar [scrollIndicators]="true">
        <aside-setting [ngClass]="{'setting-sidebar': isMobileSidebar}" (closeAsideEvent)="toggleSidebarPane(false, false)"></aside-setting>
    </perfect-scrollbar>
</div>
<div class="help-support-aside setting-sidebar-wrapper" *ngIf="asideInventorySidebarMenuState === 'in'" (clickOutside)="closeSettingPaneOnOutsideClick()">
    <inventory-sidebar class="inventory-sidebar" [ngClass]="{'inventory-sidebar': isMobileSidebar}" (closeAsideEvent)="toggleSidebarPane(false, false)"></inventory-sidebar>
</div>
<ng-template #datepickerTemplate>
    <div class="datepicker-modal">
        <div class="modal-body">
            <app-datepicker-wrapper [inputStartDate]="selectedDateRange?.startDate" [inputEndDate]="selectedDateRange?.endDate" [alwaysShowCalendars]="true" [ranges]="datePickerOptions" [selectedRangeLabel]="selectedRangeLabel" [showCustomRangeLabel]="true" [showClearButton]="false"
                [showCancel]="true" [linkedCalendars]="true" [showDropdowns]="true" [locale]="{applyLabel: 'Done'}" (rangeClicked)="dateSelectedCallback($event)" (datesUpdated)="dateSelectedCallback($event)" [keepCalendarOpeningWithRange]="false" [showRangeLabelOnInput]="false"
                [dateFieldPosition]="dateFieldPosition" [updatePosition]="false"></app-datepicker-wrapper>
        </div>
    </div>
</ng-template>
