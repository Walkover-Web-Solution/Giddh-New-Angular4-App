<div class="col-xs-10">
    <div class="col-xs-12 bg_wrap">
        <div class="row">
            <div class="clearfix pdT2">
                <span class="btn label isActive">{{data.voucherType}}</span>
                <div class="pull-right text-right">
                    <input type="text" #dateField [textMask]="{mask: dateMask, guide: true}" [(ngModel)]="entryDate" name="entryDate" (blur)="dateEntered();" placeholder="DD-MM-YYYY" class="form-control text-right appearance_none" />
                    <!-- <div *ngIf="showFromDatePicker" style="position: absolute; z-index:10; min-height:290px;">
                        <datepicker [(ngModel)]="entryDate" (selectionDone)="setDate($event)" [showWeeks]="false"></datepicker>
                    </div> -->
                    {{ displayDay }}
                </div>
            </div>

            <!-- invoice num -->
            <div class="clearfix form-inline mrB">
                <div class="mx-300 form-group">
                    <label>Supplier Invoice No:</label> <input type="text" placeholder="Invoice no." [(ngModel)]="data.invoiceNumberAgainstVoucher" class="form-control max-height28 appearance_none" decimalDigitsDirective style="max-width:200px" />
                </div>

                <!-- key not available in request 
                    <div class="mx-300 form-group" (clickOutside)="showInvoiceDate=false;">
                    <span>Date: </span>
                    <input type="text" [ngModel]="moment(entryDate).format('DD-MM-YYYY')" decimalDigitsDirective readonly (focus)="showInvoiceDate = true;" class="form-control appearance_none max-height28" />
                    <div *ngIf="showInvoiceDate" style="position: absolute; z-index:10; min-height:290px;">
                        <datepicker [(ngModel)]="entryDate" (selectionDone)="setInvoiceDate($event)" [showWeeks]="false"></datepicker>
                    </div>
                </div> -->
            </div>
            <!-- /invoice num -->


            <!-- party acc name -->
            <div class="mx-300 clearfix form-inline mrB">
                <div class="form-group">
                    <label>Party A/c Name:<sup>*</sup></label>
                    <input type="text" #creditor placeholder="Party account" class="form-control max-height28 appearance_none" (keyup)="searchAccount($event?.target?.value)" (keydown)="detectKey($event)" [(ngModel)]="creditorAcc.name" (focus)="onPartyAccFocus();" (blur)="onPartyAccBlur()"
                        style="max-width:200px" />
                </div>
            </div>
            <!-- /party acc name -->

            <!-- operating cost acc only -->
            <!-- No need for purchase ledger, as discussed with alok 
                <div class="mx-300 clearfix form-inline mrB">
                <div class="form-group">
                    <label>Purchase Ledger:<sup>*</sup></label> <input type="text" #debtor placeholder="Purchase account" (focus)="accountType = 'debitor'" [(ngModel)]="debtorAcc.name" (focus)="getFlattenGrpAccounts('purchases', true)" (blur)="showAccountList=false;selectedInput=debtor"
                        class="form-control max-height28 appearance_none" style="max-width:200px" />
                </div>
            </div> -->
            <!-- /operating cost acc only -->


            <!--  purchase as INVOICE -->
            <div class="clearfix mrT1" [style.min-height.vh]="61">
                <div class="table-responsive bdrT">
                    <table class="table entry_table">
                        <thead>
                            <tr>
                                <th style="width:70%;">Name of Item</th>
                                <th class="text-right">Quantity</th>
                                <th class="text-right">Rate</th>
                                <th class="text-left">Per</th>
                                <th class="text-right">Amount</th>
                            </tr>
                        </thead>
                        <br />
                        <!-- stock entry  -->
                        <tbody (clickOutside)="hideListItems()">
                            <ng-container *ngFor="let transaction of stocksTransaction;let i=index;let l=last">
                                <ng-container>
                                    <tr [ngClass]="{'activeRow': (isSelectedRow && selectedRowIdx === i) || (!selectedRowIdx && !isSelectedRow && i == 0)}">
                                        <!-- (blur)="onStockItemBlur($event, qty); showStockList.next(false)" -->
                                        <td><input id="first_element_{{i}}_{{i}}" type="text" class="form-control" [(ngModel)]="transaction.inventory.stock.name" (ngModelChange)="searchStock($event);changeStock(i, transaction?.inventory?.stock?.name)" [ngClass]="{'focus': isSelectedRow && selectedRowIdx === i}"
                                                (focus)="onStockFocus(i)" (blur)="onStockItemBlur($event, qty);" (keydown)="detectKey($event)" /></td>
                                        <td>
                                            <input type="text" class="form-control text-right" #qty [(ngModel)]="transaction.inventory.quantity" (ngModelChange)="changeQuantity(i, $event)" (focus)="selectRow(true,i, null); hideListItems();" [ngClass]="{'focus': isSelectedRow && selectedRowIdx === i}"
                                                decimalDigitsDirective [DecimalPlaces]="2" [disabled]="!transaction.inventory.stock.name" />
                                        </td>
                                        <td>
                                            <input type="text" class="form-control text-right" [(ngModel)]="transaction.inventory.unit.rate" (ngModelChange)="changePrice(i,$event)" (focus)="selectRow(true,i,null)" [ngClass]="{'focus': isSelectedRow && selectedRowIdx === i}" decimalDigitsDirective
                                                [DecimalPlaces]="2" [disabled]="!transaction.inventory.stock.name" />
                                        </td>
                                        <td>
                                            <input type="text" class="form-control text-left" [(ngModel)]="transaction.inventory.unit.stockUnitCode" [readonly]="true" (focus)="selectRow(true,i)" [disabled]="!transaction.inventory.stock.name" />
                                        </td>
                                        <td>
                                            <input type="text" class="form-control text-right" #toAmountField [(ngModel)]="transaction.inventory.amount" (ngModelChange)="amountChanged(i)" (focus)="selectRow(true,i)" (keydown.Tab)="addNewStock(transaction.inventory.amount,transaction, i)" (blur)="addNewStock(transaction.inventory.amount,transaction, i)"
                                                [ngClass]="{'focus': isSelectedRow && selectedRowIdx === i}" decimalDigitsDirective [DecimalPlaces]="2" [disabled]="!transaction.inventory.stock.name" />
                                        </td>
                                    </tr>
                                </ng-container>
                            </ng-container>
                            <tr *ngIf="stockTotal">
                                <td colspan="4"></td>
                                <td class>
                                    <input type="text" [value]="stockTotal" readonly disabled class="form-control text-right" />
                                    <div class="bdrB"></div>
                                </td>
                            </tr>
                            <br />
                            <!-- accounts entry -->
                            <!--  -->
                            <ng-container *ngFor="let transaction of accountsTransaction;let i=index;let l=last">
                                <tr [ngClass]="{'activeRow': isSelectedRow && selectedAccIdx === i}">
                                    <td colspan="2"><input type="text" class="form-control" #particular [(ngModel)]="transaction.selectedAccount.account" (ngModelChange)="searchAccount($event);" (focus)="onAccountFocus(i)" [ngClass]="{'focus': isSelectedRow && selectedAccIdx === i}"
                                            (keydown)="detectKey($event)" (blur)="onAccountBlur(particular)" /></td>
                                    <td>
                                        <input type="text" class="form-control text-right" decimalDigitsDirective [DecimalPlaces]="2" [(ngModel)]="transaction.rate" (ngModelChange)="calculateRate(i, transaction?.rate)" (focus)="selectedAccIdx=i; hideListItems()" [ngClass]="{'focus': isSelectedRow && selectedAccIdx === i}"
                                            [disabled]="!transaction.selectedAccount.account" />
                                    </td>
                                    <td><input type="text" *ngIf="transaction.rate" class="form-control" [value]="'%'" disabled readonly /></td>
                                    <td>
                                        <input type="text" class="form-control text-right" (change)="changeTotal(i, transaction.amount)" decimalDigitsDirective [DecimalPlaces]="2" [(ngModel)]="transaction.amount" (focus)="selectedAccIdx=i" [ngClass]="{'focus': isSelectedRow && selectedAccIdx === i}"
                                            [disabled]="!transaction.selectedAccount.account" (blur)="addNewAccount(transaction.amount, l)" />
                                    </td>
                                </tr>
                            </ng-container>
                        </tbody>
                    </table>
                </div>
            </div>
            <!--  purchase as INVOICE -->



            <div class="clearfix">
                <div class="col-xs-4">
                    <div class="form-group">
                        <label>Narration:</label>
                        <textarea class="form-control appearance_none" name="narration" (keyup.enter)="openConfirmBox(submitButton)" (keydown.tab)="openConfirmBox(submitButton)" [(ngModel)]="data.description" resize="false" rows="6"></textarea>
                    </div>
                </div>

                <div [hidden]="!showConfirmationBox" class="confirmation_box bdr text-center pd2">
                    <div class="">
                        <h1>Accept?</h1>
                        <div class="pdT2">
                            <button class="btn btn-primary" #submitButton (click)="saveEntry();">Yes</button> |
                            <button class="btn btn-default" (click)="showConfirmationBox = false;">No</button>
                            <br />
                            <button class="btn btn-link mrT1" (click)="refreshEntry();">Reset</button>
                        </div>
                    </div>
                </div>
                <div class="col-xs-3 total_box text-right pull-right">
                    <span><strong>{{stockTotal + accountsTotal}}</strong></span>
                </div>

                <!-- <div class="col-xs-3 total_box text-right pull-right" *ngIf="purchaseType == 'voucher'">
                    <span><strong>{{stockTotal + accountsTotal}}</strong></span>
                    <span><strong>{{stockTotal + accountsTotal}}</strong></span>
                </div> -->
            </div>
        </div>
    </div>

    <div class="sidebar_list form-control" [hidden]="!showLedgerAccountList">
        <h3 class="pd1 bdrB primary_clr" *ngIf="selectedField === 'account'">List of Ledger Accounts</h3>
        <h3 class="pd1 bdrB primary_clr" *ngIf="selectedField === 'stock'">List of Stock Items</h3>
        <!-- (noToggleClick)="toggleSelected($event)" (noResultClicked)="noResultsClicked.emit(); hide()" [noResultLinkEnabled]="notFoundLink" [notFoundMsg]="notFoundMsg" [notFoundLinkText]="notFoundLinkText" [ItemHeight]="ItemHeight" [NoFoundMsgHeight]="NoFoundMsgHeight" [NoFoundLinkHeight]="NoFoundLinkHeight" [dropdownMinHeight]="dropdownMinHeight"-->
        <accounting-virtual-list [keydownUpInput]="keyUpDownEvent" [filterText]="filterByText" [options]="inputForList" [showList]="showLedgerAccountList" [isFilterEnabled]="true" (selected)="onItemSelected($event)" [(ngModel)]="currentSelectedValue" [placeholder]="'Select Option'"
            [notFoundLink]="selectedField === 'account'" (noResultsClicked)="showQuickAccountModal()" [multiple]="false" [ItemHeight]="33"></accounting-virtual-list>
    </div>

</div>

<!--quick account popup -->
<div bsModal #quickAccountModal="bs-modal" [config]="{ backdrop: false }" class="modal" role="dialog">
    <div class="modal-dialog modal-sm" style="width: 298px">
        <div class="modal-content">
            <div element-view-container-ref #quickAccountComponent="elementviewcontainerref"></div>
        </div>
    </div>
</div>


<!-- <div class="sidebar_menu col-xs-2 pd0">

    <div class="bdrL account_listbar pos_rel" [hidden]="!showAccountList">
        <h3 class="pd1 bdrB primary_clr">List of Ledger Accounts</h3>
        <accounts-list [arrowKeyInfo]="arrowInput" [search]="accountSearch" [parentGrpUnqName]="groupUniqueName" [filterByGrp]="filterByGrp" (onSelectItem)="setAccount($event)"></accounts-list>
    </div>


    <div class="bdrL account_listbar pos_rel" [hidden]="!(showStockList | async)">
        <h3 class="pd1 bdrB primary_clr">List of Stock Items</h3>
        <accounts-list [arrowKeyInfo]="arrowInput" [search]="stockSearch" [parentGrpUnqName]="groupUniqueName" [voucher]="'purchases'" [filterByGrp]="filterByGrp" [showStockItem]="(showStockList | async)" (onSelectItem)="onSelectStock($event)"></accounts-list>
    </div>

    <accounting-sidebar></accounting-sidebar>
</div> -->