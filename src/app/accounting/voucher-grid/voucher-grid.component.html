<div class="col-xs-10">
    <div class="col-xs-12 bg_wrap">
        <div class="row">
            <div class="clearfix pdT2">
                <span class="btn label isActive">{{voucherType}}</span>
                <div class="pull-right text-right" (clickOutside)="showFromDatePicker = false;">
                    <input type="text" [ngModel]="moment(journalDate).format('DD-MM-YYYY')" (focus)="showFromDatePicker = true;" class="form-control text-right appearance_none" />
                    <div *ngIf="showFromDatePicker" style="position: absolute; z-index:10; min-height:290px;">
                        <datepicker [(ngModel)]="journalDate" (selectionDone)="setDate($event)" [showWeeks]="false"></datepicker>
                    </div>
                    {{moment(journalDate).format('dddd')}}
                </div>
            </div>
            <div class="clearfix" [style.min-height.vh]="61">
                <div class="table-responsive bdrT">
                    <table class="table entry_table">
                        <thead>
                            <tr>
                                <th> &nbsp; </th>
                                <th style="width:80%;">Particulars</th>
                                <th class="text-right">Debit</th>
                                <th class="text-right">Credit</th>
                            </tr>
                        </thead>
                        <br />
                        <tbody>
                            <tr *ngFor="let transaction of requestObj.transactions;let i=index;let l=last" [ngClass]="{'activeRow': (isSelectedRow && selectedIdx === i) || (!selectedIdx && !isSelectedRow && i == 0)}">
                                <td [style.width.px]="40"><input type="text" class="form-control txtCpc" [disabled]="i === 0" (ngModel)="transaction.type" (ngModelChange)="selectEntryType(transaction, $event, i)" (focus)="selectRow(true,i)" (blur)="selectRow(false,null)" [ngClass]="{'focus': isSelectedRow && selectedIdx === i}"
                                        value="{{ transaction.type | lowercase }}" maxlength="2" /></td>
                                <td><input type="text" class="form-control" #particular [required]="transaction.amount" [(ngModel)]="transaction.selectedAccount.account" (ngModelChange)="searchAccount($event)" (focus)="onAccountFocus(); selectRow(true,i)"
                                        (blur)="selectRow(true,i);onAccountBlur($event, particular);" [ngClass]="{'focus': isSelectedRow && selectedIdx === i}" (keyup)="showLedgerAccountList=true;" />
                                    <!-- *ngIf="transaction.inventory" -->
                                    <table [hidden]="!transaction.stocks">
                                        <tbody>
                                            <tr *ngFor="let inventory of transaction.inventory;let i=index;let l=last" [ngClass]="{'activeRow': (isSelectedRow && selectedStockIdx === i) || (!selectedStockIdx && !isSelectedRow && i == 0)}">
                                                <td colspan="" [style.width.px]="250"><input type="text" placeholder="Type to search stock" class="form-control" #Item [(ngModel)]="inventory.stock.name" [ngClass]="{'focus': isSelectedRow && selectedStockIdx === i}" (focus)="openStockList();selectedStockIdx = i"
                                                        (blur)="showStockList = false" /></td>
                                                <td>
                                                    <input type="text" placeholder="Quantity" class="form-control text-right" [(ngModel)]="inventory.quantity" [ngClass]="{'focus': isSelectedRow && selectedStockIdx === i}" decimalDigitsDirective [DecimalPlaces]="2" [disabled]="!inventory.stock.name" />
                                                </td>
                                                <td>
                                                    <input type="text" placeholder="Rate" class="form-control text-right" [(ngModel)]="inventory.unit.rate" (ngModelChange)="changePrice(i,$event)" (focus)="selectRow(true,i)" (blur)="selectRow(false,null)" [ngClass]="{'focus': isSelectedRow && selectedStockIdx === i}"
                                                        decimalDigitsDirective [DecimalPlaces]="2" [disabled]="!inventory.stock.name" />
                                                </td>
                                                <td>
                                                    <input type="text" placeholder="Unit" class="form-control text-left" [(ngModel)]="inventory.unit.stockUnitCode" [readonly]="true" (focus)="selectRow(true,i)" (blur)="selectRow(false,null)" [disabled]="!inventory.stock.name" />
                                                </td>
                                                <td>
                                                    <input type="text" placeholder="Total" class="form-control text-right" #toAmountField [(ngModel)]="inventory.amount" (focus)="selectRow(true,i)" [ngClass]="{'focus': isSelectedRow && selectedStockIdx === i}" decimalDigitsDirective [DecimalPlaces]="2"
                                                        [disabled]="!inventory.stock.name" />
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </td>
                                <!-- (blur)="onAccountBlur();selectRow(false,null)"  -->
                                <td>
                                    <input *ngIf="transaction.type === 'by'" type="text" min="0" [required]="transaction.particular" class="form-control text-right" #byAmountField decimalDigitsDirective [DecimalPlaces]="2" [(ngModel)]="transaction.amount" (focus)="selectRow(true,i)" (keydown.Tab)="addNewEntry(transaction.amount,transaction, i)"
                                        (blur)="selectRow(false,null);addNewEntry(transaction.amount,transaction, i)" [ngClass]="{'focus': isSelectedRow && selectedIdx === i}" [disabled]="transaction.stocks && transaction.stocks.length && transaction.inventory[0]?.amount"
                                    />
                                </td>
                                <td>
                                    <input *ngIf="transaction.type === 'to'" type="text" min="0" class="form-control text-right" [required]="transaction.particular" #toAmountField decimalDigitsDirective [DecimalPlaces]="2" [(ngModel)]="transaction.amount" (focus)="selectRow(true,i)" (keydown.Tab)="addNewEntry(transaction.amount,transaction, i)"
                                        (blur)="selectRow(false,null);addNewEntry(transaction.amount,transaction, i)" [ngClass]="{'focus': isSelectedRow && selectedIdx === i}" [disabled]="transaction.stocks && transaction.stocks.length  && transaction.inventory[0]?.amount"
                                    />
                                </td>
                            </tr>

                        </tbody>
                    </table>
                </div>
            </div>

            <div class="clearfix">
                <div class="col-xs-4">
                    <div class="form-group">
                        <label>Narration:</label>
                        <textarea class="form-control" name="narration" (keyup.enter)="openConfirmBox(submitButton)" (keydown.tab)="openConfirmBox(submitButton)" [(ngModel)]="requestObj.description" resize="false" rows="6"></textarea>
                    </div>
                </div>

                <div [hidden]="!showConfirmationBox" class="confirmation_box bdr text-center pd2">
                    <div class="">
                        <h1>Accept?</h1>
                        <div class="pdT2">
                            <button class="btn btn-primary" #submitButton (click)="saveEntry();">Yes</button> |
                            <button class="btn btn-default" (click)="showConfirmationBox = false;">No</button>
                            <br />
                            <button class="btn btn-link mrT1" (click)="refreshEntry();">Reset</button>

                        </div>
                    </div>
                </div>
                <div class="col-xs-3 total_box text-right pull-right">
                    <span><strong>{{totalDebitAmount}}</strong></span>
                    <span><strong>{{totalCreditAmount}}</strong></span>
                </div>
            </div>
        </div>
    </div>
</div>



<div class="sidebar_menu col-xs-2 pd0">
    <div class="bdrL account_listbar pos_rel" [hidden]="!showLedgerAccountList">
        <h3 class="pd1 bdrB primary_clr">List of Ledger Accounts</h3>
        <accounts-list [search]="accountSearch" [showStockItem]="false" (onSelectItem)="setAccount($event)"></accounts-list>
    </div>

    <div class="bdrL account_listbar pos_rel" [hidden]="!showStockList">
        <h3 class="pd1 bdrB primary_clr">List of Stock Item</h3>
        <accounts-list [search]="accountSearch" [showStockItem]="showStockList" [grpUniqueName]="groupUniqueName" (onSelectItem)="onSelectStock($event)"></accounts-list>
    </div>

    <accounting-sidebar></accounting-sidebar>
</div>

<div bsModal #manageGroupsAccountsModal="bs-modal" [config]="{ keyboard: true }" class="modal fade fullScreenMy" role="dialog">
    <div class="modal-dialog modal-lg modal-liq90 mr0 width100" style="height: 100%;">
        <div class="modal-content fullScreenMy">
            <app-manage-groups-accounts></app-manage-groups-accounts>
        </div>
    </div>
</div>