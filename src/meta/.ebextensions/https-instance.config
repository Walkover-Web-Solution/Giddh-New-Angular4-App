packages:
  yum:
    mod24_ssl : []

files:
  /etc/httpd/conf.d/ssl.conf:
    mode: "000644"
    owner: root
    group: root
    content: |
      LoadModule ssl_module modules/mod_ssl.so
      LoadModule http2_module modules/mod_http2.so
      Listen 443

      <VirtualHost *:443>

          ServerName giddh.com
          Protocols h2 http/1.1

          SSLEngine                 on
          SSLCertificateFile        "/etc/pki/tls/certs/server.crt"
          SSLCertificateKeyFile     "/etc/pki/tls/certs/server.key"
          SSLCertificateChainFile   "/etc/pki/tls/certs/chain.crt"
          SSLCipherSuite            EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH
          SSLProtocol               All -SSLv2 -SSLv3
          SSLHonorCipherOrder       On
          SSLSessionTickets         Off

      </VirtualHost>

  /etc/httpd/conf.d/ssl_redirect.conf:
    mode: "000644"
    owner: root
    group: root
    content: |
      <VirtualHost *:80>
       
          Redirect permanent / https://giddh.com
      
      </VirtualHost>
      
  /etc/pki/tls/certs/chain.crt:
    mode: "000400"
    owner: root
    group: root
    authentication: S3Access
    source: https://s3.ap-south-1.amazonaws.com/elasticbeanstalk-ap-south-1-726066441076/giddh-ui-ssl/giddh_com.ca-bundle

      
  /etc/pki/tls/certs/server.crt:
    mode: "000400"
    owner: root
    group: root
    authentication: S3Access
    source: https://s3.ap-south-1.amazonaws.com/elasticbeanstalk-ap-south-1-726066441076/giddh-ui-ssl/giddh_com.crt

  /etc/pki/tls/certs/server.key:
    mode: "000400"
    owner: root
    group: root
    authentication: S3Access
    source: https://s3.ap-south-1.amazonaws.com/elasticbeanstalk-ap-south-1-726066441076/giddh-ui-ssl/giddh_com.key

Resources:
  AWSEBAutoScalingGroup:
    Metadata:
      AWS::CloudFormation::Authentication:
        S3Access:
          type: S3
          roleName: aws-elasticbeanstalk-ec2-role
          buckets: elasticbeanstalk-ap-south-1-726066441076